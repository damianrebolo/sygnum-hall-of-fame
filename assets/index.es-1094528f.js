import{b9 as Nn,e as Sr,f as _m,ba as _r,bb as cr,bc as kc,bd as Fr,aZ as An,be as ym,h as vm,bf as Wl,p as mm}from"./index-c8bec167.js";import{e as Lr,N as xu}from"./index-9348da44.js";import{r as bm}from"./index-91c1907f.js";var Vo={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Wc=function(i,e){return Wc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Wc(i,e)};function wm(i,e){Wc(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Yc=function(){return Yc=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Yc.apply(this,arguments)};function Em(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function Sm(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var p=i.length-1;p>=0;p--)(l=i[p])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function Im(i,e){return function(t,s){e(t,s,i)}}function xm(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function Om(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function p(w){try{d(s.next(w))}catch(A){l(A)}}function _(w){try{d(s.throw(w))}catch(A){l(A)}}function d(w){w.done?c(w.value):o(w.value).then(p,_)}d((s=s.apply(i,e||[])).next())})}function Pm(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(d){return function(w){return _([d,w])}}function _(d){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=d[0]&2?o.return:d[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,d[1])).done)return c;switch(o=0,c&&(d=[d[0]&2,c.value]),d[0]){case 0:case 1:c=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,o=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!c||d[1]>c[0]&&d[1]<c[3])){t.label=d[1];break}if(d[0]===6&&t.label<c[1]){t.label=c[1],c=d;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(d);break}c[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(i,t)}catch(w){d=[6,w],o=0}finally{s=c=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function Am(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function Tm(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function Jc(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ip(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(p){l={error:p}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function Cm(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Ip(arguments[e]));return i}function Nm(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,p=c.length;l<p;l++,o++)s[o]=c[l];return s}function gs(i){return this instanceof gs?(this.v=i,this):new gs(i)}function Rm(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(S){s[S]&&(o[S]=function(P){return new Promise(function(M,B){c.push([S,P,M,B])>1||p(S,P)})})}function p(S,P){try{_(s[S](P))}catch(M){A(c[0][3],M)}}function _(S){S.value instanceof gs?Promise.resolve(S.value.v).then(d,w):A(c[0][2],S)}function d(S){p("next",S)}function w(S){p("throw",S)}function A(S,P){S(P),c.shift(),c.length&&p(c[0][0],c[0][1])}}function $m(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:gs(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function Dm(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Jc=="function"?Jc(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(p,_){l=i[c](l),o(p,_,l.done,l.value)})}}function o(c,l,p,_){Promise.resolve(_).then(function(d){c({value:d,done:p})},l)}}function jm(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function Fm(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function Um(i){return i&&i.__esModule?i:{default:i}}function Lm(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function Mm(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const qm=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Yc},__asyncDelegator:$m,__asyncGenerator:Rm,__asyncValues:Dm,__await:gs,__awaiter:Om,__classPrivateFieldGet:Lm,__classPrivateFieldSet:Mm,__createBinding:Am,__decorate:Sm,__exportStar:Tm,__extends:wm,__generator:Pm,__importDefault:Um,__importStar:Fm,__makeTemplateObject:jm,__metadata:xm,__param:Im,__read:Ip,__rest:Em,__spread:Cm,__spreadArrays:Nm,__values:Jc},Symbol.toStringTag,{value:"Module"})),xp=Nn(qm);var Es={};Object.defineProperty(Es,"__esModule",{value:!0});function zm(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return JSON.parse(i)}catch{return i}}Es.safeJsonParse=zm;function Hm(i){return typeof i=="string"?i:JSON.stringify(i,(e,t)=>typeof t>"u"?null:t)}Es.safeJsonStringify=Hm;var ts={exports:{}},Yl;function Bm(){return Yl||(Yl=1,function(){let i;function e(){}i=e,i.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},i.prototype.setItem=function(t,s){this[t]=String(s)},i.prototype.removeItem=function(t){delete this[t]},i.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(s){t[s]=void 0,delete t[s]})},i.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},i.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Sr<"u"&&Sr.localStorage?ts.exports=Sr.localStorage:typeof window<"u"&&window.localStorage?ts.exports=window.localStorage:ts.exports=new e}()),ts.exports}var Ac={},rs={},Jl;function Km(){if(Jl)return rs;Jl=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.IKeyValueStorage=void 0;class i{}return rs.IKeyValueStorage=i,rs}var is={},Xl;function Vm(){if(Xl)return is;Xl=1,Object.defineProperty(is,"__esModule",{value:!0}),is.parseEntry=void 0;const i=Es;function e(t){var s;return[t[0],i.safeJsonParse((s=t[1])!==null&&s!==void 0?s:"")]}return is.parseEntry=e,is}var Zl;function Gm(){return Zl||(Zl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=xp;e.__exportStar(Km(),i),e.__exportStar(Vm(),i)}(Ac)),Ac}Object.defineProperty(Vo,"__esModule",{value:!0});Vo.KeyValueStorage=void 0;const On=xp,Ql=Es,km=On.__importDefault(Bm()),Wm=Gm();class Op{constructor(){this.localStorage=km.default}getKeys(){return On.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return On.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Wm.parseEntry)})}getItem(e){return On.__awaiter(this,void 0,void 0,function*(){const t=this.localStorage.getItem(e);if(t!==null)return Ql.safeJsonParse(t)})}setItem(e,t){return On.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,Ql.safeJsonStringify(t))})}removeItem(e){return On.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}Vo.KeyValueStorage=Op;var Ym=Vo.default=Op,Rn={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Xc=function(i,e){return Xc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Xc(i,e)};function Jm(i,e){Xc(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Zc=function(){return Zc=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Zc.apply(this,arguments)};function Xm(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function Zm(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var p=i.length-1;p>=0;p--)(l=i[p])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function Qm(i,e){return function(t,s){e(t,s,i)}}function eb(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function tb(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function p(w){try{d(s.next(w))}catch(A){l(A)}}function _(w){try{d(s.throw(w))}catch(A){l(A)}}function d(w){w.done?c(w.value):o(w.value).then(p,_)}d((s=s.apply(i,e||[])).next())})}function rb(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(d){return function(w){return _([d,w])}}function _(d){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=d[0]&2?o.return:d[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,d[1])).done)return c;switch(o=0,c&&(d=[d[0]&2,c.value]),d[0]){case 0:case 1:c=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,o=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!c||d[1]>c[0]&&d[1]<c[3])){t.label=d[1];break}if(d[0]===6&&t.label<c[1]){t.label=c[1],c=d;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(d);break}c[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(i,t)}catch(w){d=[6,w],o=0}finally{s=c=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function ib(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function nb(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function Qc(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pp(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(p){l={error:p}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function sb(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Pp(arguments[e]));return i}function ob(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,p=c.length;l<p;l++,o++)s[o]=c[l];return s}function _s(i){return this instanceof _s?(this.v=i,this):new _s(i)}function ab(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(S){s[S]&&(o[S]=function(P){return new Promise(function(M,B){c.push([S,P,M,B])>1||p(S,P)})})}function p(S,P){try{_(s[S](P))}catch(M){A(c[0][3],M)}}function _(S){S.value instanceof _s?Promise.resolve(S.value.v).then(d,w):A(c[0][2],S)}function d(S){p("next",S)}function w(S){p("throw",S)}function A(S,P){S(P),c.shift(),c.length&&p(c[0][0],c[0][1])}}function cb(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:_s(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function ub(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Qc=="function"?Qc(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(p,_){l=i[c](l),o(p,_,l.done,l.value)})}}function o(c,l,p,_){Promise.resolve(_).then(function(d){c({value:d,done:p})},l)}}function hb(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function lb(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function fb(i){return i&&i.__esModule?i:{default:i}}function pb(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function db(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const gb=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Zc},__asyncDelegator:cb,__asyncGenerator:ab,__asyncValues:ub,__await:_s,__awaiter:tb,__classPrivateFieldGet:pb,__classPrivateFieldSet:db,__createBinding:ib,__decorate:Zm,__exportStar:nb,__extends:Jm,__generator:rb,__importDefault:fb,__importStar:lb,__makeTemplateObject:hb,__metadata:eb,__param:Qm,__read:Pp,__rest:Xm,__spread:sb,__spreadArrays:ob,__values:Qc},Symbol.toStringTag,{value:"Module"})),Go=Nn(gb);var ns={},ye={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var eu=function(i,e){return eu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},eu(i,e)};function _b(i,e){eu(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var tu=function(){return tu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},tu.apply(this,arguments)};function yb(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function vb(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var p=i.length-1;p>=0;p--)(l=i[p])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function mb(i,e){return function(t,s){e(t,s,i)}}function bb(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function wb(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function p(w){try{d(s.next(w))}catch(A){l(A)}}function _(w){try{d(s.throw(w))}catch(A){l(A)}}function d(w){w.done?c(w.value):o(w.value).then(p,_)}d((s=s.apply(i,e||[])).next())})}function Eb(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(d){return function(w){return _([d,w])}}function _(d){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=d[0]&2?o.return:d[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,d[1])).done)return c;switch(o=0,c&&(d=[d[0]&2,c.value]),d[0]){case 0:case 1:c=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,o=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!c||d[1]>c[0]&&d[1]<c[3])){t.label=d[1];break}if(d[0]===6&&t.label<c[1]){t.label=c[1],c=d;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(d);break}c[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(i,t)}catch(w){d=[6,w],o=0}finally{s=c=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function Sb(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function Ib(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function ru(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ap(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(p){l={error:p}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function xb(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Ap(arguments[e]));return i}function Ob(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,p=c.length;l<p;l++,o++)s[o]=c[l];return s}function ys(i){return this instanceof ys?(this.v=i,this):new ys(i)}function Pb(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(S){s[S]&&(o[S]=function(P){return new Promise(function(M,B){c.push([S,P,M,B])>1||p(S,P)})})}function p(S,P){try{_(s[S](P))}catch(M){A(c[0][3],M)}}function _(S){S.value instanceof ys?Promise.resolve(S.value.v).then(d,w):A(c[0][2],S)}function d(S){p("next",S)}function w(S){p("throw",S)}function A(S,P){S(P),c.shift(),c.length&&p(c[0][0],c[0][1])}}function Ab(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:ys(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function Tb(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof ru=="function"?ru(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(p,_){l=i[c](l),o(p,_,l.done,l.value)})}}function o(c,l,p,_){Promise.resolve(_).then(function(d){c({value:d,done:p})},l)}}function Cb(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function Nb(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function Rb(i){return i&&i.__esModule?i:{default:i}}function $b(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function Db(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const jb=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return tu},__asyncDelegator:Ab,__asyncGenerator:Pb,__asyncValues:Tb,__await:ys,__awaiter:wb,__classPrivateFieldGet:$b,__classPrivateFieldSet:Db,__createBinding:Sb,__decorate:vb,__exportStar:Ib,__extends:_b,__generator:Eb,__importDefault:Rb,__importStar:Nb,__makeTemplateObject:Cb,__metadata:bb,__param:mb,__read:Ap,__rest:yb,__spread:xb,__spreadArrays:Ob,__values:ru},Symbol.toStringTag,{value:"Module"})),ko=Nn(jb);var Tc={},ss={},ef;function Fb(){if(ef)return ss;ef=1,Object.defineProperty(ss,"__esModule",{value:!0}),ss.delay=void 0;function i(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return ss.delay=i,ss}var Yi={},Cc={},Ji={},tf;function Ub(){return tf||(tf=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.ONE_THOUSAND=Ji.ONE_HUNDRED=void 0,Ji.ONE_HUNDRED=100,Ji.ONE_THOUSAND=1e3),Ji}var Nc={},rf;function Lb(){return rf||(rf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ONE_YEAR=i.FOUR_WEEKS=i.THREE_WEEKS=i.TWO_WEEKS=i.ONE_WEEK=i.THIRTY_DAYS=i.SEVEN_DAYS=i.FIVE_DAYS=i.THREE_DAYS=i.ONE_DAY=i.TWENTY_FOUR_HOURS=i.TWELVE_HOURS=i.SIX_HOURS=i.THREE_HOURS=i.ONE_HOUR=i.SIXTY_MINUTES=i.THIRTY_MINUTES=i.TEN_MINUTES=i.FIVE_MINUTES=i.ONE_MINUTE=i.SIXTY_SECONDS=i.THIRTY_SECONDS=i.TEN_SECONDS=i.FIVE_SECONDS=i.ONE_SECOND=void 0,i.ONE_SECOND=1,i.FIVE_SECONDS=5,i.TEN_SECONDS=10,i.THIRTY_SECONDS=30,i.SIXTY_SECONDS=60,i.ONE_MINUTE=i.SIXTY_SECONDS,i.FIVE_MINUTES=i.ONE_MINUTE*5,i.TEN_MINUTES=i.ONE_MINUTE*10,i.THIRTY_MINUTES=i.ONE_MINUTE*30,i.SIXTY_MINUTES=i.ONE_MINUTE*60,i.ONE_HOUR=i.SIXTY_MINUTES,i.THREE_HOURS=i.ONE_HOUR*3,i.SIX_HOURS=i.ONE_HOUR*6,i.TWELVE_HOURS=i.ONE_HOUR*12,i.TWENTY_FOUR_HOURS=i.ONE_HOUR*24,i.ONE_DAY=i.TWENTY_FOUR_HOURS,i.THREE_DAYS=i.ONE_DAY*3,i.FIVE_DAYS=i.ONE_DAY*5,i.SEVEN_DAYS=i.ONE_DAY*7,i.THIRTY_DAYS=i.ONE_DAY*30,i.ONE_WEEK=i.SEVEN_DAYS,i.TWO_WEEKS=i.ONE_WEEK*2,i.THREE_WEEKS=i.ONE_WEEK*3,i.FOUR_WEEKS=i.ONE_WEEK*4,i.ONE_YEAR=i.ONE_DAY*365}(Nc)),Nc}var nf;function Tp(){return nf||(nf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ko;e.__exportStar(Ub(),i),e.__exportStar(Lb(),i)}(Cc)),Cc}var sf;function Mb(){if(sf)return Yi;sf=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.fromMiliseconds=Yi.toMiliseconds=void 0;const i=Tp();function e(s){return s*i.ONE_THOUSAND}Yi.toMiliseconds=e;function t(s){return Math.floor(s/i.ONE_THOUSAND)}return Yi.fromMiliseconds=t,Yi}var of;function qb(){return of||(of=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ko;e.__exportStar(Fb(),i),e.__exportStar(Mb(),i)}(Tc)),Tc}var xn={},af;function zb(){if(af)return xn;af=1,Object.defineProperty(xn,"__esModule",{value:!0}),xn.Watch=void 0;class i{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const s=this.get(t);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const o=Date.now()-s.started;this.timestamps.set(t,{started:s.started,elapsed:o})}get(t){const s=this.timestamps.get(t);if(typeof s>"u")throw new Error(`No timestamp found for label: ${t}`);return s}elapsed(t){const s=this.get(t);return s.elapsed||Date.now()-s.started}}return xn.Watch=i,xn.default=i,xn}var Rc={},os={},cf;function Hb(){if(cf)return os;cf=1,Object.defineProperty(os,"__esModule",{value:!0}),os.IWatch=void 0;class i{}return os.IWatch=i,os}var uf;function Bb(){return uf||(uf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),ko.__exportStar(Hb(),i)}(Rc)),Rc}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ko;e.__exportStar(qb(),i),e.__exportStar(zb(),i),e.__exportStar(Bb(),i),e.__exportStar(Tp(),i)})(ye);var $c={},as={};let en=class{};const Kb=Object.freeze(Object.defineProperty({__proto__:null,IEvents:en},Symbol.toStringTag,{value:"Module"})),Vb=Nn(Kb);var hf;function Gb(){if(hf)return as;hf=1,Object.defineProperty(as,"__esModule",{value:!0}),as.IHeartBeat=void 0;const i=Vb;class e extends i.IEvents{constructor(s){super()}}return as.IHeartBeat=e,as}var lf;function Cp(){return lf||(lf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Go.__exportStar(Gb(),i)}($c)),$c}var Dc={},Xi={},ff;function kb(){if(ff)return Xi;ff=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.HEARTBEAT_EVENTS=Xi.HEARTBEAT_INTERVAL=void 0;const i=ye;return Xi.HEARTBEAT_INTERVAL=i.FIVE_SECONDS,Xi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Xi}var pf;function Np(){return pf||(pf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Go.__exportStar(kb(),i)}(Dc)),Dc}var df;function Wb(){if(df)return ns;df=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.HeartBeat=void 0;const i=Go,e=Lr,t=ye,s=Cp(),o=Np();class c extends s.IHeartBeat{constructor(p){super(p),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(p==null?void 0:p.interval)||o.HEARTBEAT_INTERVAL}static init(p){return i.__awaiter(this,void 0,void 0,function*(){const _=new c(p);return yield _.init(),_})}init(){return i.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(p,_){this.events.on(p,_)}once(p,_){this.events.once(p,_)}off(p,_){this.events.off(p,_)}removeListener(p,_){this.events.removeListener(p,_)}initialize(){return i.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return ns.HeartBeat=c,ns}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Go;e.__exportStar(Wb(),i),e.__exportStar(Cp(),i),e.__exportStar(Np(),i)})(Rn);var Qe={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var iu=function(i,e){return iu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},iu(i,e)};function Yb(i,e){iu(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var nu=function(){return nu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},nu.apply(this,arguments)};function Jb(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function Xb(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var p=i.length-1;p>=0;p--)(l=i[p])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function Zb(i,e){return function(t,s){e(t,s,i)}}function Qb(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function ew(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function p(w){try{d(s.next(w))}catch(A){l(A)}}function _(w){try{d(s.throw(w))}catch(A){l(A)}}function d(w){w.done?c(w.value):o(w.value).then(p,_)}d((s=s.apply(i,e||[])).next())})}function tw(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(d){return function(w){return _([d,w])}}function _(d){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=d[0]&2?o.return:d[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,d[1])).done)return c;switch(o=0,c&&(d=[d[0]&2,c.value]),d[0]){case 0:case 1:c=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,o=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!c||d[1]>c[0]&&d[1]<c[3])){t.label=d[1];break}if(d[0]===6&&t.label<c[1]){t.label=c[1],c=d;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(d);break}c[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(i,t)}catch(w){d=[6,w],o=0}finally{s=c=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function rw(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function iw(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function su(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Rp(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(p){l={error:p}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function nw(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Rp(arguments[e]));return i}function sw(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,p=c.length;l<p;l++,o++)s[o]=c[l];return s}function vs(i){return this instanceof vs?(this.v=i,this):new vs(i)}function ow(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(S){s[S]&&(o[S]=function(P){return new Promise(function(M,B){c.push([S,P,M,B])>1||p(S,P)})})}function p(S,P){try{_(s[S](P))}catch(M){A(c[0][3],M)}}function _(S){S.value instanceof vs?Promise.resolve(S.value.v).then(d,w):A(c[0][2],S)}function d(S){p("next",S)}function w(S){p("throw",S)}function A(S,P){S(P),c.shift(),c.length&&p(c[0][0],c[0][1])}}function aw(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:vs(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function cw(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof su=="function"?su(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(p,_){l=i[c](l),o(p,_,l.done,l.value)})}}function o(c,l,p,_){Promise.resolve(_).then(function(d){c({value:d,done:p})},l)}}function uw(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function hw(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function lw(i){return i&&i.__esModule?i:{default:i}}function fw(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function pw(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const dw=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return nu},__asyncDelegator:aw,__asyncGenerator:ow,__asyncValues:cw,__await:vs,__awaiter:ew,__classPrivateFieldGet:fw,__classPrivateFieldSet:pw,__createBinding:rw,__decorate:Xb,__exportStar:iw,__extends:Yb,__generator:tw,__importDefault:lw,__importStar:hw,__makeTemplateObject:uw,__metadata:Qb,__param:Zb,__read:Rp,__rest:Jb,__spread:nw,__spreadArrays:sw,__values:su},Symbol.toStringTag,{value:"Module"})),gw=Nn(dw);var jc,gf;function _w(){if(gf)return jc;gf=1;function i(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}jc=e;function e(t,s,o){var c=o&&o.stringify||i,l=1;if(typeof t=="object"&&t!==null){var p=s.length+l;if(p===1)return t;var _=new Array(p);_[0]=c(t);for(var d=1;d<p;d++)_[d]=c(s[d]);return _.join(" ")}if(typeof t!="string")return t;var w=s.length;if(w===0)return t;for(var A="",S=1-l,P=-1,M=t&&t.length||0,B=0;B<M;){if(t.charCodeAt(B)===37&&B+1<M){switch(P=P>-1?P:0,t.charCodeAt(B+1)){case 100:case 102:if(S>=w||s[S]==null)break;P<B&&(A+=t.slice(P,B)),A+=Number(s[S]),P=B+2,B++;break;case 105:if(S>=w||s[S]==null)break;P<B&&(A+=t.slice(P,B)),A+=Math.floor(Number(s[S])),P=B+2,B++;break;case 79:case 111:case 106:if(S>=w||s[S]===void 0)break;P<B&&(A+=t.slice(P,B));var K=typeof s[S];if(K==="string"){A+="'"+s[S]+"'",P=B+2,B++;break}if(K==="function"){A+=s[S].name||"<anonymous>",P=B+2,B++;break}A+=c(s[S]),P=B+2,B++;break;case 115:if(S>=w)break;P<B&&(A+=t.slice(P,B)),A+=String(s[S]),P=B+2,B++;break;case 37:P<B&&(A+=t.slice(P,B)),A+="%",P=B+2,B++,S--;break}++S}++B}return P===-1?t:(P<M&&(A+=t.slice(P)),A)}return jc}var Fc,_f;function yw(){if(_f)return Fc;_f=1;const i=_w();Fc=o;const e=C().console||{},t={mapHttpRequest:M,mapHttpResponse:M,wrapRequestSerializer:B,wrapResponseSerializer:B,wrapErrorSerializer:B,req:M,res:M,err:S};function s(b,h){return Array.isArray(b)?b.filter(function(k){return k!=="!stdSerializers.err"}):b===!0?Object.keys(h):!1}function o(b){b=b||{},b.browser=b.browser||{};const h=b.browser.transmit;if(h&&typeof h.send!="function")throw Error("pino: transmit option must have a send function");const m=b.browser.write||e;b.browser.write&&(b.browser.asObject=!0);const k=b.serializers||{},G=s(b.browser.serialize,k);let se=b.browser.serialize;Array.isArray(b.browser.serialize)&&b.browser.serialize.indexOf("!stdSerializers.err")>-1&&(se=!1);const ce=["error","fatal","warn","info","debug","trace"];typeof m=="function"&&(m.error=m.fatal=m.warn=m.info=m.debug=m.trace=m),b.enabled===!1&&(b.level="silent");const ge=b.level||"info",$=Object.create(m);$.log||($.log=K),Object.defineProperty($,"levelVal",{get:le}),Object.defineProperty($,"level",{get:te,set:W});const z={transmit:h,serialize:G,asObject:b.browser.asObject,levels:ce,timestamp:P(b)};$.levels=o.levels,$.level=ge,$.setMaxListeners=$.getMaxListeners=$.emit=$.addListener=$.on=$.prependListener=$.once=$.prependOnceListener=$.removeListener=$.removeAllListeners=$.listeners=$.listenerCount=$.eventNames=$.write=$.flush=K,$.serializers=k,$._serialize=G,$._stdErrSerialize=se,$.child=ee,h&&($._logEvent=A());function le(){return this.level==="silent"?1/0:this.levels.values[this.level]}function te(){return this._level}function W(Y){if(Y!=="silent"&&!this.levels.values[Y])throw Error("unknown level "+Y);this._level=Y,c(z,$,"error","log"),c(z,$,"fatal","error"),c(z,$,"warn","error"),c(z,$,"info","log"),c(z,$,"debug","log"),c(z,$,"trace","log")}function ee(Y,re){if(!Y)throw new Error("missing bindings for child Pino");re=re||{},G&&Y.serializers&&(re.serializers=Y.serializers);const Oe=re.serializers;if(G&&Oe){var ie=Object.assign({},k,Oe),be=b.browser.serialize===!0?Object.keys(ie):G;delete Y.serializers,_([Y],be,ie,this._stdErrSerialize)}function he(ve){this._childLevel=(ve._childLevel|0)+1,this.error=d(ve,Y,"error"),this.fatal=d(ve,Y,"fatal"),this.warn=d(ve,Y,"warn"),this.info=d(ve,Y,"info"),this.debug=d(ve,Y,"debug"),this.trace=d(ve,Y,"trace"),ie&&(this.serializers=ie,this._serialize=be),h&&(this._logEvent=A([].concat(ve._logEvent.bindings,Y)))}return he.prototype=this,new he(this)}return $}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=t,o.stdTimeFunctions=Object.assign({},{nullTime:oe,epochTime:R,unixTime:U,isoTime:x});function c(b,h,m,k){const G=Object.getPrototypeOf(h);h[m]=h.levelVal>h.levels.values[m]?K:G[m]?G[m]:e[m]||e[k]||K,l(b,h,m)}function l(b,h,m){!b.transmit&&h[m]===K||(h[m]=function(k){return function(){const se=b.timestamp(),ce=new Array(arguments.length),ge=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var $=0;$<ce.length;$++)ce[$]=arguments[$];if(b.serialize&&!b.asObject&&_(ce,this._serialize,this.serializers,this._stdErrSerialize),b.asObject?k.call(ge,p(this,m,ce,se)):k.apply(ge,ce),b.transmit){const z=b.transmit.level||h.level,le=o.levels.values[z],te=o.levels.values[m];if(te<le)return;w(this,{ts:se,methodLevel:m,methodValue:te,transmitLevel:z,transmitValue:o.levels.values[b.transmit.level||h.level],send:b.transmit.send,val:h.levelVal},ce)}}}(h[m]))}function p(b,h,m,k){b._serialize&&_(m,b._serialize,b.serializers,b._stdErrSerialize);const G=m.slice();let se=G[0];const ce={};k&&(ce.time=k),ce.level=o.levels.values[h];let ge=(b._childLevel|0)+1;if(ge<1&&(ge=1),se!==null&&typeof se=="object"){for(;ge--&&typeof G[0]=="object";)Object.assign(ce,G.shift());se=G.length?i(G.shift(),G):void 0}else typeof se=="string"&&(se=i(G.shift(),G));return se!==void 0&&(ce.msg=se),ce}function _(b,h,m,k){for(const G in b)if(k&&b[G]instanceof Error)b[G]=o.stdSerializers.err(b[G]);else if(typeof b[G]=="object"&&!Array.isArray(b[G]))for(const se in b[G])h&&h.indexOf(se)>-1&&se in m&&(b[G][se]=m[se](b[G][se]))}function d(b,h,m){return function(){const k=new Array(1+arguments.length);k[0]=h;for(var G=1;G<k.length;G++)k[G]=arguments[G-1];return b[m].apply(this,k)}}function w(b,h,m){const k=h.send,G=h.ts,se=h.methodLevel,ce=h.methodValue,ge=h.val,$=b._logEvent.bindings;_(m,b._serialize||Object.keys(b.serializers),b.serializers,b._stdErrSerialize===void 0?!0:b._stdErrSerialize),b._logEvent.ts=G,b._logEvent.messages=m.filter(function(z){return $.indexOf(z)===-1}),b._logEvent.level.label=se,b._logEvent.level.value=ce,k(se,b._logEvent,ge),b._logEvent=A($)}function A(b){return{ts:0,messages:[],bindings:b||[],level:{label:"",value:0}}}function S(b){const h={type:b.constructor.name,msg:b.message,stack:b.stack};for(const m in b)h[m]===void 0&&(h[m]=b[m]);return h}function P(b){return typeof b.timestamp=="function"?b.timestamp:b.timestamp===!1?oe:R}function M(){return{}}function B(b){return b}function K(){}function oe(){return!1}function R(){return Date.now()}function U(){return Math.round(Date.now()/1e3)}function x(){return new Date(Date.now()).toISOString()}function C(){function b(h){return typeof h<"u"&&h}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return b(self)||b(window)||b(this)||{}}}return Fc}var Zi={},yf;function $p(){return yf||(yf=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.PINO_CUSTOM_CONTEXT_KEY=Zi.PINO_LOGGER_DEFAULTS=void 0,Zi.PINO_LOGGER_DEFAULTS={level:"info"},Zi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Zi}var sr={},vf;function vw(){if(vf)return sr;vf=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.generateChildLogger=sr.formatChildLoggerContext=sr.getLoggerContext=sr.setBrowserLoggerContext=sr.getBrowserLoggerContext=sr.getDefaultLoggerOptions=void 0;const i=$p();function e(p){return Object.assign(Object.assign({},p),{level:(p==null?void 0:p.level)||i.PINO_LOGGER_DEFAULTS.level})}sr.getDefaultLoggerOptions=e;function t(p,_=i.PINO_CUSTOM_CONTEXT_KEY){return p[_]||""}sr.getBrowserLoggerContext=t;function s(p,_,d=i.PINO_CUSTOM_CONTEXT_KEY){return p[d]=_,p}sr.setBrowserLoggerContext=s;function o(p,_=i.PINO_CUSTOM_CONTEXT_KEY){let d="";return typeof p.bindings>"u"?d=t(p,_):d=p.bindings().context||"",d}sr.getLoggerContext=o;function c(p,_,d=i.PINO_CUSTOM_CONTEXT_KEY){const w=o(p,d);return w.trim()?`${w}/${_}`:_}sr.formatChildLoggerContext=c;function l(p,_,d=i.PINO_CUSTOM_CONTEXT_KEY){const w=c(p,_,d),A=p.child({context:w});return s(A,w,d)}return sr.generateChildLogger=l,sr}(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.pino=void 0;const e=gw,t=e.__importDefault(yw());Object.defineProperty(i,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar($p(),i),e.__exportStar(vw(),i)})(Qe);class mw extends en{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class bw extends en{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}}class ww{constructor(e,t){this.logger=e,this.core=t}}let Ew=class extends en{constructor(e,t){super(),this.relayer=e,this.logger=t}},Sw=class extends en{constructor(e){super()}},Iw=class{constructor(e,t,s,o){this.core=e,this.logger=t,this.name=s}};class xw extends en{constructor(e,t){super(),this.relayer=e,this.logger=t}}let Ow=class extends en{constructor(e,t){super(),this.core=e,this.logger=t}},Pw=class{constructor(e,t){this.projectId=e,this.logger=t}},Aw=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},Tw=class{constructor(e){this.client=e}};const Cw=i=>JSON.stringify(i,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),Nw=i=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=i.replace(e,'$1"$2n"$3');return JSON.parse(t,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Ou(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return Nw(i)}catch{return i}}function ms(i){return typeof i=="string"?i:Cw(i)||""}var Pu={},$n={},Wo={},Yo={};Object.defineProperty(Yo,"__esModule",{value:!0});Yo.BrowserRandomSource=void 0;const mf=65536;class Rw{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let s=0;s<t.length;s+=mf)this._crypto.getRandomValues(t.subarray(s,s+Math.min(t.length-s,mf)));return t}}Yo.BrowserRandomSource=Rw;var Jo={},Ir={};Object.defineProperty(Ir,"__esModule",{value:!0});function $w(i){for(var e=0;e<i.length;e++)i[e]=0;return i}Ir.wipe=$w;Object.defineProperty(Jo,"__esModule",{value:!0});Jo.NodeRandomSource=void 0;const Dw=Ir;class jw{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof _m<"u"){const e=bm();e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let o=0;o<s.length;o++)s[o]=t[o];return(0,Dw.wipe)(t),s}}Jo.NodeRandomSource=jw;Object.defineProperty(Wo,"__esModule",{value:!0});Wo.SystemRandomSource=void 0;const Fw=Yo,Uw=Jo;class Lw{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Fw.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Uw.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Wo.SystemRandomSource=Lw;var Fe={},Dp={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});function e(p,_){var d=p>>>16&65535,w=p&65535,A=_>>>16&65535,S=_&65535;return w*S+(d*S+w*A<<16>>>0)|0}i.mul=Math.imul||e;function t(p,_){return p+_|0}i.add=t;function s(p,_){return p-_|0}i.sub=s;function o(p,_){return p<<_|p>>>32-_}i.rotl=o;function c(p,_){return p<<32-_|p>>>_}i.rotr=c;function l(p){return typeof p=="number"&&isFinite(p)&&Math.floor(p)===p}i.isInteger=Number.isInteger||l,i.MAX_SAFE_INTEGER=9007199254740991,i.isSafeInteger=function(p){return i.isInteger(p)&&p>=-i.MAX_SAFE_INTEGER&&p<=i.MAX_SAFE_INTEGER}})(Dp);Object.defineProperty(Fe,"__esModule",{value:!0});var jp=Dp;function Mw(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])<<16>>16}Fe.readInt16BE=Mw;function qw(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])>>>0}Fe.readUint16BE=qw;function zw(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])<<16>>16}Fe.readInt16LE=zw;function Hw(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])>>>0}Fe.readUint16LE=Hw;function Fp(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>8,e[t+1]=i>>>0,e}Fe.writeUint16BE=Fp;Fe.writeInt16BE=Fp;function Up(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e}Fe.writeUint16LE=Up;Fe.writeInt16LE=Up;function ou(i,e){return e===void 0&&(e=0),i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}Fe.readInt32BE=ou;function au(i,e){return e===void 0&&(e=0),(i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3])>>>0}Fe.readUint32BE=au;function cu(i,e){return e===void 0&&(e=0),i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e]}Fe.readInt32LE=cu;function uu(i,e){return e===void 0&&(e=0),(i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e])>>>0}Fe.readUint32LE=uu;function Uo(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>24,e[t+1]=i>>>16,e[t+2]=i>>>8,e[t+3]=i>>>0,e}Fe.writeUint32BE=Uo;Fe.writeInt32BE=Uo;function Lo(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e[t+2]=i>>>16,e[t+3]=i>>>24,e}Fe.writeUint32LE=Lo;Fe.writeInt32LE=Lo;function Bw(i,e){e===void 0&&(e=0);var t=ou(i,e),s=ou(i,e+4);return t*4294967296+s-(s>>31)*4294967296}Fe.readInt64BE=Bw;function Kw(i,e){e===void 0&&(e=0);var t=au(i,e),s=au(i,e+4);return t*4294967296+s}Fe.readUint64BE=Kw;function Vw(i,e){e===void 0&&(e=0);var t=cu(i,e),s=cu(i,e+4);return s*4294967296+t-(t>>31)*4294967296}Fe.readInt64LE=Vw;function Gw(i,e){e===void 0&&(e=0);var t=uu(i,e),s=uu(i,e+4);return s*4294967296+t}Fe.readUint64LE=Gw;function Lp(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Uo(i/4294967296>>>0,e,t),Uo(i>>>0,e,t+4),e}Fe.writeUint64BE=Lp;Fe.writeInt64BE=Lp;function Mp(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Lo(i>>>0,e,t),Lo(i/4294967296>>>0,e,t+4),e}Fe.writeUint64LE=Mp;Fe.writeInt64LE=Mp;function kw(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,c=i/8+t-1;c>=t;c--)s+=e[c]*o,o*=256;return s}Fe.readUintBE=kw;function Ww(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,c=t;c<t+i/8;c++)s+=e[c]*o,o*=256;return s}Fe.readUintLE=Ww;function Yw(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!jp.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,c=i/8+s-1;c>=s;c--)t[c]=e/o&255,o*=256;return t}Fe.writeUintBE=Yw;function Jw(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!jp.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,c=s;c<s+i/8;c++)t[c]=e/o&255,o*=256;return t}Fe.writeUintLE=Jw;function Xw(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e)}Fe.readFloat32BE=Xw;function Zw(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e,!0)}Fe.readFloat32LE=Zw;function Qw(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e)}Fe.readFloat64BE=Qw;function eE(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e,!0)}Fe.readFloat64LE=eE;function tE(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i),e}Fe.writeFloat32BE=tE;function rE(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i,!0),e}Fe.writeFloat32LE=rE;function iE(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i),e}Fe.writeFloat64BE=iE;function nE(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i,!0),e}Fe.writeFloat64LE=nE;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.randomStringForEntropy=i.randomString=i.randomUint32=i.randomBytes=i.defaultRandomSource=void 0;const e=Wo,t=Fe,s=Ir;i.defaultRandomSource=new e.SystemRandomSource;function o(d,w=i.defaultRandomSource){return w.randomBytes(d)}i.randomBytes=o;function c(d=i.defaultRandomSource){const w=o(4,d),A=(0,t.readUint32LE)(w);return(0,s.wipe)(w),A}i.randomUint32=c;const l="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function p(d,w=l,A=i.defaultRandomSource){if(w.length<2)throw new Error("randomString charset is too short");if(w.length>256)throw new Error("randomString charset is too long");let S="";const P=w.length,M=256-256%P;for(;d>0;){const B=o(Math.ceil(d*256/M),A);for(let K=0;K<B.length&&d>0;K++){const oe=B[K];oe<M&&(S+=w.charAt(oe%P),d--)}(0,s.wipe)(B)}return S}i.randomString=p;function _(d,w=l,A=i.defaultRandomSource){const S=Math.ceil(d/(Math.log(w.length)/Math.LN2));return p(S,w,A)}i.randomStringForEntropy=_})($n);var qp={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Fe,t=Ir;i.DIGEST_LENGTH=64,i.BLOCK_SIZE=128;var s=function(){function p(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return p.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},p.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},p.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},p.prototype.update=function(_,d){if(d===void 0&&(d=_.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var w=0;if(this._bytesHashed+=d,this._bufferLength>0){for(;this._bufferLength<i.BLOCK_SIZE&&d>0;)this._buffer[this._bufferLength++]=_[w++],d--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(d>=this.blockSize&&(w=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,_,w,d),d%=this.blockSize);d>0;)this._buffer[this._bufferLength++]=_[w++],d--;return this},p.prototype.finish=function(_){if(!this._finished){var d=this._bytesHashed,w=this._bufferLength,A=d/536870912|0,S=d<<3,P=d%128<112?128:256;this._buffer[w]=128;for(var M=w+1;M<P-8;M++)this._buffer[M]=0;e.writeUint32BE(A,this._buffer,P-8),e.writeUint32BE(S,this._buffer,P-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,P),this._finished=!0}for(var M=0;M<this.digestLength/8;M++)e.writeUint32BE(this._stateHi[M],_,M*8),e.writeUint32BE(this._stateLo[M],_,M*8+4);return this},p.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},p.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},p.prototype.restoreState=function(_){return this._stateHi.set(_.stateHi),this._stateLo.set(_.stateLo),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},p.prototype.cleanSavedState=function(_){t.wipe(_.stateHi),t.wipe(_.stateLo),_.buffer&&t.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},p}();i.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(p,_,d,w,A,S,P){for(var M=d[0],B=d[1],K=d[2],oe=d[3],R=d[4],U=d[5],x=d[6],C=d[7],b=w[0],h=w[1],m=w[2],k=w[3],G=w[4],se=w[5],ce=w[6],ge=w[7],$,z,le,te,W,ee,Y,re;P>=128;){for(var Oe=0;Oe<16;Oe++){var ie=8*Oe+S;p[Oe]=e.readUint32BE(A,ie),_[Oe]=e.readUint32BE(A,ie+4)}for(var Oe=0;Oe<80;Oe++){var be=M,he=B,ve=K,q=oe,L=R,N=U,f=x,O=C,ne=b,fe=h,Ie=m,He=k,Ve=G,Ue=se,dt=ce,gt=ge;if($=C,z=ge,W=z&65535,ee=z>>>16,Y=$&65535,re=$>>>16,$=(R>>>14|G<<32-14)^(R>>>18|G<<32-18)^(G>>>41-32|R<<32-(41-32)),z=(G>>>14|R<<32-14)^(G>>>18|R<<32-18)^(R>>>41-32|G<<32-(41-32)),W+=z&65535,ee+=z>>>16,Y+=$&65535,re+=$>>>16,$=R&U^~R&x,z=G&se^~G&ce,W+=z&65535,ee+=z>>>16,Y+=$&65535,re+=$>>>16,$=o[Oe*2],z=o[Oe*2+1],W+=z&65535,ee+=z>>>16,Y+=$&65535,re+=$>>>16,$=p[Oe%16],z=_[Oe%16],W+=z&65535,ee+=z>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,le=Y&65535|re<<16,te=W&65535|ee<<16,$=le,z=te,W=z&65535,ee=z>>>16,Y=$&65535,re=$>>>16,$=(M>>>28|b<<32-28)^(b>>>34-32|M<<32-(34-32))^(b>>>39-32|M<<32-(39-32)),z=(b>>>28|M<<32-28)^(M>>>34-32|b<<32-(34-32))^(M>>>39-32|b<<32-(39-32)),W+=z&65535,ee+=z>>>16,Y+=$&65535,re+=$>>>16,$=M&B^M&K^B&K,z=b&h^b&m^h&m,W+=z&65535,ee+=z>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,O=Y&65535|re<<16,gt=W&65535|ee<<16,$=q,z=He,W=z&65535,ee=z>>>16,Y=$&65535,re=$>>>16,$=le,z=te,W+=z&65535,ee+=z>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,q=Y&65535|re<<16,He=W&65535|ee<<16,B=be,K=he,oe=ve,R=q,U=L,x=N,C=f,M=O,h=ne,m=fe,k=Ie,G=He,se=Ve,ce=Ue,ge=dt,b=gt,Oe%16===15)for(var ie=0;ie<16;ie++)$=p[ie],z=_[ie],W=z&65535,ee=z>>>16,Y=$&65535,re=$>>>16,$=p[(ie+9)%16],z=_[(ie+9)%16],W+=z&65535,ee+=z>>>16,Y+=$&65535,re+=$>>>16,le=p[(ie+1)%16],te=_[(ie+1)%16],$=(le>>>1|te<<32-1)^(le>>>8|te<<32-8)^le>>>7,z=(te>>>1|le<<32-1)^(te>>>8|le<<32-8)^(te>>>7|le<<32-7),W+=z&65535,ee+=z>>>16,Y+=$&65535,re+=$>>>16,le=p[(ie+14)%16],te=_[(ie+14)%16],$=(le>>>19|te<<32-19)^(te>>>61-32|le<<32-(61-32))^le>>>6,z=(te>>>19|le<<32-19)^(le>>>61-32|te<<32-(61-32))^(te>>>6|le<<32-6),W+=z&65535,ee+=z>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,p[ie]=Y&65535|re<<16,_[ie]=W&65535|ee<<16}$=M,z=b,W=z&65535,ee=z>>>16,Y=$&65535,re=$>>>16,$=d[0],z=w[0],W+=z&65535,ee+=z>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,d[0]=M=Y&65535|re<<16,w[0]=b=W&65535|ee<<16,$=B,z=h,W=z&65535,ee=z>>>16,Y=$&65535,re=$>>>16,$=d[1],z=w[1],W+=z&65535,ee+=z>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,d[1]=B=Y&65535|re<<16,w[1]=h=W&65535|ee<<16,$=K,z=m,W=z&65535,ee=z>>>16,Y=$&65535,re=$>>>16,$=d[2],z=w[2],W+=z&65535,ee+=z>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,d[2]=K=Y&65535|re<<16,w[2]=m=W&65535|ee<<16,$=oe,z=k,W=z&65535,ee=z>>>16,Y=$&65535,re=$>>>16,$=d[3],z=w[3],W+=z&65535,ee+=z>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,d[3]=oe=Y&65535|re<<16,w[3]=k=W&65535|ee<<16,$=R,z=G,W=z&65535,ee=z>>>16,Y=$&65535,re=$>>>16,$=d[4],z=w[4],W+=z&65535,ee+=z>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,d[4]=R=Y&65535|re<<16,w[4]=G=W&65535|ee<<16,$=U,z=se,W=z&65535,ee=z>>>16,Y=$&65535,re=$>>>16,$=d[5],z=w[5],W+=z&65535,ee+=z>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,d[5]=U=Y&65535|re<<16,w[5]=se=W&65535|ee<<16,$=x,z=ce,W=z&65535,ee=z>>>16,Y=$&65535,re=$>>>16,$=d[6],z=w[6],W+=z&65535,ee+=z>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,d[6]=x=Y&65535|re<<16,w[6]=ce=W&65535|ee<<16,$=C,z=ge,W=z&65535,ee=z>>>16,Y=$&65535,re=$>>>16,$=d[7],z=w[7],W+=z&65535,ee+=z>>>16,Y+=$&65535,re+=$>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,d[7]=C=Y&65535|re<<16,w[7]=ge=W&65535|ee<<16,S+=128,P-=128}return S}function l(p){var _=new s;_.update(p);var d=_.digest();return _.clean(),d}i.hash=l})(qp);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.convertSecretKeyToX25519=i.convertPublicKeyToX25519=i.verify=i.sign=i.extractPublicKeyFromSecretKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.SEED_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=i.SIGNATURE_LENGTH=void 0;const e=$n,t=qp,s=Ir;i.SIGNATURE_LENGTH=64,i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=64,i.SEED_LENGTH=32;function o(q){const L=new Float64Array(16);if(q)for(let N=0;N<q.length;N++)L[N]=q[N];return L}const c=new Uint8Array(32);c[0]=9;const l=o(),p=o([1]),_=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),d=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),w=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),A=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),S=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function P(q,L){for(let N=0;N<16;N++)q[N]=L[N]|0}function M(q){let L=1;for(let N=0;N<16;N++){let f=q[N]+L+65535;L=Math.floor(f/65536),q[N]=f-L*65536}q[0]+=L-1+37*(L-1)}function B(q,L,N){const f=~(N-1);for(let O=0;O<16;O++){const ne=f&(q[O]^L[O]);q[O]^=ne,L[O]^=ne}}function K(q,L){const N=o(),f=o();for(let O=0;O<16;O++)f[O]=L[O];M(f),M(f),M(f);for(let O=0;O<2;O++){N[0]=f[0]-65517;for(let fe=1;fe<15;fe++)N[fe]=f[fe]-65535-(N[fe-1]>>16&1),N[fe-1]&=65535;N[15]=f[15]-32767-(N[14]>>16&1);const ne=N[15]>>16&1;N[14]&=65535,B(f,N,1-ne)}for(let O=0;O<16;O++)q[2*O]=f[O]&255,q[2*O+1]=f[O]>>8}function oe(q,L){let N=0;for(let f=0;f<32;f++)N|=q[f]^L[f];return(1&N-1>>>8)-1}function R(q,L){const N=new Uint8Array(32),f=new Uint8Array(32);return K(N,q),K(f,L),oe(N,f)}function U(q){const L=new Uint8Array(32);return K(L,q),L[0]&1}function x(q,L){for(let N=0;N<16;N++)q[N]=L[2*N]+(L[2*N+1]<<8);q[15]&=32767}function C(q,L,N){for(let f=0;f<16;f++)q[f]=L[f]+N[f]}function b(q,L,N){for(let f=0;f<16;f++)q[f]=L[f]-N[f]}function h(q,L,N){let f,O,ne=0,fe=0,Ie=0,He=0,Ve=0,Ue=0,dt=0,gt=0,Me=0,xe=0,$e=0,De=0,qe=0,Ae=0,je=0,Se=0,Te=0,Be=0,Pe=0,Ge=0,We=0,et=0,tt=0,Je=0,Qt=0,ur=0,kr=0,er=0,ii=0,vi=0,ji=0,wt=N[0],_t=N[1],Et=N[2],St=N[3],mt=N[4],yt=N[5],jt=N[6],Ft=N[7],It=N[8],Ut=N[9],xt=N[10],Tt=N[11],Ot=N[12],ht=N[13],Lt=N[14],Mt=N[15];f=L[0],ne+=f*wt,fe+=f*_t,Ie+=f*Et,He+=f*St,Ve+=f*mt,Ue+=f*yt,dt+=f*jt,gt+=f*Ft,Me+=f*It,xe+=f*Ut,$e+=f*xt,De+=f*Tt,qe+=f*Ot,Ae+=f*ht,je+=f*Lt,Se+=f*Mt,f=L[1],fe+=f*wt,Ie+=f*_t,He+=f*Et,Ve+=f*St,Ue+=f*mt,dt+=f*yt,gt+=f*jt,Me+=f*Ft,xe+=f*It,$e+=f*Ut,De+=f*xt,qe+=f*Tt,Ae+=f*Ot,je+=f*ht,Se+=f*Lt,Te+=f*Mt,f=L[2],Ie+=f*wt,He+=f*_t,Ve+=f*Et,Ue+=f*St,dt+=f*mt,gt+=f*yt,Me+=f*jt,xe+=f*Ft,$e+=f*It,De+=f*Ut,qe+=f*xt,Ae+=f*Tt,je+=f*Ot,Se+=f*ht,Te+=f*Lt,Be+=f*Mt,f=L[3],He+=f*wt,Ve+=f*_t,Ue+=f*Et,dt+=f*St,gt+=f*mt,Me+=f*yt,xe+=f*jt,$e+=f*Ft,De+=f*It,qe+=f*Ut,Ae+=f*xt,je+=f*Tt,Se+=f*Ot,Te+=f*ht,Be+=f*Lt,Pe+=f*Mt,f=L[4],Ve+=f*wt,Ue+=f*_t,dt+=f*Et,gt+=f*St,Me+=f*mt,xe+=f*yt,$e+=f*jt,De+=f*Ft,qe+=f*It,Ae+=f*Ut,je+=f*xt,Se+=f*Tt,Te+=f*Ot,Be+=f*ht,Pe+=f*Lt,Ge+=f*Mt,f=L[5],Ue+=f*wt,dt+=f*_t,gt+=f*Et,Me+=f*St,xe+=f*mt,$e+=f*yt,De+=f*jt,qe+=f*Ft,Ae+=f*It,je+=f*Ut,Se+=f*xt,Te+=f*Tt,Be+=f*Ot,Pe+=f*ht,Ge+=f*Lt,We+=f*Mt,f=L[6],dt+=f*wt,gt+=f*_t,Me+=f*Et,xe+=f*St,$e+=f*mt,De+=f*yt,qe+=f*jt,Ae+=f*Ft,je+=f*It,Se+=f*Ut,Te+=f*xt,Be+=f*Tt,Pe+=f*Ot,Ge+=f*ht,We+=f*Lt,et+=f*Mt,f=L[7],gt+=f*wt,Me+=f*_t,xe+=f*Et,$e+=f*St,De+=f*mt,qe+=f*yt,Ae+=f*jt,je+=f*Ft,Se+=f*It,Te+=f*Ut,Be+=f*xt,Pe+=f*Tt,Ge+=f*Ot,We+=f*ht,et+=f*Lt,tt+=f*Mt,f=L[8],Me+=f*wt,xe+=f*_t,$e+=f*Et,De+=f*St,qe+=f*mt,Ae+=f*yt,je+=f*jt,Se+=f*Ft,Te+=f*It,Be+=f*Ut,Pe+=f*xt,Ge+=f*Tt,We+=f*Ot,et+=f*ht,tt+=f*Lt,Je+=f*Mt,f=L[9],xe+=f*wt,$e+=f*_t,De+=f*Et,qe+=f*St,Ae+=f*mt,je+=f*yt,Se+=f*jt,Te+=f*Ft,Be+=f*It,Pe+=f*Ut,Ge+=f*xt,We+=f*Tt,et+=f*Ot,tt+=f*ht,Je+=f*Lt,Qt+=f*Mt,f=L[10],$e+=f*wt,De+=f*_t,qe+=f*Et,Ae+=f*St,je+=f*mt,Se+=f*yt,Te+=f*jt,Be+=f*Ft,Pe+=f*It,Ge+=f*Ut,We+=f*xt,et+=f*Tt,tt+=f*Ot,Je+=f*ht,Qt+=f*Lt,ur+=f*Mt,f=L[11],De+=f*wt,qe+=f*_t,Ae+=f*Et,je+=f*St,Se+=f*mt,Te+=f*yt,Be+=f*jt,Pe+=f*Ft,Ge+=f*It,We+=f*Ut,et+=f*xt,tt+=f*Tt,Je+=f*Ot,Qt+=f*ht,ur+=f*Lt,kr+=f*Mt,f=L[12],qe+=f*wt,Ae+=f*_t,je+=f*Et,Se+=f*St,Te+=f*mt,Be+=f*yt,Pe+=f*jt,Ge+=f*Ft,We+=f*It,et+=f*Ut,tt+=f*xt,Je+=f*Tt,Qt+=f*Ot,ur+=f*ht,kr+=f*Lt,er+=f*Mt,f=L[13],Ae+=f*wt,je+=f*_t,Se+=f*Et,Te+=f*St,Be+=f*mt,Pe+=f*yt,Ge+=f*jt,We+=f*Ft,et+=f*It,tt+=f*Ut,Je+=f*xt,Qt+=f*Tt,ur+=f*Ot,kr+=f*ht,er+=f*Lt,ii+=f*Mt,f=L[14],je+=f*wt,Se+=f*_t,Te+=f*Et,Be+=f*St,Pe+=f*mt,Ge+=f*yt,We+=f*jt,et+=f*Ft,tt+=f*It,Je+=f*Ut,Qt+=f*xt,ur+=f*Tt,kr+=f*Ot,er+=f*ht,ii+=f*Lt,vi+=f*Mt,f=L[15],Se+=f*wt,Te+=f*_t,Be+=f*Et,Pe+=f*St,Ge+=f*mt,We+=f*yt,et+=f*jt,tt+=f*Ft,Je+=f*It,Qt+=f*Ut,ur+=f*xt,kr+=f*Tt,er+=f*Ot,ii+=f*ht,vi+=f*Lt,ji+=f*Mt,ne+=38*Te,fe+=38*Be,Ie+=38*Pe,He+=38*Ge,Ve+=38*We,Ue+=38*et,dt+=38*tt,gt+=38*Je,Me+=38*Qt,xe+=38*ur,$e+=38*kr,De+=38*er,qe+=38*ii,Ae+=38*vi,je+=38*ji,O=1,f=ne+O+65535,O=Math.floor(f/65536),ne=f-O*65536,f=fe+O+65535,O=Math.floor(f/65536),fe=f-O*65536,f=Ie+O+65535,O=Math.floor(f/65536),Ie=f-O*65536,f=He+O+65535,O=Math.floor(f/65536),He=f-O*65536,f=Ve+O+65535,O=Math.floor(f/65536),Ve=f-O*65536,f=Ue+O+65535,O=Math.floor(f/65536),Ue=f-O*65536,f=dt+O+65535,O=Math.floor(f/65536),dt=f-O*65536,f=gt+O+65535,O=Math.floor(f/65536),gt=f-O*65536,f=Me+O+65535,O=Math.floor(f/65536),Me=f-O*65536,f=xe+O+65535,O=Math.floor(f/65536),xe=f-O*65536,f=$e+O+65535,O=Math.floor(f/65536),$e=f-O*65536,f=De+O+65535,O=Math.floor(f/65536),De=f-O*65536,f=qe+O+65535,O=Math.floor(f/65536),qe=f-O*65536,f=Ae+O+65535,O=Math.floor(f/65536),Ae=f-O*65536,f=je+O+65535,O=Math.floor(f/65536),je=f-O*65536,f=Se+O+65535,O=Math.floor(f/65536),Se=f-O*65536,ne+=O-1+37*(O-1),O=1,f=ne+O+65535,O=Math.floor(f/65536),ne=f-O*65536,f=fe+O+65535,O=Math.floor(f/65536),fe=f-O*65536,f=Ie+O+65535,O=Math.floor(f/65536),Ie=f-O*65536,f=He+O+65535,O=Math.floor(f/65536),He=f-O*65536,f=Ve+O+65535,O=Math.floor(f/65536),Ve=f-O*65536,f=Ue+O+65535,O=Math.floor(f/65536),Ue=f-O*65536,f=dt+O+65535,O=Math.floor(f/65536),dt=f-O*65536,f=gt+O+65535,O=Math.floor(f/65536),gt=f-O*65536,f=Me+O+65535,O=Math.floor(f/65536),Me=f-O*65536,f=xe+O+65535,O=Math.floor(f/65536),xe=f-O*65536,f=$e+O+65535,O=Math.floor(f/65536),$e=f-O*65536,f=De+O+65535,O=Math.floor(f/65536),De=f-O*65536,f=qe+O+65535,O=Math.floor(f/65536),qe=f-O*65536,f=Ae+O+65535,O=Math.floor(f/65536),Ae=f-O*65536,f=je+O+65535,O=Math.floor(f/65536),je=f-O*65536,f=Se+O+65535,O=Math.floor(f/65536),Se=f-O*65536,ne+=O-1+37*(O-1),q[0]=ne,q[1]=fe,q[2]=Ie,q[3]=He,q[4]=Ve,q[5]=Ue,q[6]=dt,q[7]=gt,q[8]=Me,q[9]=xe,q[10]=$e,q[11]=De,q[12]=qe,q[13]=Ae,q[14]=je,q[15]=Se}function m(q,L){h(q,L,L)}function k(q,L){const N=o();let f;for(f=0;f<16;f++)N[f]=L[f];for(f=253;f>=0;f--)m(N,N),f!==2&&f!==4&&h(N,N,L);for(f=0;f<16;f++)q[f]=N[f]}function G(q,L){const N=o();let f;for(f=0;f<16;f++)N[f]=L[f];for(f=250;f>=0;f--)m(N,N),f!==1&&h(N,N,L);for(f=0;f<16;f++)q[f]=N[f]}function se(q,L){const N=o(),f=o(),O=o(),ne=o(),fe=o(),Ie=o(),He=o(),Ve=o(),Ue=o();b(N,q[1],q[0]),b(Ue,L[1],L[0]),h(N,N,Ue),C(f,q[0],q[1]),C(Ue,L[0],L[1]),h(f,f,Ue),h(O,q[3],L[3]),h(O,O,d),h(ne,q[2],L[2]),C(ne,ne,ne),b(fe,f,N),b(Ie,ne,O),C(He,ne,O),C(Ve,f,N),h(q[0],fe,Ie),h(q[1],Ve,He),h(q[2],He,Ie),h(q[3],fe,Ve)}function ce(q,L,N){for(let f=0;f<4;f++)B(q[f],L[f],N)}function ge(q,L){const N=o(),f=o(),O=o();k(O,L[2]),h(N,L[0],O),h(f,L[1],O),K(q,f),q[31]^=U(N)<<7}function $(q,L,N){P(q[0],l),P(q[1],p),P(q[2],p),P(q[3],l);for(let f=255;f>=0;--f){const O=N[f/8|0]>>(f&7)&1;ce(q,L,O),se(L,q),se(q,q),ce(q,L,O)}}function z(q,L){const N=[o(),o(),o(),o()];P(N[0],w),P(N[1],A),P(N[2],p),h(N[3],w,A),$(q,N,L)}function le(q){if(q.length!==i.SEED_LENGTH)throw new Error(`ed25519: seed must be ${i.SEED_LENGTH} bytes`);const L=(0,t.hash)(q);L[0]&=248,L[31]&=127,L[31]|=64;const N=new Uint8Array(32),f=[o(),o(),o(),o()];z(f,L),ge(N,f);const O=new Uint8Array(64);return O.set(q),O.set(N,32),{publicKey:N,secretKey:O}}i.generateKeyPairFromSeed=le;function te(q){const L=(0,e.randomBytes)(32,q),N=le(L);return(0,s.wipe)(L),N}i.generateKeyPair=te;function W(q){if(q.length!==i.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${i.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(q.subarray(32))}i.extractPublicKeyFromSecretKey=W;const ee=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Y(q,L){let N,f,O,ne;for(f=63;f>=32;--f){for(N=0,O=f-32,ne=f-12;O<ne;++O)L[O]+=N-16*L[f]*ee[O-(f-32)],N=Math.floor((L[O]+128)/256),L[O]-=N*256;L[O]+=N,L[f]=0}for(N=0,O=0;O<32;O++)L[O]+=N-(L[31]>>4)*ee[O],N=L[O]>>8,L[O]&=255;for(O=0;O<32;O++)L[O]-=N*ee[O];for(f=0;f<32;f++)L[f+1]+=L[f]>>8,q[f]=L[f]&255}function re(q){const L=new Float64Array(64);for(let N=0;N<64;N++)L[N]=q[N];for(let N=0;N<64;N++)q[N]=0;Y(q,L)}function Oe(q,L){const N=new Float64Array(64),f=[o(),o(),o(),o()],O=(0,t.hash)(q.subarray(0,32));O[0]&=248,O[31]&=127,O[31]|=64;const ne=new Uint8Array(64);ne.set(O.subarray(32),32);const fe=new t.SHA512;fe.update(ne.subarray(32)),fe.update(L);const Ie=fe.digest();fe.clean(),re(Ie),z(f,Ie),ge(ne,f),fe.reset(),fe.update(ne.subarray(0,32)),fe.update(q.subarray(32)),fe.update(L);const He=fe.digest();re(He);for(let Ve=0;Ve<32;Ve++)N[Ve]=Ie[Ve];for(let Ve=0;Ve<32;Ve++)for(let Ue=0;Ue<32;Ue++)N[Ve+Ue]+=He[Ve]*O[Ue];return Y(ne.subarray(32),N),ne}i.sign=Oe;function ie(q,L){const N=o(),f=o(),O=o(),ne=o(),fe=o(),Ie=o(),He=o();return P(q[2],p),x(q[1],L),m(O,q[1]),h(ne,O,_),b(O,O,q[2]),C(ne,q[2],ne),m(fe,ne),m(Ie,fe),h(He,Ie,fe),h(N,He,O),h(N,N,ne),G(N,N),h(N,N,O),h(N,N,ne),h(N,N,ne),h(q[0],N,ne),m(f,q[0]),h(f,f,ne),R(f,O)&&h(q[0],q[0],S),m(f,q[0]),h(f,f,ne),R(f,O)?-1:(U(q[0])===L[31]>>7&&b(q[0],l,q[0]),h(q[3],q[0],q[1]),0)}function be(q,L,N){const f=new Uint8Array(32),O=[o(),o(),o(),o()],ne=[o(),o(),o(),o()];if(N.length!==i.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${i.SIGNATURE_LENGTH} bytes`);if(ie(ne,q))return!1;const fe=new t.SHA512;fe.update(N.subarray(0,32)),fe.update(q),fe.update(L);const Ie=fe.digest();return re(Ie),$(O,ne,Ie),z(ne,N.subarray(32)),se(O,ne),ge(f,O),!oe(N,f)}i.verify=be;function he(q){let L=[o(),o(),o(),o()];if(ie(L,q))throw new Error("Ed25519: invalid public key");let N=o(),f=o(),O=L[1];C(N,p,O),b(f,p,O),k(f,f),h(N,N,f);let ne=new Uint8Array(32);return K(ne,N),ne}i.convertPublicKeyToX25519=he;function ve(q){const L=(0,t.hash)(q.subarray(0,32));L[0]&=248,L[31]&=127,L[31]|=64;const N=new Uint8Array(L.subarray(0,32));return(0,s.wipe)(L),N}i.convertSecretKeyToX25519=ve})(Pu);const sE="EdDSA",oE="JWT",zp=".",Hp="base64url",aE="utf8",cE="utf8",uE=":",hE="did",lE="key",bf="base58btc",fE="z",pE="K36",dE=32;function Mo(i){return cr(_r(ms(i),aE),Hp)}function Bp(i){const e=_r(pE,bf),t=fE+cr(kc([e,i]),bf);return[hE,lE,t].join(uE)}function gE(i){return cr(i,Hp)}function _E(i){return _r([Mo(i.header),Mo(i.payload)].join(zp),cE)}function yE(i){return[Mo(i.header),Mo(i.payload),gE(i.signature)].join(zp)}function wf(i=$n.randomBytes(dE)){return Pu.generateKeyPairFromSeed(i)}async function vE(i,e,t,s,o=ye.fromMiliseconds(Date.now())){const c={alg:sE,typ:oE},l=Bp(s.publicKey),p=o+t,_={iss:l,sub:i,aud:e,iat:o,exp:p},d=_E({header:c,payload:_}),w=Pu.sign(s.secretKey,d);return yE({header:c,payload:_,signature:w})}var Au={},Xo={};Object.defineProperty(Xo,"__esModule",{value:!0});var Zt=Fe,hu=Ir,mE=20;function bE(i,e,t){for(var s=1634760805,o=857760878,c=2036477234,l=1797285236,p=t[3]<<24|t[2]<<16|t[1]<<8|t[0],_=t[7]<<24|t[6]<<16|t[5]<<8|t[4],d=t[11]<<24|t[10]<<16|t[9]<<8|t[8],w=t[15]<<24|t[14]<<16|t[13]<<8|t[12],A=t[19]<<24|t[18]<<16|t[17]<<8|t[16],S=t[23]<<24|t[22]<<16|t[21]<<8|t[20],P=t[27]<<24|t[26]<<16|t[25]<<8|t[24],M=t[31]<<24|t[30]<<16|t[29]<<8|t[28],B=e[3]<<24|e[2]<<16|e[1]<<8|e[0],K=e[7]<<24|e[6]<<16|e[5]<<8|e[4],oe=e[11]<<24|e[10]<<16|e[9]<<8|e[8],R=e[15]<<24|e[14]<<16|e[13]<<8|e[12],U=s,x=o,C=c,b=l,h=p,m=_,k=d,G=w,se=A,ce=S,ge=P,$=M,z=B,le=K,te=oe,W=R,ee=0;ee<mE;ee+=2)U=U+h|0,z^=U,z=z>>>32-16|z<<16,se=se+z|0,h^=se,h=h>>>32-12|h<<12,x=x+m|0,le^=x,le=le>>>32-16|le<<16,ce=ce+le|0,m^=ce,m=m>>>32-12|m<<12,C=C+k|0,te^=C,te=te>>>32-16|te<<16,ge=ge+te|0,k^=ge,k=k>>>32-12|k<<12,b=b+G|0,W^=b,W=W>>>32-16|W<<16,$=$+W|0,G^=$,G=G>>>32-12|G<<12,C=C+k|0,te^=C,te=te>>>32-8|te<<8,ge=ge+te|0,k^=ge,k=k>>>32-7|k<<7,b=b+G|0,W^=b,W=W>>>32-8|W<<8,$=$+W|0,G^=$,G=G>>>32-7|G<<7,x=x+m|0,le^=x,le=le>>>32-8|le<<8,ce=ce+le|0,m^=ce,m=m>>>32-7|m<<7,U=U+h|0,z^=U,z=z>>>32-8|z<<8,se=se+z|0,h^=se,h=h>>>32-7|h<<7,U=U+m|0,W^=U,W=W>>>32-16|W<<16,ge=ge+W|0,m^=ge,m=m>>>32-12|m<<12,x=x+k|0,z^=x,z=z>>>32-16|z<<16,$=$+z|0,k^=$,k=k>>>32-12|k<<12,C=C+G|0,le^=C,le=le>>>32-16|le<<16,se=se+le|0,G^=se,G=G>>>32-12|G<<12,b=b+h|0,te^=b,te=te>>>32-16|te<<16,ce=ce+te|0,h^=ce,h=h>>>32-12|h<<12,C=C+G|0,le^=C,le=le>>>32-8|le<<8,se=se+le|0,G^=se,G=G>>>32-7|G<<7,b=b+h|0,te^=b,te=te>>>32-8|te<<8,ce=ce+te|0,h^=ce,h=h>>>32-7|h<<7,x=x+k|0,z^=x,z=z>>>32-8|z<<8,$=$+z|0,k^=$,k=k>>>32-7|k<<7,U=U+m|0,W^=U,W=W>>>32-8|W<<8,ge=ge+W|0,m^=ge,m=m>>>32-7|m<<7;Zt.writeUint32LE(U+s|0,i,0),Zt.writeUint32LE(x+o|0,i,4),Zt.writeUint32LE(C+c|0,i,8),Zt.writeUint32LE(b+l|0,i,12),Zt.writeUint32LE(h+p|0,i,16),Zt.writeUint32LE(m+_|0,i,20),Zt.writeUint32LE(k+d|0,i,24),Zt.writeUint32LE(G+w|0,i,28),Zt.writeUint32LE(se+A|0,i,32),Zt.writeUint32LE(ce+S|0,i,36),Zt.writeUint32LE(ge+P|0,i,40),Zt.writeUint32LE($+M|0,i,44),Zt.writeUint32LE(z+B|0,i,48),Zt.writeUint32LE(le+K|0,i,52),Zt.writeUint32LE(te+oe|0,i,56),Zt.writeUint32LE(W+R|0,i,60)}function Kp(i,e,t,s,o){if(o===void 0&&(o=0),i.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<t.length)throw new Error("ChaCha: destination is shorter than source");var c,l;if(o===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),l=c.length-e.length,c.set(e,l)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,l=o}for(var p=new Uint8Array(64),_=0;_<t.length;_+=64){bE(p,c,i);for(var d=_;d<_+64&&d<t.length;d++)s[d]=t[d]^p[d-_];EE(c,0,l)}return hu.wipe(p),o===0&&hu.wipe(c),s}Xo.streamXOR=Kp;function wE(i,e,t,s){return s===void 0&&(s=0),hu.wipe(t),Kp(i,e,t,t,s)}Xo.stream=wE;function EE(i,e,t){for(var s=1;t--;)s=s+(i[e]&255)|0,i[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var Vp={},Ri={};Object.defineProperty(Ri,"__esModule",{value:!0});function SE(i,e,t){return~(i-1)&e|i-1&t}Ri.select=SE;function IE(i,e){return(i|0)-(e|0)-1>>>31&1}Ri.lessOrEqual=IE;function Gp(i,e){if(i.length!==e.length)return 0;for(var t=0,s=0;s<i.length;s++)t|=i[s]^e[s];return 1&t-1>>>8}Ri.compare=Gp;function xE(i,e){return i.length===0||e.length===0?!1:Gp(i,e)!==0}Ri.equal=xE;(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Ri,t=Ir;i.DIGEST_LENGTH=16;var s=function(){function l(p){this.digestLength=i.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var _=p[0]|p[1]<<8;this._r[0]=_&8191;var d=p[2]|p[3]<<8;this._r[1]=(_>>>13|d<<3)&8191;var w=p[4]|p[5]<<8;this._r[2]=(d>>>10|w<<6)&7939;var A=p[6]|p[7]<<8;this._r[3]=(w>>>7|A<<9)&8191;var S=p[8]|p[9]<<8;this._r[4]=(A>>>4|S<<12)&255,this._r[5]=S>>>1&8190;var P=p[10]|p[11]<<8;this._r[6]=(S>>>14|P<<2)&8191;var M=p[12]|p[13]<<8;this._r[7]=(P>>>11|M<<5)&8065;var B=p[14]|p[15]<<8;this._r[8]=(M>>>8|B<<8)&8191,this._r[9]=B>>>5&127,this._pad[0]=p[16]|p[17]<<8,this._pad[1]=p[18]|p[19]<<8,this._pad[2]=p[20]|p[21]<<8,this._pad[3]=p[22]|p[23]<<8,this._pad[4]=p[24]|p[25]<<8,this._pad[5]=p[26]|p[27]<<8,this._pad[6]=p[28]|p[29]<<8,this._pad[7]=p[30]|p[31]<<8}return l.prototype._blocks=function(p,_,d){for(var w=this._fin?0:2048,A=this._h[0],S=this._h[1],P=this._h[2],M=this._h[3],B=this._h[4],K=this._h[5],oe=this._h[6],R=this._h[7],U=this._h[8],x=this._h[9],C=this._r[0],b=this._r[1],h=this._r[2],m=this._r[3],k=this._r[4],G=this._r[5],se=this._r[6],ce=this._r[7],ge=this._r[8],$=this._r[9];d>=16;){var z=p[_+0]|p[_+1]<<8;A+=z&8191;var le=p[_+2]|p[_+3]<<8;S+=(z>>>13|le<<3)&8191;var te=p[_+4]|p[_+5]<<8;P+=(le>>>10|te<<6)&8191;var W=p[_+6]|p[_+7]<<8;M+=(te>>>7|W<<9)&8191;var ee=p[_+8]|p[_+9]<<8;B+=(W>>>4|ee<<12)&8191,K+=ee>>>1&8191;var Y=p[_+10]|p[_+11]<<8;oe+=(ee>>>14|Y<<2)&8191;var re=p[_+12]|p[_+13]<<8;R+=(Y>>>11|re<<5)&8191;var Oe=p[_+14]|p[_+15]<<8;U+=(re>>>8|Oe<<8)&8191,x+=Oe>>>5|w;var ie=0,be=ie;be+=A*C,be+=S*(5*$),be+=P*(5*ge),be+=M*(5*ce),be+=B*(5*se),ie=be>>>13,be&=8191,be+=K*(5*G),be+=oe*(5*k),be+=R*(5*m),be+=U*(5*h),be+=x*(5*b),ie+=be>>>13,be&=8191;var he=ie;he+=A*b,he+=S*C,he+=P*(5*$),he+=M*(5*ge),he+=B*(5*ce),ie=he>>>13,he&=8191,he+=K*(5*se),he+=oe*(5*G),he+=R*(5*k),he+=U*(5*m),he+=x*(5*h),ie+=he>>>13,he&=8191;var ve=ie;ve+=A*h,ve+=S*b,ve+=P*C,ve+=M*(5*$),ve+=B*(5*ge),ie=ve>>>13,ve&=8191,ve+=K*(5*ce),ve+=oe*(5*se),ve+=R*(5*G),ve+=U*(5*k),ve+=x*(5*m),ie+=ve>>>13,ve&=8191;var q=ie;q+=A*m,q+=S*h,q+=P*b,q+=M*C,q+=B*(5*$),ie=q>>>13,q&=8191,q+=K*(5*ge),q+=oe*(5*ce),q+=R*(5*se),q+=U*(5*G),q+=x*(5*k),ie+=q>>>13,q&=8191;var L=ie;L+=A*k,L+=S*m,L+=P*h,L+=M*b,L+=B*C,ie=L>>>13,L&=8191,L+=K*(5*$),L+=oe*(5*ge),L+=R*(5*ce),L+=U*(5*se),L+=x*(5*G),ie+=L>>>13,L&=8191;var N=ie;N+=A*G,N+=S*k,N+=P*m,N+=M*h,N+=B*b,ie=N>>>13,N&=8191,N+=K*C,N+=oe*(5*$),N+=R*(5*ge),N+=U*(5*ce),N+=x*(5*se),ie+=N>>>13,N&=8191;var f=ie;f+=A*se,f+=S*G,f+=P*k,f+=M*m,f+=B*h,ie=f>>>13,f&=8191,f+=K*b,f+=oe*C,f+=R*(5*$),f+=U*(5*ge),f+=x*(5*ce),ie+=f>>>13,f&=8191;var O=ie;O+=A*ce,O+=S*se,O+=P*G,O+=M*k,O+=B*m,ie=O>>>13,O&=8191,O+=K*h,O+=oe*b,O+=R*C,O+=U*(5*$),O+=x*(5*ge),ie+=O>>>13,O&=8191;var ne=ie;ne+=A*ge,ne+=S*ce,ne+=P*se,ne+=M*G,ne+=B*k,ie=ne>>>13,ne&=8191,ne+=K*m,ne+=oe*h,ne+=R*b,ne+=U*C,ne+=x*(5*$),ie+=ne>>>13,ne&=8191;var fe=ie;fe+=A*$,fe+=S*ge,fe+=P*ce,fe+=M*se,fe+=B*G,ie=fe>>>13,fe&=8191,fe+=K*k,fe+=oe*m,fe+=R*h,fe+=U*b,fe+=x*C,ie+=fe>>>13,fe&=8191,ie=(ie<<2)+ie|0,ie=ie+be|0,be=ie&8191,ie=ie>>>13,he+=ie,A=be,S=he,P=ve,M=q,B=L,K=N,oe=f,R=O,U=ne,x=fe,_+=16,d-=16}this._h[0]=A,this._h[1]=S,this._h[2]=P,this._h[3]=M,this._h[4]=B,this._h[5]=K,this._h[6]=oe,this._h[7]=R,this._h[8]=U,this._h[9]=x},l.prototype.finish=function(p,_){_===void 0&&(_=0);var d=new Uint16Array(10),w,A,S,P;if(this._leftover){for(P=this._leftover,this._buffer[P++]=1;P<16;P++)this._buffer[P]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(w=this._h[1]>>>13,this._h[1]&=8191,P=2;P<10;P++)this._h[P]+=w,w=this._h[P]>>>13,this._h[P]&=8191;for(this._h[0]+=w*5,w=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=w,w=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=w,d[0]=this._h[0]+5,w=d[0]>>>13,d[0]&=8191,P=1;P<10;P++)d[P]=this._h[P]+w,w=d[P]>>>13,d[P]&=8191;for(d[9]-=8192,A=(w^1)-1,P=0;P<10;P++)d[P]&=A;for(A=~A,P=0;P<10;P++)this._h[P]=this._h[P]&A|d[P];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,S=this._h[0]+this._pad[0],this._h[0]=S&65535,P=1;P<8;P++)S=(this._h[P]+this._pad[P]|0)+(S>>>16)|0,this._h[P]=S&65535;return p[_+0]=this._h[0]>>>0,p[_+1]=this._h[0]>>>8,p[_+2]=this._h[1]>>>0,p[_+3]=this._h[1]>>>8,p[_+4]=this._h[2]>>>0,p[_+5]=this._h[2]>>>8,p[_+6]=this._h[3]>>>0,p[_+7]=this._h[3]>>>8,p[_+8]=this._h[4]>>>0,p[_+9]=this._h[4]>>>8,p[_+10]=this._h[5]>>>0,p[_+11]=this._h[5]>>>8,p[_+12]=this._h[6]>>>0,p[_+13]=this._h[6]>>>8,p[_+14]=this._h[7]>>>0,p[_+15]=this._h[7]>>>8,this._finished=!0,this},l.prototype.update=function(p){var _=0,d=p.length,w;if(this._leftover){w=16-this._leftover,w>d&&(w=d);for(var A=0;A<w;A++)this._buffer[this._leftover+A]=p[_+A];if(d-=w,_+=w,this._leftover+=w,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(d>=16&&(w=d-d%16,this._blocks(p,_,w),_+=w,d-=w),d){for(var A=0;A<d;A++)this._buffer[this._leftover+A]=p[_+A];this._leftover+=d}return this},l.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var p=new Uint8Array(16);return this.finish(p),p},l.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},l}();i.Poly1305=s;function o(l,p){var _=new s(l);_.update(p);var d=_.digest();return _.clean(),d}i.oneTimeAuth=o;function c(l,p){return l.length!==i.DIGEST_LENGTH||p.length!==i.DIGEST_LENGTH?!1:e.equal(l,p)}i.equal=c})(Vp);(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Xo,t=Vp,s=Ir,o=Fe,c=Ri;i.KEY_LENGTH=32,i.NONCE_LENGTH=12,i.TAG_LENGTH=16;var l=new Uint8Array(16),p=function(){function _(d){if(this.nonceLength=i.NONCE_LENGTH,this.tagLength=i.TAG_LENGTH,d.length!==i.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(d)}return _.prototype.seal=function(d,w,A,S){if(d.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var P=new Uint8Array(16);P.set(d,P.length-d.length);var M=new Uint8Array(32);e.stream(this._key,P,M,4);var B=w.length+this.tagLength,K;if(S){if(S.length!==B)throw new Error("ChaCha20Poly1305: incorrect destination length");K=S}else K=new Uint8Array(B);return e.streamXOR(this._key,P,w,K,4),this._authenticate(K.subarray(K.length-this.tagLength,K.length),M,K.subarray(0,K.length-this.tagLength),A),s.wipe(P),K},_.prototype.open=function(d,w,A,S){if(d.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(w.length<this.tagLength)return null;var P=new Uint8Array(16);P.set(d,P.length-d.length);var M=new Uint8Array(32);e.stream(this._key,P,M,4);var B=new Uint8Array(this.tagLength);if(this._authenticate(B,M,w.subarray(0,w.length-this.tagLength),A),!c.equal(B,w.subarray(w.length-this.tagLength,w.length)))return null;var K=w.length-this.tagLength,oe;if(S){if(S.length!==K)throw new Error("ChaCha20Poly1305: incorrect destination length");oe=S}else oe=new Uint8Array(K);return e.streamXOR(this._key,P,w.subarray(0,w.length-this.tagLength),oe,4),s.wipe(P),oe},_.prototype.clean=function(){return s.wipe(this._key),this},_.prototype._authenticate=function(d,w,A,S){var P=new t.Poly1305(w);S&&(P.update(S),S.length%16>0&&P.update(l.subarray(S.length%16))),P.update(A),A.length%16>0&&P.update(l.subarray(A.length%16));var M=new Uint8Array(8);S&&o.writeUint64LE(S.length,M),P.update(M),o.writeUint64LE(A.length,M),P.update(M);for(var B=P.digest(),K=0;K<B.length;K++)d[K]=B[K];P.clean(),s.wipe(B),s.wipe(M)},_}();i.ChaCha20Poly1305=p})(Au);var kp={},Ss={},Tu={};Object.defineProperty(Tu,"__esModule",{value:!0});function OE(i){return typeof i.saveState<"u"&&typeof i.restoreState<"u"&&typeof i.cleanSavedState<"u"}Tu.isSerializableHash=OE;Object.defineProperty(Ss,"__esModule",{value:!0});var Qr=Tu,PE=Ri,AE=Ir,Wp=function(){function i(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(s).clean():s.set(t);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),Qr.isSerializableHash(this._inner)&&Qr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),AE.wipe(s)}return i.prototype.reset=function(){if(!Qr.isSerializableHash(this._inner)||!Qr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.clean=function(){Qr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Qr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},i.prototype.update=function(e){return this._inner.update(e),this},i.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},i.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},i.prototype.saveState=function(){if(!Qr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},i.prototype.restoreState=function(e){if(!Qr.isSerializableHash(this._inner)||!Qr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.cleanSavedState=function(e){if(!Qr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},i}();Ss.HMAC=Wp;function TE(i,e,t){var s=new Wp(i,e);s.update(t);var o=s.digest();return s.clean(),o}Ss.hmac=TE;Ss.equal=PE.equal;Object.defineProperty(kp,"__esModule",{value:!0});var Ef=Ss,Sf=Ir,CE=function(){function i(e,t,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=o;var c=Ef.hmac(this._hash,s,t);this._hmac=new Ef.HMAC(e,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return i.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},i.prototype.expand=function(e){for(var t=new Uint8Array(e),s=0;s<t.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[s]=this._buffer[this._bufpos++];return t},i.prototype.clean=function(){this._hmac.clean(),Sf.wipe(this._buffer),Sf.wipe(this._counter),this._bufpos=0},i}(),NE=kp.HKDF=CE,Zo={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Fe,t=Ir;i.DIGEST_LENGTH=32,i.BLOCK_SIZE=64;var s=function(){function p(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return p.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},p.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},p.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},p.prototype.update=function(_,d){if(d===void 0&&(d=_.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var w=0;if(this._bytesHashed+=d,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&d>0;)this._buffer[this._bufferLength++]=_[w++],d--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(d>=this.blockSize&&(w=c(this._temp,this._state,_,w,d),d%=this.blockSize);d>0;)this._buffer[this._bufferLength++]=_[w++],d--;return this},p.prototype.finish=function(_){if(!this._finished){var d=this._bytesHashed,w=this._bufferLength,A=d/536870912|0,S=d<<3,P=d%64<56?64:128;this._buffer[w]=128;for(var M=w+1;M<P-8;M++)this._buffer[M]=0;e.writeUint32BE(A,this._buffer,P-8),e.writeUint32BE(S,this._buffer,P-4),c(this._temp,this._state,this._buffer,0,P),this._finished=!0}for(var M=0;M<this.digestLength/4;M++)e.writeUint32BE(this._state[M],_,M*4);return this},p.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},p.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},p.prototype.restoreState=function(_){return this._state.set(_.state),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},p.prototype.cleanSavedState=function(_){t.wipe(_.state),_.buffer&&t.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},p}();i.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(p,_,d,w,A){for(;A>=64;){for(var S=_[0],P=_[1],M=_[2],B=_[3],K=_[4],oe=_[5],R=_[6],U=_[7],x=0;x<16;x++){var C=w+x*4;p[x]=e.readUint32BE(d,C)}for(var x=16;x<64;x++){var b=p[x-2],h=(b>>>17|b<<32-17)^(b>>>19|b<<32-19)^b>>>10;b=p[x-15];var m=(b>>>7|b<<32-7)^(b>>>18|b<<32-18)^b>>>3;p[x]=(h+p[x-7]|0)+(m+p[x-16]|0)}for(var x=0;x<64;x++){var h=(((K>>>6|K<<26)^(K>>>11|K<<21)^(K>>>25|K<<7))+(K&oe^~K&R)|0)+(U+(o[x]+p[x]|0)|0)|0,m=((S>>>2|S<<32-2)^(S>>>13|S<<32-13)^(S>>>22|S<<32-22))+(S&P^S&M^P&M)|0;U=R,R=oe,oe=K,K=B+h|0,B=M,M=P,P=S,S=h+m|0}_[0]+=S,_[1]+=P,_[2]+=M,_[3]+=B,_[4]+=K,_[5]+=oe,_[6]+=R,_[7]+=U,w+=64,A-=64}return w}function l(p){var _=new s;_.update(p);var d=_.digest();return _.clean(),d}i.hash=l})(Zo);var Cu={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.sharedKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.scalarMultBase=i.scalarMult=i.SHARED_KEY_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=void 0;const e=$n,t=Ir;i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=32,i.SHARED_KEY_LENGTH=32;function s(x){const C=new Float64Array(16);if(x)for(let b=0;b<x.length;b++)C[b]=x[b];return C}const o=new Uint8Array(32);o[0]=9;const c=s([56129,1]);function l(x){let C=1;for(let b=0;b<16;b++){let h=x[b]+C+65535;C=Math.floor(h/65536),x[b]=h-C*65536}x[0]+=C-1+37*(C-1)}function p(x,C,b){const h=~(b-1);for(let m=0;m<16;m++){const k=h&(x[m]^C[m]);x[m]^=k,C[m]^=k}}function _(x,C){const b=s(),h=s();for(let m=0;m<16;m++)h[m]=C[m];l(h),l(h),l(h);for(let m=0;m<2;m++){b[0]=h[0]-65517;for(let G=1;G<15;G++)b[G]=h[G]-65535-(b[G-1]>>16&1),b[G-1]&=65535;b[15]=h[15]-32767-(b[14]>>16&1);const k=b[15]>>16&1;b[14]&=65535,p(h,b,1-k)}for(let m=0;m<16;m++)x[2*m]=h[m]&255,x[2*m+1]=h[m]>>8}function d(x,C){for(let b=0;b<16;b++)x[b]=C[2*b]+(C[2*b+1]<<8);x[15]&=32767}function w(x,C,b){for(let h=0;h<16;h++)x[h]=C[h]+b[h]}function A(x,C,b){for(let h=0;h<16;h++)x[h]=C[h]-b[h]}function S(x,C,b){let h,m,k=0,G=0,se=0,ce=0,ge=0,$=0,z=0,le=0,te=0,W=0,ee=0,Y=0,re=0,Oe=0,ie=0,be=0,he=0,ve=0,q=0,L=0,N=0,f=0,O=0,ne=0,fe=0,Ie=0,He=0,Ve=0,Ue=0,dt=0,gt=0,Me=b[0],xe=b[1],$e=b[2],De=b[3],qe=b[4],Ae=b[5],je=b[6],Se=b[7],Te=b[8],Be=b[9],Pe=b[10],Ge=b[11],We=b[12],et=b[13],tt=b[14],Je=b[15];h=C[0],k+=h*Me,G+=h*xe,se+=h*$e,ce+=h*De,ge+=h*qe,$+=h*Ae,z+=h*je,le+=h*Se,te+=h*Te,W+=h*Be,ee+=h*Pe,Y+=h*Ge,re+=h*We,Oe+=h*et,ie+=h*tt,be+=h*Je,h=C[1],G+=h*Me,se+=h*xe,ce+=h*$e,ge+=h*De,$+=h*qe,z+=h*Ae,le+=h*je,te+=h*Se,W+=h*Te,ee+=h*Be,Y+=h*Pe,re+=h*Ge,Oe+=h*We,ie+=h*et,be+=h*tt,he+=h*Je,h=C[2],se+=h*Me,ce+=h*xe,ge+=h*$e,$+=h*De,z+=h*qe,le+=h*Ae,te+=h*je,W+=h*Se,ee+=h*Te,Y+=h*Be,re+=h*Pe,Oe+=h*Ge,ie+=h*We,be+=h*et,he+=h*tt,ve+=h*Je,h=C[3],ce+=h*Me,ge+=h*xe,$+=h*$e,z+=h*De,le+=h*qe,te+=h*Ae,W+=h*je,ee+=h*Se,Y+=h*Te,re+=h*Be,Oe+=h*Pe,ie+=h*Ge,be+=h*We,he+=h*et,ve+=h*tt,q+=h*Je,h=C[4],ge+=h*Me,$+=h*xe,z+=h*$e,le+=h*De,te+=h*qe,W+=h*Ae,ee+=h*je,Y+=h*Se,re+=h*Te,Oe+=h*Be,ie+=h*Pe,be+=h*Ge,he+=h*We,ve+=h*et,q+=h*tt,L+=h*Je,h=C[5],$+=h*Me,z+=h*xe,le+=h*$e,te+=h*De,W+=h*qe,ee+=h*Ae,Y+=h*je,re+=h*Se,Oe+=h*Te,ie+=h*Be,be+=h*Pe,he+=h*Ge,ve+=h*We,q+=h*et,L+=h*tt,N+=h*Je,h=C[6],z+=h*Me,le+=h*xe,te+=h*$e,W+=h*De,ee+=h*qe,Y+=h*Ae,re+=h*je,Oe+=h*Se,ie+=h*Te,be+=h*Be,he+=h*Pe,ve+=h*Ge,q+=h*We,L+=h*et,N+=h*tt,f+=h*Je,h=C[7],le+=h*Me,te+=h*xe,W+=h*$e,ee+=h*De,Y+=h*qe,re+=h*Ae,Oe+=h*je,ie+=h*Se,be+=h*Te,he+=h*Be,ve+=h*Pe,q+=h*Ge,L+=h*We,N+=h*et,f+=h*tt,O+=h*Je,h=C[8],te+=h*Me,W+=h*xe,ee+=h*$e,Y+=h*De,re+=h*qe,Oe+=h*Ae,ie+=h*je,be+=h*Se,he+=h*Te,ve+=h*Be,q+=h*Pe,L+=h*Ge,N+=h*We,f+=h*et,O+=h*tt,ne+=h*Je,h=C[9],W+=h*Me,ee+=h*xe,Y+=h*$e,re+=h*De,Oe+=h*qe,ie+=h*Ae,be+=h*je,he+=h*Se,ve+=h*Te,q+=h*Be,L+=h*Pe,N+=h*Ge,f+=h*We,O+=h*et,ne+=h*tt,fe+=h*Je,h=C[10],ee+=h*Me,Y+=h*xe,re+=h*$e,Oe+=h*De,ie+=h*qe,be+=h*Ae,he+=h*je,ve+=h*Se,q+=h*Te,L+=h*Be,N+=h*Pe,f+=h*Ge,O+=h*We,ne+=h*et,fe+=h*tt,Ie+=h*Je,h=C[11],Y+=h*Me,re+=h*xe,Oe+=h*$e,ie+=h*De,be+=h*qe,he+=h*Ae,ve+=h*je,q+=h*Se,L+=h*Te,N+=h*Be,f+=h*Pe,O+=h*Ge,ne+=h*We,fe+=h*et,Ie+=h*tt,He+=h*Je,h=C[12],re+=h*Me,Oe+=h*xe,ie+=h*$e,be+=h*De,he+=h*qe,ve+=h*Ae,q+=h*je,L+=h*Se,N+=h*Te,f+=h*Be,O+=h*Pe,ne+=h*Ge,fe+=h*We,Ie+=h*et,He+=h*tt,Ve+=h*Je,h=C[13],Oe+=h*Me,ie+=h*xe,be+=h*$e,he+=h*De,ve+=h*qe,q+=h*Ae,L+=h*je,N+=h*Se,f+=h*Te,O+=h*Be,ne+=h*Pe,fe+=h*Ge,Ie+=h*We,He+=h*et,Ve+=h*tt,Ue+=h*Je,h=C[14],ie+=h*Me,be+=h*xe,he+=h*$e,ve+=h*De,q+=h*qe,L+=h*Ae,N+=h*je,f+=h*Se,O+=h*Te,ne+=h*Be,fe+=h*Pe,Ie+=h*Ge,He+=h*We,Ve+=h*et,Ue+=h*tt,dt+=h*Je,h=C[15],be+=h*Me,he+=h*xe,ve+=h*$e,q+=h*De,L+=h*qe,N+=h*Ae,f+=h*je,O+=h*Se,ne+=h*Te,fe+=h*Be,Ie+=h*Pe,He+=h*Ge,Ve+=h*We,Ue+=h*et,dt+=h*tt,gt+=h*Je,k+=38*he,G+=38*ve,se+=38*q,ce+=38*L,ge+=38*N,$+=38*f,z+=38*O,le+=38*ne,te+=38*fe,W+=38*Ie,ee+=38*He,Y+=38*Ve,re+=38*Ue,Oe+=38*dt,ie+=38*gt,m=1,h=k+m+65535,m=Math.floor(h/65536),k=h-m*65536,h=G+m+65535,m=Math.floor(h/65536),G=h-m*65536,h=se+m+65535,m=Math.floor(h/65536),se=h-m*65536,h=ce+m+65535,m=Math.floor(h/65536),ce=h-m*65536,h=ge+m+65535,m=Math.floor(h/65536),ge=h-m*65536,h=$+m+65535,m=Math.floor(h/65536),$=h-m*65536,h=z+m+65535,m=Math.floor(h/65536),z=h-m*65536,h=le+m+65535,m=Math.floor(h/65536),le=h-m*65536,h=te+m+65535,m=Math.floor(h/65536),te=h-m*65536,h=W+m+65535,m=Math.floor(h/65536),W=h-m*65536,h=ee+m+65535,m=Math.floor(h/65536),ee=h-m*65536,h=Y+m+65535,m=Math.floor(h/65536),Y=h-m*65536,h=re+m+65535,m=Math.floor(h/65536),re=h-m*65536,h=Oe+m+65535,m=Math.floor(h/65536),Oe=h-m*65536,h=ie+m+65535,m=Math.floor(h/65536),ie=h-m*65536,h=be+m+65535,m=Math.floor(h/65536),be=h-m*65536,k+=m-1+37*(m-1),m=1,h=k+m+65535,m=Math.floor(h/65536),k=h-m*65536,h=G+m+65535,m=Math.floor(h/65536),G=h-m*65536,h=se+m+65535,m=Math.floor(h/65536),se=h-m*65536,h=ce+m+65535,m=Math.floor(h/65536),ce=h-m*65536,h=ge+m+65535,m=Math.floor(h/65536),ge=h-m*65536,h=$+m+65535,m=Math.floor(h/65536),$=h-m*65536,h=z+m+65535,m=Math.floor(h/65536),z=h-m*65536,h=le+m+65535,m=Math.floor(h/65536),le=h-m*65536,h=te+m+65535,m=Math.floor(h/65536),te=h-m*65536,h=W+m+65535,m=Math.floor(h/65536),W=h-m*65536,h=ee+m+65535,m=Math.floor(h/65536),ee=h-m*65536,h=Y+m+65535,m=Math.floor(h/65536),Y=h-m*65536,h=re+m+65535,m=Math.floor(h/65536),re=h-m*65536,h=Oe+m+65535,m=Math.floor(h/65536),Oe=h-m*65536,h=ie+m+65535,m=Math.floor(h/65536),ie=h-m*65536,h=be+m+65535,m=Math.floor(h/65536),be=h-m*65536,k+=m-1+37*(m-1),x[0]=k,x[1]=G,x[2]=se,x[3]=ce,x[4]=ge,x[5]=$,x[6]=z,x[7]=le,x[8]=te,x[9]=W,x[10]=ee,x[11]=Y,x[12]=re,x[13]=Oe,x[14]=ie,x[15]=be}function P(x,C){S(x,C,C)}function M(x,C){const b=s();for(let h=0;h<16;h++)b[h]=C[h];for(let h=253;h>=0;h--)P(b,b),h!==2&&h!==4&&S(b,b,C);for(let h=0;h<16;h++)x[h]=b[h]}function B(x,C){const b=new Uint8Array(32),h=new Float64Array(80),m=s(),k=s(),G=s(),se=s(),ce=s(),ge=s();for(let te=0;te<31;te++)b[te]=x[te];b[31]=x[31]&127|64,b[0]&=248,d(h,C);for(let te=0;te<16;te++)k[te]=h[te];m[0]=se[0]=1;for(let te=254;te>=0;--te){const W=b[te>>>3]>>>(te&7)&1;p(m,k,W),p(G,se,W),w(ce,m,G),A(m,m,G),w(G,k,se),A(k,k,se),P(se,ce),P(ge,m),S(m,G,m),S(G,k,ce),w(ce,m,G),A(m,m,G),P(k,m),A(G,se,ge),S(m,G,c),w(m,m,se),S(G,G,m),S(m,se,ge),S(se,k,h),P(k,ce),p(m,k,W),p(G,se,W)}for(let te=0;te<16;te++)h[te+16]=m[te],h[te+32]=G[te],h[te+48]=k[te],h[te+64]=se[te];const $=h.subarray(32),z=h.subarray(16);M($,$),S(z,z,$);const le=new Uint8Array(32);return _(le,z),le}i.scalarMult=B;function K(x){return B(x,o)}i.scalarMultBase=K;function oe(x){if(x.length!==i.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${i.SECRET_KEY_LENGTH} bytes`);const C=new Uint8Array(x);return{publicKey:K(C),secretKey:C}}i.generateKeyPairFromSeed=oe;function R(x){const C=(0,e.randomBytes)(32,x),b=oe(C);return(0,t.wipe)(C),b}i.generateKeyPair=R;function U(x,C,b=!1){if(x.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(C.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const h=B(x,C);if(b){let m=0;for(let k=0;k<h.length;k++)m|=h[k];if(m===0)throw new Error("X25519: invalid shared key")}return h}i.sharedKey=U})(Cu);var lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.getLocalStorage=lt.getLocalStorageOrThrow=lt.getCrypto=lt.getCryptoOrThrow=Jp=lt.getLocation=lt.getLocationOrThrow=Nu=lt.getNavigator=lt.getNavigatorOrThrow=Yp=lt.getDocument=lt.getDocumentOrThrow=lt.getFromWindowOrThrow=lt.getFromWindow=void 0;function tn(i){let e;return typeof window<"u"&&typeof window[i]<"u"&&(e=window[i]),e}lt.getFromWindow=tn;function Dn(i){const e=tn(i);if(!e)throw new Error(`${i} is not defined in Window`);return e}lt.getFromWindowOrThrow=Dn;function RE(){return Dn("document")}lt.getDocumentOrThrow=RE;function $E(){return tn("document")}var Yp=lt.getDocument=$E;function DE(){return Dn("navigator")}lt.getNavigatorOrThrow=DE;function jE(){return tn("navigator")}var Nu=lt.getNavigator=jE;function FE(){return Dn("location")}lt.getLocationOrThrow=FE;function UE(){return tn("location")}var Jp=lt.getLocation=UE;function LE(){return Dn("crypto")}lt.getCryptoOrThrow=LE;function ME(){return tn("crypto")}lt.getCrypto=ME;function qE(){return Dn("localStorage")}lt.getLocalStorageOrThrow=qE;function zE(){return tn("localStorage")}lt.getLocalStorage=zE;var Ru={};Object.defineProperty(Ru,"__esModule",{value:!0});var Xp=Ru.getWindowMetadata=void 0;const If=lt;function HE(){let i,e;try{i=If.getDocumentOrThrow(),e=If.getLocationOrThrow()}catch{return null}function t(){const A=i.getElementsByTagName("link"),S=[];for(let P=0;P<A.length;P++){const M=A[P],B=M.getAttribute("rel");if(B&&B.toLowerCase().indexOf("icon")>-1){const K=M.getAttribute("href");if(K)if(K.toLowerCase().indexOf("https:")===-1&&K.toLowerCase().indexOf("http:")===-1&&K.indexOf("//")!==0){let oe=e.protocol+"//"+e.host;if(K.indexOf("/")===0)oe+=K;else{const R=e.pathname.split("/");R.pop();const U=R.join("/");oe+=U+"/"+K}S.push(oe)}else if(K.indexOf("//")===0){const oe=e.protocol+K;S.push(oe)}else S.push(K)}}return S}function s(...A){const S=i.getElementsByTagName("meta");for(let P=0;P<S.length;P++){const M=S[P],B=["itemprop","property","name"].map(K=>M.getAttribute(K)).filter(K=>K?A.includes(K):!1);if(B.length&&B){const K=M.getAttribute("content");if(K)return K}}return""}function o(){let A=s("name","og:site_name","og:title","twitter:title");return A||(A=i.title),A}function c(){return s("description","og:description","twitter:description","keywords")}const l=o(),p=c(),_=e.origin,d=t();return{description:p,url:_,icons:d,name:l}}Xp=Ru.getWindowMetadata=HE;var bs={},BE=i=>encodeURIComponent(i).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Zp="%[a-f0-9]{2}",xf=new RegExp("("+Zp+")|([^%]+?)","gi"),Of=new RegExp("("+Zp+")+","gi");function lu(i,e){try{return[decodeURIComponent(i.join(""))]}catch{}if(i.length===1)return i;e=e||1;var t=i.slice(0,e),s=i.slice(e);return Array.prototype.concat.call([],lu(t),lu(s))}function KE(i){try{return decodeURIComponent(i)}catch{for(var e=i.match(xf)||[],t=1;t<e.length;t++)i=lu(e,t).join(""),e=i.match(xf)||[];return i}}function VE(i){for(var e={"%FE%FF":"","%FF%FE":""},t=Of.exec(i);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var s=KE(t[0]);s!==t[0]&&(e[t[0]]=s)}t=Of.exec(i)}e["%C2"]="";for(var o=Object.keys(e),c=0;c<o.length;c++){var l=o[c];i=i.replace(new RegExp(l,"g"),e[l])}return i}var GE=function(i){if(typeof i!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof i+"`");try{return i=i.replace(/\+/g," "),decodeURIComponent(i)}catch{return VE(i)}},kE=(i,e)=>{if(!(typeof i=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[i];const t=i.indexOf(e);return t===-1?[i]:[i.slice(0,t),i.slice(t+e.length)]},WE=function(i,e){for(var t={},s=Object.keys(i),o=Array.isArray(e),c=0;c<s.length;c++){var l=s[c],p=i[l];(o?e.indexOf(l)!==-1:e(l,p,i))&&(t[l]=p)}return t};(function(i){const e=BE,t=GE,s=kE,o=WE,c=R=>R==null,l=Symbol("encodeFragmentIdentifier");function p(R){switch(R.arrayFormat){case"index":return U=>(x,C)=>{const b=x.length;return C===void 0||R.skipNull&&C===null||R.skipEmptyString&&C===""?x:C===null?[...x,[w(U,R),"[",b,"]"].join("")]:[...x,[w(U,R),"[",w(b,R),"]=",w(C,R)].join("")]};case"bracket":return U=>(x,C)=>C===void 0||R.skipNull&&C===null||R.skipEmptyString&&C===""?x:C===null?[...x,[w(U,R),"[]"].join("")]:[...x,[w(U,R),"[]=",w(C,R)].join("")];case"colon-list-separator":return U=>(x,C)=>C===void 0||R.skipNull&&C===null||R.skipEmptyString&&C===""?x:C===null?[...x,[w(U,R),":list="].join("")]:[...x,[w(U,R),":list=",w(C,R)].join("")];case"comma":case"separator":case"bracket-separator":{const U=R.arrayFormat==="bracket-separator"?"[]=":"=";return x=>(C,b)=>b===void 0||R.skipNull&&b===null||R.skipEmptyString&&b===""?C:(b=b===null?"":b,C.length===0?[[w(x,R),U,w(b,R)].join("")]:[[C,w(b,R)].join(R.arrayFormatSeparator)])}default:return U=>(x,C)=>C===void 0||R.skipNull&&C===null||R.skipEmptyString&&C===""?x:C===null?[...x,w(U,R)]:[...x,[w(U,R),"=",w(C,R)].join("")]}}function _(R){let U;switch(R.arrayFormat){case"index":return(x,C,b)=>{if(U=/\[(\d*)\]$/.exec(x),x=x.replace(/\[\d*\]$/,""),!U){b[x]=C;return}b[x]===void 0&&(b[x]={}),b[x][U[1]]=C};case"bracket":return(x,C,b)=>{if(U=/(\[\])$/.exec(x),x=x.replace(/\[\]$/,""),!U){b[x]=C;return}if(b[x]===void 0){b[x]=[C];return}b[x]=[].concat(b[x],C)};case"colon-list-separator":return(x,C,b)=>{if(U=/(:list)$/.exec(x),x=x.replace(/:list$/,""),!U){b[x]=C;return}if(b[x]===void 0){b[x]=[C];return}b[x]=[].concat(b[x],C)};case"comma":case"separator":return(x,C,b)=>{const h=typeof C=="string"&&C.includes(R.arrayFormatSeparator),m=typeof C=="string"&&!h&&A(C,R).includes(R.arrayFormatSeparator);C=m?A(C,R):C;const k=h||m?C.split(R.arrayFormatSeparator).map(G=>A(G,R)):C===null?C:A(C,R);b[x]=k};case"bracket-separator":return(x,C,b)=>{const h=/(\[\])$/.test(x);if(x=x.replace(/\[\]$/,""),!h){b[x]=C&&A(C,R);return}const m=C===null?[]:C.split(R.arrayFormatSeparator).map(k=>A(k,R));if(b[x]===void 0){b[x]=m;return}b[x]=[].concat(b[x],m)};default:return(x,C,b)=>{if(b[x]===void 0){b[x]=C;return}b[x]=[].concat(b[x],C)}}}function d(R){if(typeof R!="string"||R.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function w(R,U){return U.encode?U.strict?e(R):encodeURIComponent(R):R}function A(R,U){return U.decode?t(R):R}function S(R){return Array.isArray(R)?R.sort():typeof R=="object"?S(Object.keys(R)).sort((U,x)=>Number(U)-Number(x)).map(U=>R[U]):R}function P(R){const U=R.indexOf("#");return U!==-1&&(R=R.slice(0,U)),R}function M(R){let U="";const x=R.indexOf("#");return x!==-1&&(U=R.slice(x)),U}function B(R){R=P(R);const U=R.indexOf("?");return U===-1?"":R.slice(U+1)}function K(R,U){return U.parseNumbers&&!Number.isNaN(Number(R))&&typeof R=="string"&&R.trim()!==""?R=Number(R):U.parseBooleans&&R!==null&&(R.toLowerCase()==="true"||R.toLowerCase()==="false")&&(R=R.toLowerCase()==="true"),R}function oe(R,U){U=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},U),d(U.arrayFormatSeparator);const x=_(U),C=Object.create(null);if(typeof R!="string"||(R=R.trim().replace(/^[?#&]/,""),!R))return C;for(const b of R.split("&")){if(b==="")continue;let[h,m]=s(U.decode?b.replace(/\+/g," "):b,"=");m=m===void 0?null:["comma","separator","bracket-separator"].includes(U.arrayFormat)?m:A(m,U),x(A(h,U),m,C)}for(const b of Object.keys(C)){const h=C[b];if(typeof h=="object"&&h!==null)for(const m of Object.keys(h))h[m]=K(h[m],U);else C[b]=K(h,U)}return U.sort===!1?C:(U.sort===!0?Object.keys(C).sort():Object.keys(C).sort(U.sort)).reduce((b,h)=>{const m=C[h];return m&&typeof m=="object"&&!Array.isArray(m)?b[h]=S(m):b[h]=m,b},Object.create(null))}i.extract=B,i.parse=oe,i.stringify=(R,U)=>{if(!R)return"";U=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},U),d(U.arrayFormatSeparator);const x=m=>U.skipNull&&c(R[m])||U.skipEmptyString&&R[m]==="",C=p(U),b={};for(const m of Object.keys(R))x(m)||(b[m]=R[m]);const h=Object.keys(b);return U.sort!==!1&&h.sort(U.sort),h.map(m=>{const k=R[m];return k===void 0?"":k===null?w(m,U):Array.isArray(k)?k.length===0&&U.arrayFormat==="bracket-separator"?w(m,U)+"[]":k.reduce(C(m),[]).join("&"):w(m,U)+"="+w(k,U)}).filter(m=>m.length>0).join("&")},i.parseUrl=(R,U)=>{U=Object.assign({decode:!0},U);const[x,C]=s(R,"#");return Object.assign({url:x.split("?")[0]||"",query:oe(B(R),U)},U&&U.parseFragmentIdentifier&&C?{fragmentIdentifier:A(C,U)}:{})},i.stringifyUrl=(R,U)=>{U=Object.assign({encode:!0,strict:!0,[l]:!0},U);const x=P(R.url).split("?")[0]||"",C=i.extract(R.url),b=i.parse(C,{sort:!1}),h=Object.assign(b,R.query);let m=i.stringify(h,U);m&&(m=`?${m}`);let k=M(R.url);return R.fragmentIdentifier&&(k=`#${U[l]?w(R.fragmentIdentifier,U):R.fragmentIdentifier}`),`${x}${m}${k}`},i.pick=(R,U,x)=>{x=Object.assign({parseFragmentIdentifier:!0,[l]:!1},x);const{url:C,query:b,fragmentIdentifier:h}=i.parseUrl(R,x);return i.stringifyUrl({url:C,query:o(b,U),fragmentIdentifier:h},x)},i.exclude=(R,U,x)=>{const C=Array.isArray(U)?b=>!U.includes(b):(b,h)=>!U(b,h);return i.pick(R,C,x)}})(bs);const YE={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function JE(i,e=[]){const t=[];return Object.keys(i).forEach(s=>{if(e.length&&!e.includes(s))return;const o=i[s];t.push(...o.accounts)}),t}function Qp(i,e){return i.includes(":")?[i]:e.chains||[]}const ed="base10",ar="base16",fu="base64pad",$u="utf8",td=0,rn=1,XE=0,Pf=1,pu=12,Du=32;function ZE(){const i=Cu.generateKeyPair();return{privateKey:cr(i.secretKey,ar),publicKey:cr(i.publicKey,ar)}}function du(){const i=$n.randomBytes(Du);return cr(i,ar)}function QE(i,e){const t=Cu.sharedKey(_r(i,ar),_r(e,ar)),s=new NE(Zo.SHA256,t).expand(Du);return cr(s,ar)}function e6(i){const e=Zo.hash(_r(i,ar));return cr(e,ar)}function Tn(i){const e=Zo.hash(_r(i,$u));return cr(e,ar)}function t6(i){return _r(`${i}`,ed)}function Is(i){return Number(cr(i,ed))}function r6(i){const e=t6(typeof i.type<"u"?i.type:td);if(Is(e)===rn&&typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof i.senderPublicKey<"u"?_r(i.senderPublicKey,ar):void 0,s=typeof i.iv<"u"?_r(i.iv,ar):$n.randomBytes(pu),o=new Au.ChaCha20Poly1305(_r(i.symKey,ar)).seal(s,_r(i.message,$u));return n6({type:e,sealed:o,iv:s,senderPublicKey:t})}function i6(i){const e=new Au.ChaCha20Poly1305(_r(i.symKey,ar)),{sealed:t,iv:s}=qo(i.encoded),o=e.open(s,t);if(o===null)throw new Error("Failed to decrypt");return cr(o,$u)}function n6(i){if(Is(i.type)===rn){if(typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return cr(kc([i.type,i.senderPublicKey,i.iv,i.sealed]),fu)}return cr(kc([i.type,i.iv,i.sealed]),fu)}function qo(i){const e=_r(i,fu),t=e.slice(XE,Pf),s=Pf;if(Is(t)===rn){const p=s+Du,_=p+pu,d=e.slice(s,p),w=e.slice(p,_),A=e.slice(_);return{type:t,sealed:A,iv:w,senderPublicKey:d}}const o=s+pu,c=e.slice(s,o),l=e.slice(o);return{type:t,sealed:l,iv:c}}function s6(i,e){const t=qo(i);return rd({type:Is(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?cr(t.senderPublicKey,ar):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function rd(i){const e=(i==null?void 0:i.type)||td;if(e===rn){if(typeof(i==null?void 0:i.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(i==null?void 0:i.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:i==null?void 0:i.senderPublicKey,receiverPublicKey:i==null?void 0:i.receiverPublicKey}}function Af(i){return i.type===rn&&typeof i.senderPublicKey=="string"&&typeof i.receiverPublicKey=="string"}var o6=Object.defineProperty,Tf=Object.getOwnPropertySymbols,a6=Object.prototype.hasOwnProperty,c6=Object.prototype.propertyIsEnumerable,Cf=(i,e,t)=>e in i?o6(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Nf=(i,e)=>{for(var t in e||(e={}))a6.call(e,t)&&Cf(i,t,e[t]);if(Tf)for(var t of Tf(e))c6.call(e,t)&&Cf(i,t,e[t]);return i};const u6="ReactNative",Ci={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},h6="js";function ju(){return typeof An<"u"&&typeof An.versions<"u"&&typeof An.versions.node<"u"}function id(){return!Yp()&&!!Nu()&&navigator.product===u6}function Fu(){return!ju()&&!!Nu()}function Uu(){return id()?Ci.reactNative:ju()?Ci.node:Fu()?Ci.browser:Ci.unknown}function l6(i,e){let t=bs.parse(i);return t=Nf(Nf({},t),e),i=bs.stringify(t),i}function f6(){return Xp()||{name:"",description:"",url:"",icons:[""]}}function p6(){if(Uu()===Ci.reactNative&&typeof Fr<"u"&&typeof(Fr==null?void 0:Fr.Platform)<"u"){const{OS:t,Version:s}=Fr.Platform;return[t,s].join("-")}const i=ym();if(i===null)return"unknown";const e=i.os?i.os.replace(" ","").toLowerCase():"unknown";return i.type==="browser"?[e,i.name,i.version].join("-"):[e,i.version].join("-")}function d6(){var i;const e=Uu();return e===Ci.browser?[e,((i=Jp())==null?void 0:i.host)||"unknown"].join(":"):e}function g6(i,e,t){const s=p6(),o=d6();return[[i,e].join("-"),[h6,t].join("-"),s,o].join("/")}function _6({protocol:i,version:e,relayUrl:t,sdkVersion:s,auth:o,projectId:c,useOnCloseEvent:l}){const p=t.split("?"),_=g6(i,e,s),d={auth:o,ua:_,projectId:c,useOnCloseEvent:l||void 0},w=l6(p[1]||"",d);return p[0]+"?"+w}function Qi(i,e){return i.filter(t=>e.includes(t)).length===i.length}function nd(i){return Object.fromEntries(i.entries())}function sd(i){return new Map(Object.entries(i))}function Pn(i=ye.FIVE_MINUTES,e){const t=ye.toMiliseconds(i||ye.FIVE_MINUTES);let s,o,c;return{resolve:l=>{c&&s&&(clearTimeout(c),s(l))},reject:l=>{c&&o&&(clearTimeout(c),o(l))},done:()=>new Promise((l,p)=>{c=setTimeout(()=>{p(new Error(e))},t),s=l,o=p})}}function zo(i,e,t){return new Promise(async(s,o)=>{const c=setTimeout(()=>o(new Error(t)),e);try{const l=await i;s(l)}catch(l){o(l)}clearTimeout(c)})}function od(i,e){if(typeof e=="string"&&e.startsWith(`${i}:`))return e;if(i.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(i.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${i}`)}function y6(i){return od("topic",i)}function v6(i){return od("id",i)}function ad(i){const[e,t]=i.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")s.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))s.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return s}function Vr(i,e){return ye.fromMiliseconds((e||Date.now())+ye.toMiliseconds(i))}function Ti(i){return Date.now()>=ye.toMiliseconds(i)}function Ht(i,e){return`${i}${e?`:${e}`:""}`}function Uc(i=[],e=[]){return[...new Set([...i,...e])]}async function m6({id:i,topic:e,wcDeepLink:t}){try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const c=`${o}/wc?requestId=${i}&sessionTopic=${e}`,l=Uu();l===Ci.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):l===Ci.reactNative&&typeof(Fr==null?void 0:Fr.Linking)<"u"&&await Fr.Linking.openURL(c)}catch(s){console.error(s)}}const b6="irn";function gu(i){return(i==null?void 0:i.relay)||{protocol:b6}}function Do(i){const e=YE[i];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${i}`);return e}var w6=Object.defineProperty,Rf=Object.getOwnPropertySymbols,E6=Object.prototype.hasOwnProperty,S6=Object.prototype.propertyIsEnumerable,$f=(i,e,t)=>e in i?w6(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,I6=(i,e)=>{for(var t in e||(e={}))E6.call(e,t)&&$f(i,t,e[t]);if(Rf)for(var t of Rf(e))S6.call(e,t)&&$f(i,t,e[t]);return i};function x6(i,e="-"){const t={},s="relay"+e;return Object.keys(i).forEach(o=>{if(o.startsWith(s)){const c=o.replace(s,""),l=i[o];t[c]=l}}),t}function O6(i){const e=i.indexOf(":"),t=i.indexOf("?")!==-1?i.indexOf("?"):void 0,s=i.substring(0,e),o=i.substring(e+1,t).split("@"),c=typeof t<"u"?i.substring(t):"",l=bs.parse(c);return{protocol:s,topic:P6(o[0]),version:parseInt(o[1],10),symKey:l.symKey,relay:x6(l)}}function P6(i){return i.startsWith("//")?i.substring(2):i}function A6(i,e="-"){const t="relay",s={};return Object.keys(i).forEach(o=>{const c=t+e+o;i[o]&&(s[c]=i[o])}),s}function T6(i){return`${i.protocol}:${i.topic}@${i.version}?`+bs.stringify(I6({symKey:i.symKey},A6(i.relay)))}function jn(i){const e=[];return i.forEach(t=>{const[s,o]=t.split(":");e.push(`${s}:${o}`)}),e}function C6(i){const e=[];return Object.values(i).forEach(t=>{e.push(...jn(t.accounts))}),e}function N6(i,e){const t=[];return Object.values(i).forEach(s=>{jn(s.accounts).includes(e)&&t.push(...s.methods)}),t}function R6(i,e){const t=[];return Object.values(i).forEach(s=>{jn(s.accounts).includes(e)&&t.push(...s.events)}),t}function $6(i,e){const t=Fo(i,e);if(t)throw new Error(t.message);const s={};for(const[o,c]of Object.entries(i))s[o]={methods:c.methods,events:c.events,chains:c.accounts.map(l=>`${l.split(":")[0]}:${l.split(":")[1]}`)};return s}function Lu(i){return i.includes(":")}function jo(i){return Lu(i)?i.split(":")[0]:i}const D6={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},j6={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ue(i,e){const{message:t,code:s}=j6[i];return{message:e?`${t} ${e}`:t,code:s}}function $t(i,e){const{message:t,code:s}=D6[i];return{message:e?`${t} ${e}`:t,code:s}}function ri(i,e){return Array.isArray(i)?typeof e<"u"&&i.length?i.every(e):!0:!1}function Cn(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}function or(i){return typeof i>"u"}function kt(i,e){return e&&or(i)?!0:typeof i=="string"&&!!i.trim().length}function Mu(i,e){return e&&or(i)?!0:typeof i=="number"&&!isNaN(i)}function F6(i,e){const{requiredNamespaces:t}=e,s=Object.keys(i.namespaces),o=Object.keys(t);let c=!0;return Qi(o,s)?(s.forEach(l=>{const{accounts:p,methods:_,events:d}=i.namespaces[l],w=jn(p),A=t[l];(!Qi(Qp(l,A),w)||!Qi(A.methods,_)||!Qi(A.events,d))&&(c=!1)}),c):!1}function Ho(i){return kt(i,!1)&&i.includes(":")?i.split(":").length===2:!1}function U6(i){if(kt(i,!1)&&i.includes(":")){const e=i.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&Ho(t)}}return!1}function L6(i){if(kt(i,!1))try{return typeof new URL(i)<"u"}catch{return!1}return!1}function M6(i){var e;return(e=i==null?void 0:i.proposer)==null?void 0:e.publicKey}function q6(i){return i==null?void 0:i.topic}function z6(i,e){let t=null;return kt(i==null?void 0:i.publicKey,!1)||(t=ue("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function Df(i){let e=!0;return ri(i)?i.length&&(e=i.every(t=>kt(t,!1))):e=!1,e}function H6(i,e,t){let s=null;return ri(e)&&e.length?e.forEach(o=>{s||Ho(o)||(s=$t("UNSUPPORTED_CHAINS",`${t}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):Ho(i)||(s=$t("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function B6(i,e,t){let s=null;return Object.entries(i).forEach(([o,c])=>{if(s)return;const l=H6(o,Qp(o,c),`${e} ${t}`);l&&(s=l)}),s}function K6(i,e){let t=null;return ri(i)?i.forEach(s=>{t||U6(s)||(t=$t("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):t=$t("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function V6(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=K6(s==null?void 0:s.accounts,`${e} namespace`);o&&(t=o)}),t}function G6(i,e){let t=null;return Df(i==null?void 0:i.methods)?Df(i==null?void 0:i.events)||(t=$t("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=$t("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function cd(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=G6(s,`${e}, namespace`);o&&(t=o)}),t}function k6(i,e,t){let s=null;if(i&&Cn(i)){const o=cd(i,e);o&&(s=o);const c=B6(i,e,t);c&&(s=c)}else s=ue("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return s}function Fo(i,e){let t=null;if(i&&Cn(i)){const s=cd(i,e);s&&(t=s);const o=V6(i,e);o&&(t=o)}else t=ue("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function ud(i){return kt(i.protocol,!0)}function W6(i,e){let t=!1;return e&&!i?t=!0:i&&ri(i)&&i.length&&i.forEach(s=>{t=ud(s)}),t}function Y6(i){return typeof i=="number"}function gr(i){return typeof i<"u"&&typeof i!==null}function J6(i){return!(!i||typeof i!="object"||!i.code||!Mu(i.code,!1)||!i.message||!kt(i.message,!1))}function X6(i){return!(or(i)||!kt(i.method,!1))}function Z6(i){return!(or(i)||or(i.result)&&or(i.error)||!Mu(i.id,!1)||!kt(i.jsonrpc,!1))}function Q6(i){return!(or(i)||!kt(i.name,!1))}function jf(i,e){return!(!Ho(e)||!C6(i).includes(e))}function e2(i,e,t){return kt(t,!1)?N6(i,e).includes(t):!1}function t2(i,e,t){return kt(t,!1)?R6(i,e).includes(t):!1}function Ff(i,e,t){let s=null;const o=r2(i),c=i2(e),l=Object.keys(o),p=Object.keys(c),_=Uf(Object.keys(i)),d=Uf(Object.keys(e)),w=_.filter(A=>!d.includes(A));return w.length&&(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${w.toString()}
      Received: ${Object.keys(e).toString()}`)),Qi(l,p)||(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${l.toString()}
      Approved: ${p.toString()}`)),Object.keys(e).forEach(A=>{if(!A.includes(":")||s)return;const S=jn(e[A].accounts);S.includes(A)||(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${A}
        Required: ${A}
        Approved: ${S.toString()}`))}),l.forEach(A=>{s||(Qi(o[A].methods,c[A].methods)?Qi(o[A].events,c[A].events)||(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${A}`)):s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${A}`))}),s}function r2(i){const e={};return Object.keys(i).forEach(t=>{var s;t.includes(":")?e[t]=i[t]:(s=i[t].chains)==null||s.forEach(o=>{e[o]={methods:i[t].methods,events:i[t].events}})}),e}function Uf(i){return[...new Set(i.map(e=>e.includes(":")?e.split(":")[0]:e))]}function i2(i){const e={};return Object.keys(i).forEach(t=>{if(t.includes(":"))e[t]=i[t];else{const s=jn(i[t].accounts);s==null||s.forEach(o=>{e[o]={accounts:i[t].accounts.filter(c=>c.includes(`${o}:`)),methods:i[t].methods,events:i[t].events}})}}),e}function n2(i,e){return Mu(i,!1)&&i<=e.max&&i>=e.min}const s2="PARSE_ERROR",o2="INVALID_REQUEST",a2="METHOD_NOT_FOUND",c2="INVALID_PARAMS",hd="INTERNAL_ERROR",qu="SERVER_ERROR",u2=[-32700,-32600,-32601,-32602,-32603],ds={[s2]:{code:-32700,message:"Parse error"},[o2]:{code:-32600,message:"Invalid Request"},[a2]:{code:-32601,message:"Method not found"},[c2]:{code:-32602,message:"Invalid params"},[hd]:{code:-32603,message:"Internal error"},[qu]:{code:-32e3,message:"Server error"}},ld=qu;function h2(i){return u2.includes(i)}function Lf(i){return Object.keys(ds).includes(i)?ds[i]:ds[ld]}function l2(i){const e=Object.values(ds).find(t=>t.code===i);return e||ds[ld]}function fd(i,e,t){return i.message.includes("getaddrinfo ENOTFOUND")||i.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):i}var pd={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var _u=function(i,e){return _u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},_u(i,e)};function f2(i,e){_u(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var yu=function(){return yu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},yu.apply(this,arguments)};function p2(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function d2(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var p=i.length-1;p>=0;p--)(l=i[p])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function g2(i,e){return function(t,s){e(t,s,i)}}function _2(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function y2(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function p(w){try{d(s.next(w))}catch(A){l(A)}}function _(w){try{d(s.throw(w))}catch(A){l(A)}}function d(w){w.done?c(w.value):o(w.value).then(p,_)}d((s=s.apply(i,e||[])).next())})}function v2(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function p(d){return function(w){return _([d,w])}}function _(d){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=d[0]&2?o.return:d[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,d[1])).done)return c;switch(o=0,c&&(d=[d[0]&2,c.value]),d[0]){case 0:case 1:c=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,o=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!c||d[1]>c[0]&&d[1]<c[3])){t.label=d[1];break}if(d[0]===6&&t.label<c[1]){t.label=c[1],c=d;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(d);break}c[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(i,t)}catch(w){d=[6,w],o=0}finally{s=c=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function m2(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function b2(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function vu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function dd(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(p){l={error:p}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function w2(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(dd(arguments[e]));return i}function E2(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,p=c.length;l<p;l++,o++)s[o]=c[l];return s}function ws(i){return this instanceof ws?(this.v=i,this):new ws(i)}function S2(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(S){s[S]&&(o[S]=function(P){return new Promise(function(M,B){c.push([S,P,M,B])>1||p(S,P)})})}function p(S,P){try{_(s[S](P))}catch(M){A(c[0][3],M)}}function _(S){S.value instanceof ws?Promise.resolve(S.value.v).then(d,w):A(c[0][2],S)}function d(S){p("next",S)}function w(S){p("throw",S)}function A(S,P){S(P),c.shift(),c.length&&p(c[0][0],c[0][1])}}function I2(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:ws(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function x2(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof vu=="function"?vu(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(p,_){l=i[c](l),o(p,_,l.done,l.value)})}}function o(c,l,p,_){Promise.resolve(_).then(function(d){c({value:d,done:p})},l)}}function O2(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function P2(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function A2(i){return i&&i.__esModule?i:{default:i}}function T2(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function C2(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const N2=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return yu},__asyncDelegator:I2,__asyncGenerator:S2,__asyncValues:x2,__await:ws,__awaiter:y2,__classPrivateFieldGet:T2,__classPrivateFieldSet:C2,__createBinding:m2,__decorate:d2,__exportStar:b2,__extends:f2,__generator:v2,__importDefault:A2,__importStar:P2,__makeTemplateObject:O2,__metadata:_2,__param:g2,__read:dd,__rest:p2,__spread:w2,__spreadArrays:E2,__values:vu},Symbol.toStringTag,{value:"Module"})),R2=Nn(N2);var gi={},Mf;function $2(){if(Mf)return gi;Mf=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.isBrowserCryptoAvailable=gi.getSubtleCrypto=gi.getBrowerCrypto=void 0;function i(){return(Sr===null||Sr===void 0?void 0:Sr.crypto)||(Sr===null||Sr===void 0?void 0:Sr.msCrypto)||{}}gi.getBrowerCrypto=i;function e(){const s=i();return s.subtle||s.webkitSubtle}gi.getSubtleCrypto=e;function t(){return!!i()&&!!e()}return gi.isBrowserCryptoAvailable=t,gi}var _i={},qf;function D2(){if(qf)return _i;qf=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.isBrowser=_i.isNode=_i.isReactNative=void 0;function i(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}_i.isReactNative=i;function e(){return typeof An<"u"&&typeof An.versions<"u"&&typeof An.versions.node<"u"}_i.isNode=e;function t(){return!i()&&!e()}return _i.isBrowser=t,_i}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=R2;e.__exportStar($2(),i),e.__exportStar(D2(),i)})(pd);function gd(i=3){const e=Date.now()*Math.pow(10,i),t=Math.floor(Math.random()*Math.pow(10,i));return e+t}function zu(i=6){return BigInt(gd(i))}function Qo(i,e,t){return{id:t||gd(),jsonrpc:"2.0",method:i,params:e}}function Hu(i,e){return{id:i,jsonrpc:"2.0",result:e}}function ea(i,e,t){return{id:i,jsonrpc:"2.0",error:j2(e,t)}}function j2(i,e){return typeof i>"u"?Lf(hd):(typeof i=="string"&&(i=Object.assign(Object.assign({},Lf(qu)),{message:i})),typeof e<"u"&&(i.data=e),h2(i.code)&&(i=l2(i.code)),i)}class F2{}class U2 extends F2{constructor(){super()}}class L2 extends U2{constructor(e){super()}}const M2="^https?:",q2="^wss?:";function z2(i){const e=i.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function _d(i,e){const t=z2(i);return typeof t>"u"?!1:new RegExp(e).test(t)}function zf(i){return _d(i,M2)}function Hf(i){return _d(i,q2)}function H2(i){return new RegExp("wss?://localhost(:d{2,5})?").test(i)}function yd(i){return typeof i=="object"&&"id"in i&&"jsonrpc"in i&&i.jsonrpc==="2.0"}function Bu(i){return yd(i)&&"method"in i}function ta(i){return yd(i)&&(yi(i)||Gr(i))}function yi(i){return"result"in i}function Gr(i){return"error"in i}class $i extends L2{constructor(e){super(e),this.events=new Lr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Qo(e.method,e.params||[],e.id||zu().toString()),t)}async requestStrict(e,t){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${e.id}`,c=>{Gr(c)?o(c.error):s(c.result)});try{await this.connection.send(e,t)}catch(c){o(c)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ta(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const B2=()=>typeof Fr<"u"&&typeof Fr.WebSocket<"u"?Fr.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),K2=()=>typeof window<"u",Bf=i=>i.split("?")[0],Kf=10,V2=B2();class G2{constructor(e){if(this.url=e,this.events=new Lr.EventEmitter,this.registering=!1,!Hf(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e,t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ms(e))}catch(s){this.onError(e.id,s)}}register(e=this.url){if(!Hf(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,s)=>{const o=pd.isReactNative()?void 0:{rejectUnauthorized:!H2(e)},c=new V2(e,[],o);K2()?c.onerror=l=>{const p=l;s(this.emitError(p.error))}:c.on("error",l=>{s(this.emitError(l))}),c.onopen=()=>{this.onOpen(c),t(c)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Ou(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=ea(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return fd(e,Bf(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Kf&&this.events.setMaxListeners(Kf)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${Bf(this.url)}`));return this.events.emit("register_error",t),t}}var Bo={exports:{}};Bo.exports;(function(i,e){var t=200,s="__lodash_hash_undefined__",o=1,c=2,l=9007199254740991,p="[object Arguments]",_="[object Array]",d="[object AsyncFunction]",w="[object Boolean]",A="[object Date]",S="[object Error]",P="[object Function]",M="[object GeneratorFunction]",B="[object Map]",K="[object Number]",oe="[object Null]",R="[object Object]",U="[object Promise]",x="[object Proxy]",C="[object RegExp]",b="[object Set]",h="[object String]",m="[object Symbol]",k="[object Undefined]",G="[object WeakMap]",se="[object ArrayBuffer]",ce="[object DataView]",ge="[object Float32Array]",$="[object Float64Array]",z="[object Int8Array]",le="[object Int16Array]",te="[object Int32Array]",W="[object Uint8Array]",ee="[object Uint8ClampedArray]",Y="[object Uint16Array]",re="[object Uint32Array]",Oe=/[\\^$.*+?()[\]{}|]/g,ie=/^\[object .+?Constructor\]$/,be=/^(?:0|[1-9]\d*)$/,he={};he[ge]=he[$]=he[z]=he[le]=he[te]=he[W]=he[ee]=he[Y]=he[re]=!0,he[p]=he[_]=he[se]=he[w]=he[ce]=he[A]=he[S]=he[P]=he[B]=he[K]=he[R]=he[C]=he[b]=he[h]=he[G]=!1;var ve=typeof Sr=="object"&&Sr&&Sr.Object===Object&&Sr,q=typeof self=="object"&&self&&self.Object===Object&&self,L=ve||q||Function("return this")(),N=e&&!e.nodeType&&e,f=N&&!0&&i&&!i.nodeType&&i,O=f&&f.exports===N,ne=O&&ve.process,fe=function(){try{return ne&&ne.binding&&ne.binding("util")}catch{}}(),Ie=fe&&fe.isTypedArray;function He(E,D){for(var Z=-1,pe=E==null?0:E.length,at=0,Ne=[];++Z<pe;){var ft=E[Z];D(ft,Z,E)&&(Ne[at++]=ft)}return Ne}function Ve(E,D){for(var Z=-1,pe=D.length,at=E.length;++Z<pe;)E[at+Z]=D[Z];return E}function Ue(E,D){for(var Z=-1,pe=E==null?0:E.length;++Z<pe;)if(D(E[Z],Z,E))return!0;return!1}function dt(E,D){for(var Z=-1,pe=Array(E);++Z<E;)pe[Z]=D(Z);return pe}function gt(E){return function(D){return E(D)}}function Me(E,D){return E.has(D)}function xe(E,D){return E==null?void 0:E[D]}function $e(E){var D=-1,Z=Array(E.size);return E.forEach(function(pe,at){Z[++D]=[at,pe]}),Z}function De(E,D){return function(Z){return E(D(Z))}}function qe(E){var D=-1,Z=Array(E.size);return E.forEach(function(pe){Z[++D]=pe}),Z}var Ae=Array.prototype,je=Function.prototype,Se=Object.prototype,Te=L["__core-js_shared__"],Be=je.toString,Pe=Se.hasOwnProperty,Ge=function(){var E=/[^.]+$/.exec(Te&&Te.keys&&Te.keys.IE_PROTO||"");return E?"Symbol(src)_1."+E:""}(),We=Se.toString,et=RegExp("^"+Be.call(Pe).replace(Oe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=O?L.Buffer:void 0,Je=L.Symbol,Qt=L.Uint8Array,ur=Se.propertyIsEnumerable,kr=Ae.splice,er=Je?Je.toStringTag:void 0,ii=Object.getOwnPropertySymbols,vi=tt?tt.isBuffer:void 0,ji=De(Object.keys,Object),wt=yr(L,"DataView"),_t=yr(L,"Map"),Et=yr(L,"Promise"),St=yr(L,"Set"),mt=yr(L,"WeakMap"),yt=yr(Object,"create"),jt=si(wt),Ft=si(_t),It=si(Et),Ut=si(St),xt=si(mt),Tt=Je?Je.prototype:void 0,Ot=Tt?Tt.valueOf:void 0;function ht(E){var D=-1,Z=E==null?0:E.length;for(this.clear();++D<Z;){var pe=E[D];this.set(pe[0],pe[1])}}function Lt(){this.__data__=yt?yt(null):{},this.size=0}function Mt(E){var D=this.has(E)&&delete this.__data__[E];return this.size-=D?1:0,D}function na(E){var D=this.__data__;if(yt){var Z=D[E];return Z===s?void 0:Z}return Pe.call(D,E)?D[E]:void 0}function sa(E){var D=this.__data__;return yt?D[E]!==void 0:Pe.call(D,E)}function oa(E,D){var Z=this.__data__;return this.size+=this.has(E)?0:1,Z[E]=yt&&D===void 0?s:D,this}ht.prototype.clear=Lt,ht.prototype.delete=Mt,ht.prototype.get=na,ht.prototype.has=sa,ht.prototype.set=oa;function xr(E){var D=-1,Z=E==null?0:E.length;for(this.clear();++D<Z;){var pe=E[D];this.set(pe[0],pe[1])}}function aa(){this.__data__=[],this.size=0}function ca(E){var D=this.__data__,Z=Fi(D,E);if(Z<0)return!1;var pe=D.length-1;return Z==pe?D.pop():kr.call(D,Z,1),--this.size,!0}function ua(E){var D=this.__data__,Z=Fi(D,E);return Z<0?void 0:D[Z][1]}function ha(E){return Fi(this.__data__,E)>-1}function la(E,D){var Z=this.__data__,pe=Fi(Z,E);return pe<0?(++this.size,Z.push([E,D])):Z[pe][1]=D,this}xr.prototype.clear=aa,xr.prototype.delete=ca,xr.prototype.get=ua,xr.prototype.has=ha,xr.prototype.set=la;function ni(E){var D=-1,Z=E==null?0:E.length;for(this.clear();++D<Z;){var pe=E[D];this.set(pe[0],pe[1])}}function sn(){this.size=0,this.__data__={hash:new ht,map:new(_t||xr),string:new ht}}function fa(E){var D=mi(this,E).delete(E);return this.size-=D?1:0,D}function on(E){return mi(this,E).get(E)}function pa(E){return mi(this,E).has(E)}function da(E,D){var Z=mi(this,E),pe=Z.size;return Z.set(E,D),this.size+=Z.size==pe?0:1,this}ni.prototype.clear=sn,ni.prototype.delete=fa,ni.prototype.get=on,ni.prototype.has=pa,ni.prototype.set=da;function an(E){var D=-1,Z=E==null?0:E.length;for(this.__data__=new ni;++D<Z;)this.add(E[D])}function Os(E){return this.__data__.set(E,s),this}function Ps(E){return this.__data__.has(E)}an.prototype.add=an.prototype.push=Os,an.prototype.has=Ps;function Mr(E){var D=this.__data__=new xr(E);this.size=D.size}function ga(){this.__data__=new xr,this.size=0}function _a(E){var D=this.__data__,Z=D.delete(E);return this.size=D.size,Z}function ya(E){return this.__data__.get(E)}function va(E){return this.__data__.has(E)}function As(E,D){var Z=this.__data__;if(Z instanceof xr){var pe=Z.__data__;if(!_t||pe.length<t-1)return pe.push([E,D]),this.size=++Z.size,this;Z=this.__data__=new ni(pe)}return Z.set(E,D),this.size=Z.size,this}Mr.prototype.clear=ga,Mr.prototype.delete=_a,Mr.prototype.get=ya,Mr.prototype.has=va,Mr.prototype.set=As;function Ts(E,D){var Z=hn(E),pe=!Z&&zs(E),at=!Z&&!pe&&Ln(E),Ne=!Z&&!pe&&!at&&Ks(E),ft=Z||pe||at||Ne,qt=ft?dt(E.length,String):[],Xe=qt.length;for(var ct in E)(D||Pe.call(E,ct))&&!(ft&&(ct=="length"||at&&(ct=="offset"||ct=="parent")||Ne&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||Fs(ct,Xe)))&&qt.push(ct);return qt}function Fi(E,D){for(var Z=E.length;Z--;)if(qs(E[Z][0],D))return Z;return-1}function Fn(E,D,Z){var pe=D(E);return hn(E)?pe:Ve(pe,Z(E))}function Ui(E){return E==null?E===void 0?k:oe:er&&er in Object(E)?Ds(E):wa(E)}function Un(E){return Mi(E)&&Ui(E)==p}function Li(E,D,Z,pe,at){return E===D?!0:E==null||D==null||!Mi(E)&&!Mi(D)?E!==E&&D!==D:Cs(E,D,Z,pe,Li,at)}function Cs(E,D,Z,pe,at,Ne){var ft=hn(E),qt=hn(D),Xe=ft?_:Wr(E),ct=qt?_:Wr(D);Xe=Xe==p?R:Xe,ct=ct==p?R:ct;var Ct=Xe==R,hr=ct==R,zt=Xe==ct;if(zt&&Ln(E)){if(!Ln(D))return!1;ft=!0,Ct=!1}if(zt&&!Ct)return Ne||(Ne=new Mr),ft||Ks(E)?cn(E,D,Z,pe,at,Ne):ba(E,D,Xe,Z,pe,at,Ne);if(!(Z&o)){var pt=Ct&&Pe.call(E,"__wrapped__"),tr=hr&&Pe.call(D,"__wrapped__");if(pt||tr){var qr=pt?E.value():E,Or=tr?D.value():D;return Ne||(Ne=new Mr),at(qr,Or,Z,pe,Ne)}}return zt?(Ne||(Ne=new Mr),$s(E,D,Z,pe,at,Ne)):!1}function ma(E){if(!Bs(E)||Ls(E))return!1;var D=ln(E)?et:ie;return D.test(si(E))}function Ns(E){return Mi(E)&&Hs(E.length)&&!!he[Ui(E)]}function Rs(E){if(!Ms(E))return ji(E);var D=[];for(var Z in Object(E))Pe.call(E,Z)&&Z!="constructor"&&D.push(Z);return D}function cn(E,D,Z,pe,at,Ne){var ft=Z&o,qt=E.length,Xe=D.length;if(qt!=Xe&&!(ft&&Xe>qt))return!1;var ct=Ne.get(E);if(ct&&Ne.get(D))return ct==D;var Ct=-1,hr=!0,zt=Z&c?new an:void 0;for(Ne.set(E,D),Ne.set(D,E);++Ct<qt;){var pt=E[Ct],tr=D[Ct];if(pe)var qr=ft?pe(tr,pt,Ct,D,E,Ne):pe(pt,tr,Ct,E,D,Ne);if(qr!==void 0){if(qr)continue;hr=!1;break}if(zt){if(!Ue(D,function(Or,Yr){if(!Me(zt,Yr)&&(pt===Or||at(pt,Or,Z,pe,Ne)))return zt.push(Yr)})){hr=!1;break}}else if(!(pt===tr||at(pt,tr,Z,pe,Ne))){hr=!1;break}}return Ne.delete(E),Ne.delete(D),hr}function ba(E,D,Z,pe,at,Ne,ft){switch(Z){case ce:if(E.byteLength!=D.byteLength||E.byteOffset!=D.byteOffset)return!1;E=E.buffer,D=D.buffer;case se:return!(E.byteLength!=D.byteLength||!Ne(new Qt(E),new Qt(D)));case w:case A:case K:return qs(+E,+D);case S:return E.name==D.name&&E.message==D.message;case C:case h:return E==D+"";case B:var qt=$e;case b:var Xe=pe&o;if(qt||(qt=qe),E.size!=D.size&&!Xe)return!1;var ct=ft.get(E);if(ct)return ct==D;pe|=c,ft.set(E,D);var Ct=cn(qt(E),qt(D),pe,at,Ne,ft);return ft.delete(E),Ct;case m:if(Ot)return Ot.call(E)==Ot.call(D)}return!1}function $s(E,D,Z,pe,at,Ne){var ft=Z&o,qt=un(E),Xe=qt.length,ct=un(D),Ct=ct.length;if(Xe!=Ct&&!ft)return!1;for(var hr=Xe;hr--;){var zt=qt[hr];if(!(ft?zt in D:Pe.call(D,zt)))return!1}var pt=Ne.get(E);if(pt&&Ne.get(D))return pt==D;var tr=!0;Ne.set(E,D),Ne.set(D,E);for(var qr=ft;++hr<Xe;){zt=qt[hr];var Or=E[zt],Yr=D[zt];if(pe)var Mn=ft?pe(Yr,Or,zt,D,E,Ne):pe(Or,Yr,zt,E,D,Ne);if(!(Mn===void 0?Or===Yr||at(Or,Yr,Z,pe,Ne):Mn)){tr=!1;break}qr||(qr=zt=="constructor")}if(tr&&!qr){var qi=E.constructor,Vt=D.constructor;qi!=Vt&&"constructor"in E&&"constructor"in D&&!(typeof qi=="function"&&qi instanceof qi&&typeof Vt=="function"&&Vt instanceof Vt)&&(tr=!1)}return Ne.delete(E),Ne.delete(D),tr}function un(E){return Fn(E,Ia,js)}function mi(E,D){var Z=E.__data__;return Us(D)?Z[typeof D=="string"?"string":"hash"]:Z.map}function yr(E,D){var Z=xe(E,D);return ma(Z)?Z:void 0}function Ds(E){var D=Pe.call(E,er),Z=E[er];try{E[er]=void 0;var pe=!0}catch{}var at=We.call(E);return pe&&(D?E[er]=Z:delete E[er]),at}var js=ii?function(E){return E==null?[]:(E=Object(E),He(ii(E),function(D){return ur.call(E,D)}))}:ot,Wr=Ui;(wt&&Wr(new wt(new ArrayBuffer(1)))!=ce||_t&&Wr(new _t)!=B||Et&&Wr(Et.resolve())!=U||St&&Wr(new St)!=b||mt&&Wr(new mt)!=G)&&(Wr=function(E){var D=Ui(E),Z=D==R?E.constructor:void 0,pe=Z?si(Z):"";if(pe)switch(pe){case jt:return ce;case Ft:return B;case It:return U;case Ut:return b;case xt:return G}return D});function Fs(E,D){return D=D??l,!!D&&(typeof E=="number"||be.test(E))&&E>-1&&E%1==0&&E<D}function Us(E){var D=typeof E;return D=="string"||D=="number"||D=="symbol"||D=="boolean"?E!=="__proto__":E===null}function Ls(E){return!!Ge&&Ge in E}function Ms(E){var D=E&&E.constructor,Z=typeof D=="function"&&D.prototype||Se;return E===Z}function wa(E){return We.call(E)}function si(E){if(E!=null){try{return Be.call(E)}catch{}try{return E+""}catch{}}return""}function qs(E,D){return E===D||E!==E&&D!==D}var zs=Un(function(){return arguments}())?Un:function(E){return Mi(E)&&Pe.call(E,"callee")&&!ur.call(E,"callee")},hn=Array.isArray;function Ea(E){return E!=null&&Hs(E.length)&&!ln(E)}var Ln=vi||st;function Sa(E,D){return Li(E,D)}function ln(E){if(!Bs(E))return!1;var D=Ui(E);return D==P||D==M||D==d||D==x}function Hs(E){return typeof E=="number"&&E>-1&&E%1==0&&E<=l}function Bs(E){var D=typeof E;return E!=null&&(D=="object"||D=="function")}function Mi(E){return E!=null&&typeof E=="object"}var Ks=Ie?gt(Ie):Ns;function Ia(E){return Ea(E)?Ts(E):Rs(E)}function ot(){return[]}function st(){return!1}i.exports=Sa})(Bo,Bo.exports);var k2=Bo.exports;const W2=vm(k2);function Y2(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<i.length;o++){var c=i.charAt(o),l=c.charCodeAt(0);if(t[l]!==255)throw new TypeError(c+" is ambiguous");t[l]=o}var p=i.length,_=i.charAt(0),d=Math.log(p)/Math.log(256),w=Math.log(256)/Math.log(p);function A(M){if(M instanceof Uint8Array||(ArrayBuffer.isView(M)?M=new Uint8Array(M.buffer,M.byteOffset,M.byteLength):Array.isArray(M)&&(M=Uint8Array.from(M))),!(M instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(M.length===0)return"";for(var B=0,K=0,oe=0,R=M.length;oe!==R&&M[oe]===0;)oe++,B++;for(var U=(R-oe)*w+1>>>0,x=new Uint8Array(U);oe!==R;){for(var C=M[oe],b=0,h=U-1;(C!==0||b<K)&&h!==-1;h--,b++)C+=256*x[h]>>>0,x[h]=C%p>>>0,C=C/p>>>0;if(C!==0)throw new Error("Non-zero carry");K=b,oe++}for(var m=U-K;m!==U&&x[m]===0;)m++;for(var k=_.repeat(B);m<U;++m)k+=i.charAt(x[m]);return k}function S(M){if(typeof M!="string")throw new TypeError("Expected String");if(M.length===0)return new Uint8Array;var B=0;if(M[B]!==" "){for(var K=0,oe=0;M[B]===_;)K++,B++;for(var R=(M.length-B)*d+1>>>0,U=new Uint8Array(R);M[B];){var x=t[M.charCodeAt(B)];if(x===255)return;for(var C=0,b=R-1;(x!==0||C<oe)&&b!==-1;b--,C++)x+=p*U[b]>>>0,U[b]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");oe=C,B++}if(M[B]!==" "){for(var h=R-oe;h!==R&&U[h]===0;)h++;for(var m=new Uint8Array(K+(R-h)),k=K;h!==R;)m[k++]=U[h++];return m}}}function P(M){var B=S(M);if(B)return B;throw new Error(`Non-${e} character`)}return{encode:A,decodeUnsafe:S,decode:P}}var J2=Y2,X2=J2;const vd=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},Z2=i=>new TextEncoder().encode(i),Q2=i=>new TextDecoder().decode(i);class eS{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class tS{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return md(this,e)}}class rS{constructor(e){this.decoders=e}or(e){return md(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const md=(i,e)=>new rS({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});class iS{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new eS(e,t,s),this.decoder=new tS(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ra=({name:i,prefix:e,encode:t,decode:s})=>new iS(i,e,t,s),xs=({prefix:i,name:e,alphabet:t})=>{const{encode:s,decode:o}=X2(t,e);return ra({prefix:i,name:e,encode:s,decode:c=>vd(o(c))})},nS=(i,e,t,s)=>{const o={};for(let w=0;w<e.length;++w)o[e[w]]=w;let c=i.length;for(;i[c-1]==="=";)--c;const l=new Uint8Array(c*t/8|0);let p=0,_=0,d=0;for(let w=0;w<c;++w){const A=o[i[w]];if(A===void 0)throw new SyntaxError(`Non-${s} character`);_=_<<t|A,p+=t,p>=8&&(p-=8,l[d++]=255&_>>p)}if(p>=t||255&_<<8-p)throw new SyntaxError("Unexpected end of data");return l},sS=(i,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",l=0,p=0;for(let _=0;_<i.length;++_)for(p=p<<8|i[_],l+=8;l>t;)l-=t,c+=e[o&p>>l];if(l&&(c+=e[o&p<<t-l]),s)for(;c.length*t&7;)c+="=";return c},Yt=({name:i,prefix:e,bitsPerChar:t,alphabet:s})=>ra({prefix:e,name:i,encode(o){return sS(o,s,t)},decode(o){return nS(o,s,t,i)}}),oS=ra({prefix:"\0",name:"identity",encode:i=>Q2(i),decode:i=>Z2(i)});var aS=Object.freeze({__proto__:null,identity:oS});const cS=Yt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var uS=Object.freeze({__proto__:null,base2:cS});const hS=Yt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var lS=Object.freeze({__proto__:null,base8:hS});const fS=xs({prefix:"9",name:"base10",alphabet:"0123456789"});var pS=Object.freeze({__proto__:null,base10:fS});const dS=Yt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),gS=Yt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var _S=Object.freeze({__proto__:null,base16:dS,base16upper:gS});const yS=Yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),vS=Yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),mS=Yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),bS=Yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),wS=Yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ES=Yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),SS=Yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),IS=Yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),xS=Yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var OS=Object.freeze({__proto__:null,base32:yS,base32upper:vS,base32pad:mS,base32padupper:bS,base32hex:wS,base32hexupper:ES,base32hexpad:SS,base32hexpadupper:IS,base32z:xS});const PS=xs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),AS=xs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var TS=Object.freeze({__proto__:null,base36:PS,base36upper:AS});const CS=xs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),NS=xs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var RS=Object.freeze({__proto__:null,base58btc:CS,base58flickr:NS});const $S=Yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),DS=Yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),jS=Yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),FS=Yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var US=Object.freeze({__proto__:null,base64:$S,base64pad:DS,base64url:jS,base64urlpad:FS});const bd=Array.from(""),LS=bd.reduce((i,e,t)=>(i[t]=e,i),[]),MS=bd.reduce((i,e,t)=>(i[e.codePointAt(0)]=t,i),[]);function qS(i){return i.reduce((e,t)=>(e+=LS[t],e),"")}function zS(i){const e=[];for(const t of i){const s=MS[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const HS=ra({prefix:"",name:"base256emoji",encode:qS,decode:zS});var BS=Object.freeze({__proto__:null,base256emoji:HS}),KS=wd,Vf=128,VS=127,GS=~VS,kS=Math.pow(2,31);function wd(i,e,t){e=e||[],t=t||0;for(var s=t;i>=kS;)e[t++]=i&255|Vf,i/=128;for(;i&GS;)e[t++]=i&255|Vf,i>>>=7;return e[t]=i|0,wd.bytes=t-s+1,e}var WS=mu,YS=128,Gf=127;function mu(i,s){var t=0,s=s||0,o=0,c=s,l,p=i.length;do{if(c>=p)throw mu.bytes=0,new RangeError("Could not decode varint");l=i[c++],t+=o<28?(l&Gf)<<o:(l&Gf)*Math.pow(2,o),o+=7}while(l>=YS);return mu.bytes=c-s,t}var JS=Math.pow(2,7),XS=Math.pow(2,14),ZS=Math.pow(2,21),QS=Math.pow(2,28),e3=Math.pow(2,35),t3=Math.pow(2,42),r3=Math.pow(2,49),i3=Math.pow(2,56),n3=Math.pow(2,63),s3=function(i){return i<JS?1:i<XS?2:i<ZS?3:i<QS?4:i<e3?5:i<t3?6:i<r3?7:i<i3?8:i<n3?9:10},o3={encode:KS,decode:WS,encodingLength:s3},Ed=o3;const kf=(i,e,t=0)=>(Ed.encode(i,e,t),e),Wf=i=>Ed.encodingLength(i),bu=(i,e)=>{const t=e.byteLength,s=Wf(i),o=s+Wf(t),c=new Uint8Array(o+t);return kf(i,c,0),kf(t,c,s),c.set(e,o),new a3(i,t,e,c)};class a3{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const Sd=({name:i,code:e,encode:t})=>new c3(i,e,t);class c3{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?bu(this.code,t):t.then(s=>bu(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Id=i=>async e=>new Uint8Array(await crypto.subtle.digest(i,e)),u3=Sd({name:"sha2-256",code:18,encode:Id("SHA-256")}),h3=Sd({name:"sha2-512",code:19,encode:Id("SHA-512")});var l3=Object.freeze({__proto__:null,sha256:u3,sha512:h3});const xd=0,f3="identity",Od=vd,p3=i=>bu(xd,Od(i)),d3={code:xd,name:f3,encode:Od,digest:p3};var g3=Object.freeze({__proto__:null,identity:d3});new TextEncoder,new TextDecoder;const Yf={...aS,...uS,...lS,...pS,..._S,...OS,...TS,...RS,...US,...BS};({...l3,...g3});function Pd(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function _3(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Pd(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function Ad(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const Jf=Ad("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),Lc=Ad("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=_3(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),y3={utf8:Jf,"utf-8":Jf,hex:Yf.base16,latin1:Lc,ascii:Lc,binary:Lc,...Yf};function v3(i,e="utf8"){const t=y3[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Pd(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}const Td="wc",m3=2,Ku="core",Ni=`${Td}@2:${Ku}:`,b3={name:Ku,logger:"error"},w3={database:":memory:"},E3="crypto",Xf="client_ed25519_seed",S3=ye.ONE_DAY,I3="keychain",x3="0.3",O3="messages",P3="0.3",A3=ye.SIX_HOURS,T3="publisher",Cd="irn",C3="error",Nd="wss://relay.walletconnect.com",Zf="wss://relay.walletconnect.org",N3="relayer",At={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},R3="_subscription",cs={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},$3=ye.ONE_SECOND/2,D3="2.9.0",j3=1e4,F3="0.3",U3="WALLETCONNECT_CLIENT_ID",ti={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},L3="subscription",M3="0.3",q3=ye.FIVE_SECONDS*1e3,z3="pairing",H3="0.3",us={wc_pairingDelete:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:0},res:{ttl:ye.ONE_DAY,prompt:!1,tag:0}}},ei={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},B3="history",K3="0.3",V3="expirer",jr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},G3="0.3",Mc="verify-api",Qf="https://verify.walletconnect.com";class k3{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=I3,this.version=x3,this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:c}=ue("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=Qe.generateChildLogger(t,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,nd(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?sd(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class W3{constructor(e,t,s){this.core=e,this.logger=t,this.name=E3,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=wf(o);return Bp(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=ZE();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),l=wf(c),p=du();return await vE(p,o,S3,l)},this.generateSharedKey=(o,c,l)=>{this.isInitialized();const p=this.getPrivateKey(o),_=QE(p,c);return this.setSymKey(_,l)},this.setSymKey=async(o,c)=>{this.isInitialized();const l=c||e6(o);return await this.keychain.set(l,o),l},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,l)=>{this.isInitialized();const p=rd(l),_=ms(c);if(Af(p)){const S=p.senderPublicKey,P=p.receiverPublicKey;o=await this.generateSharedKey(S,P)}const d=this.getSymKey(o),{type:w,senderPublicKey:A}=p;return r6({type:w,symKey:d,message:_,senderPublicKey:A})},this.decode=async(o,c,l)=>{this.isInitialized();const p=s6(c,l);if(Af(p)){const w=p.receiverPublicKey,A=p.senderPublicKey;o=await this.generateSharedKey(w,A)}const _=this.getSymKey(o),d=i6({symKey:_,encoded:c});return Ou(d)},this.getPayloadType=o=>{const c=qo(o);return Is(c.type)},this.getPayloadSenderPublicKey=o=>{const c=qo(o);return c.senderPublicKey?cr(c.senderPublicKey,ar):void 0},this.core=e,this.logger=Qe.generateChildLogger(t,this.name),this.keychain=s||new k3(this.core,this.logger)}get context(){return Qe.getLoggerContext(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Xf)}catch{e=du(),await this.keychain.set(Xf,e)}return v3(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Y3 extends ww{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=O3,this.version=P3,this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const c=Tn(o);let l=this.messages.get(s);return typeof l>"u"&&(l={}),typeof l[c]<"u"||(l[c]=o,this.messages.set(s,l),await this.persist()),c},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const c=this.get(s),l=Tn(o);return typeof c[l]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Qe.generateChildLogger(e,this.name),this.core=t}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,nd(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?sd(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class J3 extends Ew{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new Lr.EventEmitter,this.name=T3,this.queue=new Map,this.publishTimeout=ye.toMiliseconds(ye.TEN_SECONDS),this.queueTimeout=ye.toMiliseconds(ye.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,o,c)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}});try{const l=(c==null?void 0:c.ttl)||A3,p=gu(c),_=(c==null?void 0:c.prompt)||!1,d=(c==null?void 0:c.tag)||0,w=(c==null?void 0:c.id)||zu().toString(),A={topic:s,message:o,opts:{ttl:l,relay:p,prompt:_,tag:d,id:w}},S=setTimeout(()=>this.queue.set(w,A),this.queueTimeout);try{await await zo(this.rpcPublish(s,o,l,p,_,d,w),this.publishTimeout),clearTimeout(S),this.relayer.events.emit(At.publish,A)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}})}catch(l){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(l),l}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=e,this.logger=Qe.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Qe.getLoggerContext(this.logger)}rpcPublish(e,t,s,o,c,l,p){var _,d,w,A;const S={method:Do(o.protocol).publish,params:{topic:e,message:t,ttl:s,prompt:c,tag:l},id:p};return or((_=S.params)==null?void 0:_.prompt)&&((d=S.params)==null||delete d.prompt),or((w=S.params)==null?void 0:w.tag)&&((A=S.params)==null||delete A.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:S}),this.relayer.request(S)}onPublish(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:s,opts:o}=e;await this.publish(t,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(Rn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(At.connection_stalled);return}this.checkQueue()}),this.relayer.on(At.message_ack,e=>{this.onPublish(e.id.toString())})}}class X3{constructor(){this.map=new Map,this.set=(e,t)=>{const s=this.get(e);this.exists(e,t)||this.map.set(e,[...s,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,t))return;const o=s.filter(c=>c!==t);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Z3=Object.defineProperty,Q3=Object.defineProperties,e5=Object.getOwnPropertyDescriptors,ep=Object.getOwnPropertySymbols,t5=Object.prototype.hasOwnProperty,r5=Object.prototype.propertyIsEnumerable,tp=(i,e,t)=>e in i?Z3(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,hs=(i,e)=>{for(var t in e||(e={}))t5.call(e,t)&&tp(i,t,e[t]);if(ep)for(var t of ep(e))r5.call(e,t)&&tp(i,t,e[t]);return i},qc=(i,e)=>Q3(i,e5(e));class i5 extends xw{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new X3,this.events=new Lr.EventEmitter,this.name=L3,this.version=M3,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ni,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const c=gu(o),l={topic:s,relay:c};this.pending.set(s,l);const p=await this.rpcSubscribe(s,c);return this.onSubscribe(p,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),p}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,c)=>{const l=new ye.Watch;l.start(this.pendingSubscriptionWatchLabel);const p=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(p),l.stop(this.pendingSubscriptionWatchLabel),o(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=q3&&(clearInterval(p),l.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Qe.generateChildLogger(t,this.name),this.clientId=""}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let s=!1;try{s=this.getSubscription(e).topic===t}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const s=this.topicMap.get(e);await Promise.all(s.map(async o=>await this.unsubscribeById(e,o,t)))}async unsubscribeById(e,t,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}});try{const o=gu(s);await this.rpcUnsubscribe(e,t,o);const c=$t("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(e,t){const s={method:Do(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await zo(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(At.connection_stalled)}return Tn(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,s={method:Do(t.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await zo(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(At.connection_stalled)}}rpcUnsubscribe(e,t,s){const o={method:Do(s.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,t){this.setSubscription(e,qc(hs({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,hs({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,s){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,hs({},t)),this.topicMap.set(t.topic,e),this.events.emit(ti.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(ti.deleted,qc(hs({},s),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ti.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(ti.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);ri(t)&&this.onBatchSubscribe(t.map((s,o)=>qc(hs({},e[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Rn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(At.connect,async()=>{await this.onConnect()}),this.relayer.on(At.disconnect,()=>{this.onDisconnect()}),this.events.on(ti.created,async e=>{const t=ti.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(ti.deleted,async e=>{const t=ti.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var n5=Object.defineProperty,rp=Object.getOwnPropertySymbols,s5=Object.prototype.hasOwnProperty,o5=Object.prototype.propertyIsEnumerable,ip=(i,e,t)=>e in i?n5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,a5=(i,e)=>{for(var t in e||(e={}))s5.call(e,t)&&ip(i,t,e[t]);if(rp)for(var t of rp(e))o5.call(e,t)&&ip(i,t,e[t]);return i};class c5 extends Sw{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Lr.EventEmitter,this.name=N3,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Qe.generateChildLogger(e.logger,this.name):Qe.pino(Qe.getDefaultLoggerOptions({level:e.logger||C3})),this.messages=new Y3(this.logger,e.core),this.subscriber=new i5(this,this.logger),this.publisher=new J3(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||Nd,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Zf}...`),await this.restartTransport(Zf)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},j3)}get context(){return Qe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,s){this.isInitialized(),await this.publisher.publish(e,t,s),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";return o||(await Promise.all([new Promise(c=>{this.subscriber.once(ti.created,l=>{l.topic===e&&c()})}),new Promise(async c=>{o=await this.subscriber.subscribe(e,t),c()})]),o)}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(At.transport_closed))}async transportOpen(e){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=e||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(t=>{this.initialized||t(),this.subscriber.once(ti.resubscribed,()=>{t()})}),await Promise.race([new Promise(async(t,s)=>{await zo(this.provider.connect(),5e3,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>s(o)).then(()=>t()).finally(()=>this.removeListener(At.transport_closed,this.rejectTransportOpen))}),new Promise(t=>this.once(At.transport_closed,this.rejectTransportOpen))])])}catch(t){this.logger.error(t);const s=t;if(!this.isConnectionStalled(s.message))throw t;this.events.emit(At.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=e||this.relayUrl,this.connected&&await Promise.all([new Promise(t=>{this.provider.once(cs.disconnect,()=>{t()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new $i(new G2(_6({sdkVersion:D3,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:s}=e;await this.messages.set(t,s)}async shouldIgnoreMessageEvent(e){const{topic:t,message:s}=e;return await this.subscriber.isSubscribed(t)?this.messages.has(t,s):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Bu(e)){if(!e.method.endsWith(R3))return;const t=e.params,{topic:s,message:o,publishedAt:c}=t.data,l={topic:s,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(a5({type:"event",event:t.id},l)),this.events.emit(t.id,l),await this.acknowledgePayload(e),await this.onMessageEvent(l)}else ta(e)&&this.events.emit(At.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(At.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=Hu(e.id,!0);await this.provider.connection.send(t)}registerProviderListeners(){this.provider.on(cs.payload,e=>this.onProviderPayload(e)),this.provider.on(cs.connect,()=>{this.events.emit(At.connect)}),this.provider.on(cs.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(cs.error,e=>{this.logger.error(e),this.events.emit(At.error,e)})}registerEventListeners(){this.events.on(At.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(At.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},ye.toMiliseconds($3))}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var u5=Object.defineProperty,np=Object.getOwnPropertySymbols,h5=Object.prototype.hasOwnProperty,l5=Object.prototype.propertyIsEnumerable,sp=(i,e,t)=>e in i?u5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,op=(i,e)=>{for(var t in e||(e={}))h5.call(e,t)&&sp(i,t,e[t]);if(np)for(var t of np(e))l5.call(e,t)&&sp(i,t,e[t]);return i};class ia extends Iw{constructor(e,t,s,o=Ni,c=void 0){super(e,t,s,o),this.core=e,this.logger=t,this.name=s,this.map=new Map,this.version=F3,this.cached=[],this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!or(l)?this.map.set(this.getKey(l),l):M6(l)?this.map.set(l.id,l):q6(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)},this.set=async(l,p)=>{this.isInitialized(),this.map.has(l)?await this.update(l,p):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:p}),this.map.set(l,p),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(p=>Object.keys(l).every(_=>W2(p[_],l[_]))):this.values),this.update=async(l,p)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:p});const _=op(op({},this.getData(l)),p);this.map.set(l,_),await this.persist()},this.delete=async(l,p)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:p}),this.map.delete(l),await this.persist())},this.logger=Qe.generateChildLogger(t,this.name),this.storagePrefix=o,this.getKey=c}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class f5{constructor(e,t){this.core=e,this.logger=t,this.name=z3,this.version=H3,this.events=new xu,this.initialized=!1,this.storagePrefix=Ni,this.ignoredPayloadTypes=[rn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=du(),o=await this.core.crypto.setSymKey(s),c=Vr(ye.FIVE_MINUTES),l={protocol:Cd},p={topic:o,expiry:c,relay:l,active:!1},_=T6({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:l});return await this.pairings.set(o,p),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:_}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:c,relay:l}=O6(s.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const p=Vr(ye.FIVE_MINUTES),_={topic:o,relay:l,expiry:p,active:!1};return await this.pairings.set(o,_),await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:l}),this.core.expirer.set(o,p),s.activatePairing&&await this.activate({topic:o}),_},this.activate=async({topic:s})=>{this.isInitialized();const o=Vr(ye.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:l,resolve:p,reject:_}=Pn();this.events.once(Ht("pairing_ping",c),({error:d})=>{d?_(d):p()}),await l()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",$t("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,c)=>{const l=Qo(o,c),p=await this.core.crypto.encode(s,l),_=us[o].req;return this.core.history.set(s,l),this.core.relayer.publish(s,p,_),l.id},this.sendResult=async(s,o,c)=>{const l=Hu(s,c),p=await this.core.crypto.encode(o,l),_=await this.core.history.get(o,s),d=us[_.request.method].res;await this.core.relayer.publish(o,p,d),await this.core.history.resolve(l)},this.sendError=async(s,o,c)=>{const l=ea(s,c),p=await this.core.crypto.encode(o,l),_=await this.core.history.get(o,s),d=us[_.request.method]?us[_.request.method].res:us.unregistered_method.res;await this.core.relayer.publish(o,p,d),await this.core.history.resolve(l)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,$t("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>Ti(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:c}=s,l=c.method;if(this.pairings.keys.includes(o))switch(l){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:c}=s,l=(await this.core.history.get(o,c.id)).request.method;if(this.pairings.keys.includes(o))switch(l){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(s,o)=>{const{id:c}=o;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit("pairing_ping",{id:c,topic:s})}catch(l){await this.sendError(c,s,l),this.logger.error(l)}},this.onPairingPingResponse=(s,o)=>{const{id:c}=o;setTimeout(()=>{yi(o)?this.events.emit(Ht("pairing_ping",c),{}):Gr(o)&&this.events.emit(Ht("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:c,topic:s})}catch(l){await this.sendError(c,s,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:c,method:l}=o;try{if(this.registeredMethods.includes(l))return;const p=$t("WC_METHOD_UNSUPPORTED",l);await this.sendError(c,s,p),this.logger.error(p)}catch(p){await this.sendError(c,s,p),this.logger.error(p)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error($t("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!gr(s)){const{message:o}=ue("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(o)}if(!L6(s.uri)){const{message:o}=ue("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(o)}},this.isValidPing=async s=>{if(!gr(s)){const{message:c}=ue("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!gr(s)){const{message:c}=ue("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!kt(s,!1)){const{message:o}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(Ti(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=ue("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=e,this.logger=Qe.generateChildLogger(t,this.name),this.pairings=new ia(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Qe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(At.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(t,s);Bu(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ta(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))})}registerExpirerEvents(){this.core.expirer.on(jr.expired,async e=>{const{topic:t}=ad(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}class p5 extends bw{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new Lr.EventEmitter,this.name=B3,this.version=K3,this.cached=[],this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:c}),this.records.has(o.id))return;const l={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:c,expiry:Vr(ye.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(ei.created,l)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Gr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(ei.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===s){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(ei.deleted,c)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Qe.generateChildLogger(t,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const s={topic:t.topic,request:Qo(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ei.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(ei.created,e=>{const t=ei.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(ei.updated,e=>{const t=ei.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(ei.deleted,e=>{const t=ei.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.core.heartbeat.on(Rn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{ye.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class d5 extends Ow{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new Lr.EventEmitter,this.name=V3,this.version=G3,this.cached=[],this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const c=this.formatTarget(s),l={target:c,expiry:o};this.expirations.set(c,l),this.checkExpiry(c,l),this.events.emit(jr.created,{target:c,expiration:l})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(jr.deleted,{target:o,expiration:c})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Qe.generateChildLogger(t,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return y6(e);if(typeof e=="number")return v6(e);const{message:t}=ue("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(jr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}checkExpiry(e,t){const{expiry:s}=t;ye.toMiliseconds(s)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(jr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Rn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(jr.created,e=>{const t=jr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(jr.expired,e=>{const t=jr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(jr.deleted,e=>{const t=jr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class g5 extends Pw{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=Mc,this.initialized=!1,this.init=async s=>{id()||!Fu()||(this.verifyUrl=(s==null?void 0:s.verifyUrl)||Qf,await this.createIframe())},this.register=async s=>{var o;if(this.initialized||await this.init(),!!this.iframe)try{(o=this.iframe.contentWindow)==null||o.postMessage(s.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${s.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async s=>{var o;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${s.attestationId}`);const c=this.startAbortTimer(ye.FIVE_SECONDS),l=await fetch(`${this.verifyUrl}/attestation/${s.attestationId}`,{signal:this.abortController.signal});return clearTimeout(c),l.status===200?(o=await l.json())==null?void 0:o.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((s,o)=>{if(document.getElementById(Mc))return s();const c=document.createElement("iframe");c.setAttribute("id",Mc),c.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),c.style.display="none",c.addEventListener("load",()=>{this.initialized=!0,s()}),c.addEventListener("error",l=>{o(l)}),document.body.append(c),this.iframe=c}),new Promise(s=>{setTimeout(()=>s("iframe load timeout"),ye.toMiliseconds(ye.ONE_SECOND/2))})])}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s)}},this.logger=Qe.generateChildLogger(t,this.name),this.verifyUrl=Qf,this.abortController=new AbortController,this.isDevEnv=ju()&&{}.IS_VITEST}get context(){return Qe.getLoggerContext(this.logger)}startAbortTimer(e){return setTimeout(()=>this.abortController.abort(),ye.toMiliseconds(e))}}var _5=Object.defineProperty,ap=Object.getOwnPropertySymbols,y5=Object.prototype.hasOwnProperty,v5=Object.prototype.propertyIsEnumerable,cp=(i,e,t)=>e in i?_5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,up=(i,e)=>{for(var t in e||(e={}))y5.call(e,t)&&cp(i,t,e[t]);if(ap)for(var t of ap(e))v5.call(e,t)&&cp(i,t,e[t]);return i};class Vu extends mw{constructor(e){super(e),this.protocol=Td,this.version=m3,this.name=Ku,this.events=new Lr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||Nd;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||b3.logger}));this.logger=Qe.generateChildLogger(t,this.name),this.heartbeat=new Rn.HeartBeat,this.crypto=new W3(this,this.logger,e==null?void 0:e.keychain),this.history=new p5(this,this.logger),this.expirer=new d5(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Ym(up(up({},w3),e==null?void 0:e.storageOptions)),this.relayer=new c5({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new f5(this,this.logger),this.verify=new g5(this.projectId||"",this.logger)}static async init(e){const t=new Vu(e);await t.initialize();const s=await t.crypto.getClientId();return await t.storage.setItem(U3,s),t}get context(){return Qe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const m5=Vu,Rd="wc",$d=2,Dd="client",Gu=`${Rd}@${$d}:${Dd}:`,zc={name:Dd,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},b5="WALLETCONNECT_DEEPLINK_CHOICE",w5="proposal",jd="Proposal expired",E5="session",No=ye.SEVEN_DAYS,S5="engine",ls={wc_sessionPropose:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1115}}},Hc={min:ye.FIVE_MINUTES,max:ye.SEVEN_DAYS},I5="request",x5=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var O5=Object.defineProperty,P5=Object.defineProperties,A5=Object.getOwnPropertyDescriptors,hp=Object.getOwnPropertySymbols,T5=Object.prototype.hasOwnProperty,C5=Object.prototype.propertyIsEnumerable,lp=(i,e,t)=>e in i?O5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Dr=(i,e)=>{for(var t in e||(e={}))T5.call(e,t)&&lp(i,t,e[t]);if(hp)for(var t of hp(e))C5.call(e,t)&&lp(i,t,e[t]);return i},Bc=(i,e)=>P5(i,A5(e));class N5 extends Tw{constructor(e){super(e),this.name=S5,this.events=new xu,this.initialized=!1,this.ignoredPayloadTypes=[rn],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(ls)}),this.initialized=!0)},this.connect=async t=>{this.isInitialized();const s=Bc(Dr({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:l,sessionProperties:p,relays:_}=s;let d=o,w,A=!1;if(d&&(A=this.client.core.pairing.pairings.get(d).active),!d||!A){const{topic:U,uri:x}=await this.client.core.pairing.create();d=U,w=x}const S=await this.client.core.crypto.generateKeyPair(),P=Dr({requiredNamespaces:c,optionalNamespaces:l,relays:_??[{protocol:Cd}],proposer:{publicKey:S,metadata:this.client.metadata}},p&&{sessionProperties:p}),{reject:M,resolve:B,done:K}=Pn(ye.FIVE_MINUTES,jd);if(this.events.once(Ht("session_connect"),async({error:U,session:x})=>{if(U)M(U);else if(x){x.self.publicKey=S;const C=Bc(Dr({},x),{requiredNamespaces:x.requiredNamespaces,optionalNamespaces:x.optionalNamespaces});await this.client.session.set(x.topic,C),await this.setExpiry(x.topic,x.expiry),d&&await this.client.core.pairing.updateMetadata({topic:d,metadata:x.peer.metadata}),B(C)}}),!d){const{message:U}=ue("NO_MATCHING_KEY",`connect() pairing topic: ${d}`);throw new Error(U)}const oe=await this.sendRequest(d,"wc_sessionPropose",P),R=Vr(ye.FIVE_MINUTES);return await this.setProposal(oe,Dr({id:oe,expiry:R},P)),{uri:w,approval:K}},this.pair=async t=>(this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{this.isInitialized(),await this.isValidApprove(t);const{id:s,relayProtocol:o,namespaces:c,sessionProperties:l}=t,p=this.client.proposal.get(s);let{pairingTopic:_,proposer:d,requiredNamespaces:w,optionalNamespaces:A}=p;_=_||"",Cn(w)||(w=$6(c,"approve()"));const S=await this.client.core.crypto.generateKeyPair(),P=d.publicKey,M=await this.client.core.crypto.generateSharedKey(S,P);_&&s&&(await this.client.core.pairing.updateMetadata({topic:_,metadata:d.metadata}),await this.sendResult(s,_,{relay:{protocol:o??"irn"},responderPublicKey:S}),await this.client.proposal.delete(s,$t("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}));const B=Dr({relay:{protocol:o??"irn"},namespaces:c,requiredNamespaces:w,optionalNamespaces:A,pairingTopic:_,controller:{publicKey:S,metadata:this.client.metadata},expiry:Vr(No)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(M),await this.sendRequest(M,"wc_sessionSettle",B);const K=Bc(Dr({},B),{topic:M,pairingTopic:_,acknowledged:!1,self:B.controller,peer:{publicKey:d.publicKey,metadata:d.metadata},controller:S});return await this.client.session.set(M,K),await this.setExpiry(M,Vr(No)),{topic:M,acknowledged:()=>new Promise(oe=>setTimeout(()=>oe(this.client.session.get(M)),500))}},this.reject=async t=>{this.isInitialized(),await this.isValidReject(t);const{id:s,reason:o}=t,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,o),await this.client.proposal.delete(s,$t("USER_DISCONNECTED")))},this.update=async t=>{this.isInitialized(),await this.isValidUpdate(t);const{topic:s,namespaces:o}=t,c=await this.sendRequest(s,"wc_sessionUpdate",{namespaces:o}),{done:l,resolve:p,reject:_}=Pn();return this.events.once(Ht("session_update",c),({error:d})=>{d?_(d):p()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:l}},this.extend=async t=>{this.isInitialized(),await this.isValidExtend(t);const{topic:s}=t,o=await this.sendRequest(s,"wc_sessionExtend",{}),{done:c,resolve:l,reject:p}=Pn();return this.events.once(Ht("session_extend",o),({error:_})=>{_?p(_):l()}),await this.setExpiry(s,Vr(No)),{acknowledged:c}},this.request=async t=>{this.isInitialized(),await this.isValidRequest(t);const{chainId:s,request:o,topic:c,expiry:l}=t,p=await this.sendRequest(c,"wc_sessionRequest",{request:o,chainId:s},l),{done:_,resolve:d,reject:w}=Pn(l);this.events.once(Ht("session_request",p),({error:S,result:P})=>{S?w(S):d(P)}),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:s,id:p});const A=await this.client.core.storage.getItem(b5);return m6({id:p,topic:c,wcDeepLink:A}),await _()},this.respond=async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:s,response:o}=t,{id:c}=o;yi(o)?await this.sendResult(c,s,o.result):Gr(o)&&await this.sendError(c,s,o.error),this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0})},this.ping=async t=>{this.isInitialized(),await this.isValidPing(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=await this.sendRequest(s,"wc_sessionPing",{}),{done:c,resolve:l,reject:p}=Pn();this.events.once(Ht("session_ping",o),({error:_})=>{_?p(_):l()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async t=>{this.isInitialized(),await this.isValidEmit(t);const{topic:s,event:o,chainId:c}=t;await this.sendRequest(s,"wc_sessionEvent",{event:o,chainId:c})},this.disconnect=async t=>{this.isInitialized(),await this.isValidDisconnect(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=zu().toString();let c;const l=p=>{(p==null?void 0:p.id.toString())===o&&(this.client.core.relayer.events.removeListener(At.message_ack,l),c())};await Promise.all([new Promise(p=>{c=p,this.client.core.relayer.on(At.message_ack,l)}),this.sendRequest(s,"wc_sessionDelete",$t("USER_DISCONNECTED"),void 0,o)]),await this.deleteSession(s)}else await this.client.core.pairing.disconnect({topic:s})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(s=>F6(s,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const s=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var l,p;return((l=c.peerMetadata)==null?void 0:l.url)&&((p=c.peerMetadata)==null?void 0:p.url)===t.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(t,s)=>{const{self:o}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),this.client.session.delete(t,$t("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(t)&&await this.client.core.crypto.deleteSymKey(t),s||this.client.core.expirer.del(t)},this.deleteProposal=async(t,s)=>{await Promise.all([this.client.proposal.delete(t,$t("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,s),o?Promise.resolve():this.client.core.expirer.del(t)])},this.setExpiry=async(t,s)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:s}),this.client.core.expirer.set(t,s)},this.setProposal=async(t,s)=>{await this.client.proposal.set(t,s),this.client.core.expirer.set(t,s.expiry)},this.setPendingSessionRequest=async t=>{const s=ls.wc_sessionRequest.req.ttl,{id:o,topic:c,params:l}=t;await this.client.pendingRequest.set(o,{id:o,topic:c,params:l}),s&&this.client.core.expirer.set(o,Vr(s))},this.sendRequest=async(t,s,o,c,l)=>{const p=Qo(s,o);if(Fu()&&x5.includes(s)){const w=Tn(JSON.stringify(p));await this.client.core.verify.register({attestationId:w})}const _=await this.client.core.crypto.encode(t,p),d=ls[s].req;return c&&(d.ttl=c),l&&(d.id=l),this.client.core.history.set(t,p),this.client.core.relayer.publish(t,_,d),p.id},this.sendResult=async(t,s,o)=>{const c=Hu(t,o),l=await this.client.core.crypto.encode(s,c),p=await this.client.core.history.get(s,t),_=ls[p.request.method].res;this.client.core.relayer.publish(s,l,_),await this.client.core.history.resolve(c)},this.sendError=async(t,s,o)=>{const c=ea(t,o),l=await this.client.core.crypto.encode(s,c),p=await this.client.core.history.get(s,t),_=ls[p.request.method].res;this.client.core.relayer.publish(s,l,_),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],s=[];this.client.session.getAll().forEach(o=>{Ti(o.expiry)&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Ti(o.expiry)&&s.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=t=>{const{topic:s,payload:o}=t,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:s,payload:o}=t,c=(await this.client.core.history.get(s,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:s}=t,{message:o}=ue("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(t,s)=>{const{params:o,id:c}=s;try{this.isValidConnect(Dr({},s.params));const l=Vr(ye.FIVE_MINUTES),p=Dr({id:c,pairingTopic:t,expiry:l},o);await this.setProposal(c,p);const _=Tn(JSON.stringify(s)),d=await this.getVerifyContext(_,p.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:p,verifyContext:d})}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(t,s)=>{const{id:o}=s;if(yi(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const l=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const p=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:p});const _=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:_});const d=await this.client.core.crypto.generateSharedKey(p,_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:d});const w=await this.client.core.relayer.subscribe(d);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:w}),await this.client.core.pairing.activate({topic:t})}else Gr(s)&&(await this.client.proposal.delete(o,$t("USER_DISCONNECTED")),this.events.emit(Ht("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:l,controller:p,expiry:_,namespaces:d,requiredNamespaces:w,optionalNamespaces:A,sessionProperties:S,pairingTopic:P}=s.params,M=Dr({topic:t,relay:l,expiry:_,namespaces:d,acknowledged:!0,pairingTopic:P,requiredNamespaces:w,optionalNamespaces:A,controller:p.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:p.publicKey,metadata:p.metadata}},S&&{sessionProperties:S});await this.sendResult(s.id,t,!0),this.events.emit(Ht("session_connect"),{session:M}),this.cleanupDuplicatePairings(M)}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(t,s)=>{const{id:o}=s;yi(s)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Ht("session_approve",o),{})):Gr(s)&&(await this.client.session.delete(t,$t("USER_DISCONNECTED")),this.events.emit(Ht("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(t,s)=>{const{params:o,id:c}=s;try{this.isValidUpdate(Dr({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult(c,t,!0),this.client.events.emit("session_update",{id:c,topic:t,params:o})}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.onSessionUpdateResponse=(t,s)=>{const{id:o}=s;yi(s)?this.events.emit(Ht("session_update",o),{}):Gr(s)&&this.events.emit(Ht("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(t,s)=>{const{id:o}=s;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Vr(No)),await this.sendResult(o,t,!0),this.client.events.emit("session_extend",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,s)=>{const{id:o}=s;yi(s)?this.events.emit(Ht("session_extend",o),{}):Gr(s)&&this.events.emit(Ht("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(t,s)=>{const{id:o}=s;try{this.isValidPing({topic:t}),await this.sendResult(o,t,!0),this.client.events.emit("session_ping",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,s)=>{const{id:o}=s;setTimeout(()=>{yi(s)?this.events.emit(Ht("session_ping",o),{}):Gr(s)&&this.events.emit(Ht("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(t,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:t,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(At.publish,async()=>{c(await this.deleteSession(t))})}),this.sendResult(o,t,!0)]),this.client.events.emit("session_delete",{id:o,topic:t})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidRequest(Dr({topic:t},c)),await this.setPendingSessionRequest({id:o,topic:t,params:c});const l=Tn(JSON.stringify(s)),p=this.client.session.get(t),_=await this.getVerifyContext(l,p.peer.metadata);this.client.events.emit("session_request",{id:o,topic:t,params:c,verifyContext:_})}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(t,s)=>{const{id:o}=s;yi(s)?this.events.emit(Ht("session_request",o),{result:s.result}):Gr(s)&&this.events.emit(Ht("session_request",o),{error:s.error})},this.onSessionEventRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidEmit(Dr({topic:t},c)),this.client.events.emit("session_event",{id:o,topic:t,params:c})}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.isValidConnect=async t=>{if(!gr(t)){const{message:_}=ue("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(_)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:l,relays:p}=t;if(or(s)||await this.isValidPairingTopic(s),!W6(p,!0)){const{message:_}=ue("MISSING_OR_INVALID",`connect() relays: ${p}`);throw new Error(_)}!or(o)&&Cn(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!or(c)&&Cn(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),or(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(t,s)=>{const o=k6(t,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!gr(t))throw new Error(ue("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:s,namespaces:o,relayProtocol:c,sessionProperties:l}=t;await this.isValidProposalId(s);const p=this.client.proposal.get(s),_=Fo(o,"approve()");if(_)throw new Error(_.message);const d=Ff(p.requiredNamespaces,o,"approve()");if(d)throw new Error(d.message);if(!kt(c,!0)){const{message:w}=ue("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(w)}or(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async t=>{if(!gr(t)){const{message:c}=ue("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:s,reason:o}=t;if(await this.isValidProposalId(s),!J6(o)){const{message:c}=ue("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!gr(t)){const{message:d}=ue("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(d)}const{relay:s,controller:o,namespaces:c,expiry:l}=t;if(!ud(s)){const{message:d}=ue("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(d)}const p=z6(o,"onSessionSettleRequest()");if(p)throw new Error(p.message);const _=Fo(c,"onSessionSettleRequest()");if(_)throw new Error(_.message);if(Ti(l)){const{message:d}=ue("EXPIRED","onSessionSettleRequest()");throw new Error(d)}},this.isValidUpdate=async t=>{if(!gr(t)){const{message:_}=ue("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(_)}const{topic:s,namespaces:o}=t;await this.isValidSessionTopic(s);const c=this.client.session.get(s),l=Fo(o,"update()");if(l)throw new Error(l.message);const p=Ff(c.requiredNamespaces,o,"update()");if(p)throw new Error(p.message)},this.isValidExtend=async t=>{if(!gr(t)){const{message:o}=ue("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionTopic(s)},this.isValidRequest=async t=>{if(!gr(t)){const{message:_}=ue("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(_)}const{topic:s,request:o,chainId:c,expiry:l}=t;await this.isValidSessionTopic(s);const{namespaces:p}=this.client.session.get(s);if(!jf(p,c)){const{message:_}=ue("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(_)}if(!X6(o)){const{message:_}=ue("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(_)}if(!e2(p,c,o.method)){const{message:_}=ue("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(_)}if(l&&!n2(l,Hc)){const{message:_}=ue("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${Hc.min} and ${Hc.max}`);throw new Error(_)}},this.isValidRespond=async t=>{if(!gr(t)){const{message:c}=ue("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(c)}const{topic:s,response:o}=t;if(await this.isValidSessionTopic(s),!Z6(o)){const{message:c}=ue("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidPing=async t=>{if(!gr(t)){const{message:o}=ue("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async t=>{if(!gr(t)){const{message:p}=ue("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(p)}const{topic:s,event:o,chainId:c}=t;await this.isValidSessionTopic(s);const{namespaces:l}=this.client.session.get(s);if(!jf(l,c)){const{message:p}=ue("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(p)}if(!Q6(o)){const{message:p}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(p)}if(!t2(l,c,o.name)){const{message:p}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(p)}},this.isValidDisconnect=async t=>{if(!gr(t)){const{message:o}=ue("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(t,s)=>{const o={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:s.verifyUrl});c&&(o.verified.origin=c,o.verified.validation=c===s.url?"VALID":"INVALID")}catch(c){this.client.logger.error(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,s)=>{Object.values(t).forEach(o=>{if(!kt(o,!1)){const{message:c}=ue("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(At.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(t,s);Bu(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ta(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})})}registerExpirerEvents(){this.client.core.expirer.on(jr.expired,async e=>{const{topic:t,id:s}=ad(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ue("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(e){if(!kt(e,!1)){const{message:t}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Ti(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=ue("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!kt(e,!1)){const{message:t}=ue("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Ti(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:t}=ue("EXPIRED",`session topic: ${e}`);throw new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(kt(e,!1)){const{message:t}=ue("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=ue("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!Y6(e)){const{message:t}=ue("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Ti(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:t}=ue("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class R5 extends ia{constructor(e,t){super(e,t,w5,Gu),this.core=e,this.logger=t}}class $5 extends ia{constructor(e,t){super(e,t,E5,Gu),this.core=e,this.logger=t}}class D5 extends ia{constructor(e,t){super(e,t,I5,Gu,s=>s.id),this.core=e,this.logger=t}}let j5=class Fd extends Aw{constructor(e){super(e),this.protocol=Rd,this.version=$d,this.name=zc.name,this.events=new Lr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||zc.name,this.metadata=(e==null?void 0:e.metadata)||f6();const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||zc.logger}));this.core=(e==null?void 0:e.core)||new m5(e),this.logger=Qe.generateChildLogger(t,this.name),this.session=new $5(this.core,this.logger),this.proposal=new R5(this.core,this.logger),this.pendingRequest=new D5(this.core,this.logger),this.engine=new N5(this)}static async init(e){const t=new Fd(e);return await t.initialize(),t}get context(){return Qe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};const F5={Accept:"application/json","Content-Type":"application/json"},U5="POST",fp={headers:F5,method:U5},pp=10;class nn{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new Lr.EventEmitter,this.isAvailable=!1,this.registering=!1,!zf(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const s=ms(e),c=await(await Wl(this.url,Object.assign(Object.assign({},fp),{body:s}))).json();this.onPayload({data:c})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!zf(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=ms({id:1,jsonrpc:"2.0",method:"test",params:[]});await Wl(e,Object.assign(Object.assign({},fp),{body:t}))}this.onOpen()}catch(t){const s=this.parseError(t);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Ou(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=ea(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return fd(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>pp&&this.events.setMaxListeners(pp)}}const dp="error",L5="wss://relay.walletconnect.com",M5="wc",q5="universal_provider",gp=`${M5}@2:${q5}:`,z5="https://rpc.walletconnect.com/v1",Di={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var fs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Fr<"u"?Fr:typeof self<"u"?self:{},wu={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(i,e){(function(){var t,s="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",p="Invalid `variable` option passed into `_.template`",_="__lodash_hash_undefined__",d=500,w="__lodash_placeholder__",A=1,S=2,P=4,M=1,B=2,K=1,oe=2,R=4,U=8,x=16,C=32,b=64,h=128,m=256,k=512,G=30,se="...",ce=800,ge=16,$=1,z=2,le=3,te=1/0,W=9007199254740991,ee=17976931348623157e292,Y=0/0,re=4294967295,Oe=re-1,ie=re>>>1,be=[["ary",h],["bind",K],["bindKey",oe],["curry",U],["curryRight",x],["flip",k],["partial",C],["partialRight",b],["rearg",m]],he="[object Arguments]",ve="[object Array]",q="[object AsyncFunction]",L="[object Boolean]",N="[object Date]",f="[object DOMException]",O="[object Error]",ne="[object Function]",fe="[object GeneratorFunction]",Ie="[object Map]",He="[object Number]",Ve="[object Null]",Ue="[object Object]",dt="[object Promise]",gt="[object Proxy]",Me="[object RegExp]",xe="[object Set]",$e="[object String]",De="[object Symbol]",qe="[object Undefined]",Ae="[object WeakMap]",je="[object WeakSet]",Se="[object ArrayBuffer]",Te="[object DataView]",Be="[object Float32Array]",Pe="[object Float64Array]",Ge="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Je="[object Uint8ClampedArray]",Qt="[object Uint16Array]",ur="[object Uint32Array]",kr=/\b__p \+= '';/g,er=/\b(__p \+=) '' \+/g,ii=/(__e\(.*?\)|\b__t\)) \+\n'';/g,vi=/&(?:amp|lt|gt|quot|#39);/g,ji=/[&<>"']/g,wt=RegExp(vi.source),_t=RegExp(ji.source),Et=/<%-([\s\S]+?)%>/g,St=/<%([\s\S]+?)%>/g,mt=/<%=([\s\S]+?)%>/g,yt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,jt=/^\w*$/,Ft=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,It=/[\\^$.*+?()[\]{}|]/g,Ut=RegExp(It.source),xt=/^\s+/,Tt=/\s/,Ot=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,Lt=/,? & /,Mt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,na=/[()=,{}\[\]\/\s]/,sa=/\\(\\)?/g,oa=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xr=/\w*$/,aa=/^[-+]0x[0-9a-f]+$/i,ca=/^0b[01]+$/i,ua=/^\[object .+?Constructor\]$/,ha=/^0o[0-7]+$/i,la=/^(?:0|[1-9]\d*)$/,ni=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,sn=/($^)/,fa=/['\n\r\u2028\u2029\\]/g,on="\\ud800-\\udfff",pa="\\u0300-\\u036f",da="\\ufe20-\\ufe2f",an="\\u20d0-\\u20ff",Os=pa+da+an,Ps="\\u2700-\\u27bf",Mr="a-z\\xdf-\\xf6\\xf8-\\xff",ga="\\xac\\xb1\\xd7\\xf7",_a="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ya="\\u2000-\\u206f",va=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",As="A-Z\\xc0-\\xd6\\xd8-\\xde",Ts="\\ufe0e\\ufe0f",Fi=ga+_a+ya+va,Fn="[']",Ui="["+on+"]",Un="["+Fi+"]",Li="["+Os+"]",Cs="\\d+",ma="["+Ps+"]",Ns="["+Mr+"]",Rs="[^"+on+Fi+Cs+Ps+Mr+As+"]",cn="\\ud83c[\\udffb-\\udfff]",ba="(?:"+Li+"|"+cn+")",$s="[^"+on+"]",un="(?:\\ud83c[\\udde6-\\uddff]){2}",mi="[\\ud800-\\udbff][\\udc00-\\udfff]",yr="["+As+"]",Ds="\\u200d",js="(?:"+Ns+"|"+Rs+")",Wr="(?:"+yr+"|"+Rs+")",Fs="(?:"+Fn+"(?:d|ll|m|re|s|t|ve))?",Us="(?:"+Fn+"(?:D|LL|M|RE|S|T|VE))?",Ls=ba+"?",Ms="["+Ts+"]?",wa="(?:"+Ds+"(?:"+[$s,un,mi].join("|")+")"+Ms+Ls+")*",si="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",qs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",zs=Ms+Ls+wa,hn="(?:"+[ma,un,mi].join("|")+")"+zs,Ea="(?:"+[$s+Li+"?",Li,un,mi,Ui].join("|")+")",Ln=RegExp(Fn,"g"),Sa=RegExp(Li,"g"),ln=RegExp(cn+"(?="+cn+")|"+Ea+zs,"g"),Hs=RegExp([yr+"?"+Ns+"+"+Fs+"(?="+[Un,yr,"$"].join("|")+")",Wr+"+"+Us+"(?="+[Un,yr+js,"$"].join("|")+")",yr+"?"+js+"+"+Fs,yr+"+"+Us,qs,si,Cs,hn].join("|"),"g"),Bs=RegExp("["+Ds+on+Os+Ts+"]"),Mi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ks=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ia=-1,ot={};ot[Be]=ot[Pe]=ot[Ge]=ot[We]=ot[et]=ot[tt]=ot[Je]=ot[Qt]=ot[ur]=!0,ot[he]=ot[ve]=ot[Se]=ot[L]=ot[Te]=ot[N]=ot[O]=ot[ne]=ot[Ie]=ot[He]=ot[Ue]=ot[Me]=ot[xe]=ot[$e]=ot[Ae]=!1;var st={};st[he]=st[ve]=st[Se]=st[Te]=st[L]=st[N]=st[Be]=st[Pe]=st[Ge]=st[We]=st[et]=st[Ie]=st[He]=st[Ue]=st[Me]=st[xe]=st[$e]=st[De]=st[tt]=st[Je]=st[Qt]=st[ur]=!0,st[O]=st[ne]=st[Ae]=!1;var E={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},D={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Z={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},at=parseFloat,Ne=parseInt,ft=typeof fs=="object"&&fs&&fs.Object===Object&&fs,qt=typeof self=="object"&&self&&self.Object===Object&&self,Xe=ft||qt||Function("return this")(),ct=e&&!e.nodeType&&e,Ct=ct&&!0&&i&&!i.nodeType&&i,hr=Ct&&Ct.exports===ct,zt=hr&&ft.process,pt=function(){try{var j=Ct&&Ct.require&&Ct.require("util").types;return j||zt&&zt.binding&&zt.binding("util")}catch{}}(),tr=pt&&pt.isArrayBuffer,qr=pt&&pt.isDate,Or=pt&&pt.isMap,Yr=pt&&pt.isRegExp,Mn=pt&&pt.isSet,qi=pt&&pt.isTypedArray;function Vt(j,V,H){switch(H.length){case 0:return j.call(V);case 1:return j.call(V,H[0]);case 2:return j.call(V,H[0],H[1]);case 3:return j.call(V,H[0],H[1],H[2])}return j.apply(V,H)}function Md(j,V,H,de){for(var Ce=-1,rt=j==null?0:j.length;++Ce<rt;){var Bt=j[Ce];V(de,Bt,H(Bt),j)}return de}function Pr(j,V){for(var H=-1,de=j==null?0:j.length;++H<de&&V(j[H],H,j)!==!1;);return j}function qd(j,V){for(var H=j==null?0:j.length;H--&&V(j[H],H,j)!==!1;);return j}function Yu(j,V){for(var H=-1,de=j==null?0:j.length;++H<de;)if(!V(j[H],H,j))return!1;return!0}function bi(j,V){for(var H=-1,de=j==null?0:j.length,Ce=0,rt=[];++H<de;){var Bt=j[H];V(Bt,H,j)&&(rt[Ce++]=Bt)}return rt}function Vs(j,V){var H=j==null?0:j.length;return!!H&&fn(j,V,0)>-1}function xa(j,V,H){for(var de=-1,Ce=j==null?0:j.length;++de<Ce;)if(H(V,j[de]))return!0;return!1}function vt(j,V){for(var H=-1,de=j==null?0:j.length,Ce=Array(de);++H<de;)Ce[H]=V(j[H],H,j);return Ce}function wi(j,V){for(var H=-1,de=V.length,Ce=j.length;++H<de;)j[Ce+H]=V[H];return j}function Oa(j,V,H,de){var Ce=-1,rt=j==null?0:j.length;for(de&&rt&&(H=j[++Ce]);++Ce<rt;)H=V(H,j[Ce],Ce,j);return H}function zd(j,V,H,de){var Ce=j==null?0:j.length;for(de&&Ce&&(H=j[--Ce]);Ce--;)H=V(H,j[Ce],Ce,j);return H}function Pa(j,V){for(var H=-1,de=j==null?0:j.length;++H<de;)if(V(j[H],H,j))return!0;return!1}var Hd=Aa("length");function Bd(j){return j.split("")}function Kd(j){return j.match(Mt)||[]}function Ju(j,V,H){var de;return H(j,function(Ce,rt,Bt){if(V(Ce,rt,Bt))return de=rt,!1}),de}function Gs(j,V,H,de){for(var Ce=j.length,rt=H+(de?1:-1);de?rt--:++rt<Ce;)if(V(j[rt],rt,j))return rt;return-1}function fn(j,V,H){return V===V?rg(j,V,H):Gs(j,Xu,H)}function Vd(j,V,H,de){for(var Ce=H-1,rt=j.length;++Ce<rt;)if(de(j[Ce],V))return Ce;return-1}function Xu(j){return j!==j}function Zu(j,V){var H=j==null?0:j.length;return H?Ca(j,V)/H:Y}function Aa(j){return function(V){return V==null?t:V[j]}}function Ta(j){return function(V){return j==null?t:j[V]}}function Qu(j,V,H,de,Ce){return Ce(j,function(rt,Bt,ut){H=de?(de=!1,rt):V(H,rt,Bt,ut)}),H}function Gd(j,V){var H=j.length;for(j.sort(V);H--;)j[H]=j[H].value;return j}function Ca(j,V){for(var H,de=-1,Ce=j.length;++de<Ce;){var rt=V(j[de]);rt!==t&&(H=H===t?rt:H+rt)}return H}function Na(j,V){for(var H=-1,de=Array(j);++H<j;)de[H]=V(H);return de}function kd(j,V){return vt(V,function(H){return[H,j[H]]})}function eh(j){return j&&j.slice(0,nh(j)+1).replace(xt,"")}function vr(j){return function(V){return j(V)}}function Ra(j,V){return vt(V,function(H){return j[H]})}function qn(j,V){return j.has(V)}function th(j,V){for(var H=-1,de=j.length;++H<de&&fn(V,j[H],0)>-1;);return H}function rh(j,V){for(var H=j.length;H--&&fn(V,j[H],0)>-1;);return H}function Wd(j,V){for(var H=j.length,de=0;H--;)j[H]===V&&++de;return de}var Yd=Ta(E),Jd=Ta(D);function Xd(j){return"\\"+pe[j]}function Zd(j,V){return j==null?t:j[V]}function pn(j){return Bs.test(j)}function Qd(j){return Mi.test(j)}function eg(j){for(var V,H=[];!(V=j.next()).done;)H.push(V.value);return H}function $a(j){var V=-1,H=Array(j.size);return j.forEach(function(de,Ce){H[++V]=[Ce,de]}),H}function ih(j,V){return function(H){return j(V(H))}}function Ei(j,V){for(var H=-1,de=j.length,Ce=0,rt=[];++H<de;){var Bt=j[H];(Bt===V||Bt===w)&&(j[H]=w,rt[Ce++]=H)}return rt}function ks(j){var V=-1,H=Array(j.size);return j.forEach(function(de){H[++V]=de}),H}function tg(j){var V=-1,H=Array(j.size);return j.forEach(function(de){H[++V]=[de,de]}),H}function rg(j,V,H){for(var de=H-1,Ce=j.length;++de<Ce;)if(j[de]===V)return de;return-1}function ig(j,V,H){for(var de=H+1;de--;)if(j[de]===V)return de;return de}function dn(j){return pn(j)?sg(j):Hd(j)}function zr(j){return pn(j)?og(j):Bd(j)}function nh(j){for(var V=j.length;V--&&Tt.test(j.charAt(V)););return V}var ng=Ta(Z);function sg(j){for(var V=ln.lastIndex=0;ln.test(j);)++V;return V}function og(j){return j.match(ln)||[]}function ag(j){return j.match(Hs)||[]}var cg=function j(V){V=V==null?Xe:gn.defaults(Xe.Object(),V,gn.pick(Xe,Ks));var H=V.Array,de=V.Date,Ce=V.Error,rt=V.Function,Bt=V.Math,ut=V.Object,Da=V.RegExp,ug=V.String,Ar=V.TypeError,Ws=H.prototype,hg=rt.prototype,_n=ut.prototype,Ys=V["__core-js_shared__"],Js=hg.toString,nt=_n.hasOwnProperty,lg=0,sh=function(){var r=/[^.]+$/.exec(Ys&&Ys.keys&&Ys.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),Xs=_n.toString,fg=Js.call(ut),pg=Xe._,dg=Da("^"+Js.call(nt).replace(It,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Zs=hr?V.Buffer:t,Si=V.Symbol,Qs=V.Uint8Array,oh=Zs?Zs.allocUnsafe:t,eo=ih(ut.getPrototypeOf,ut),ah=ut.create,ch=_n.propertyIsEnumerable,to=Ws.splice,uh=Si?Si.isConcatSpreadable:t,zn=Si?Si.iterator:t,zi=Si?Si.toStringTag:t,ro=function(){try{var r=Gi(ut,"defineProperty");return r({},"",{}),r}catch{}}(),gg=V.clearTimeout!==Xe.clearTimeout&&V.clearTimeout,_g=de&&de.now!==Xe.Date.now&&de.now,yg=V.setTimeout!==Xe.setTimeout&&V.setTimeout,io=Bt.ceil,no=Bt.floor,ja=ut.getOwnPropertySymbols,vg=Zs?Zs.isBuffer:t,hh=V.isFinite,mg=Ws.join,bg=ih(ut.keys,ut),Kt=Bt.max,Jt=Bt.min,wg=de.now,Eg=V.parseInt,lh=Bt.random,Sg=Ws.reverse,Fa=Gi(V,"DataView"),Hn=Gi(V,"Map"),Ua=Gi(V,"Promise"),yn=Gi(V,"Set"),Bn=Gi(V,"WeakMap"),Kn=Gi(ut,"create"),so=Bn&&new Bn,vn={},Ig=ki(Fa),xg=ki(Hn),Og=ki(Ua),Pg=ki(yn),Ag=ki(Bn),oo=Si?Si.prototype:t,Vn=oo?oo.valueOf:t,fh=oo?oo.toString:t;function y(r){if(Pt(r)&&!Re(r)&&!(r instanceof Ye)){if(r instanceof Tr)return r;if(nt.call(r,"__wrapped__"))return pl(r)}return new Tr(r)}var mn=function(){function r(){}return function(n){if(!bt(n))return{};if(ah)return ah(n);r.prototype=n;var a=new r;return r.prototype=t,a}}();function ao(){}function Tr(r,n){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=t}y.templateSettings={escape:Et,evaluate:St,interpolate:mt,variable:"",imports:{_:y}},y.prototype=ao.prototype,y.prototype.constructor=y,Tr.prototype=mn(ao.prototype),Tr.prototype.constructor=Tr;function Ye(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function Tg(){var r=new Ye(this.__wrapped__);return r.__actions__=lr(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=lr(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=lr(this.__views__),r}function Cg(){if(this.__filtered__){var r=new Ye(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function Ng(){var r=this.__wrapped__.value(),n=this.__dir__,a=Re(r),u=n<0,g=a?r.length:0,v=B0(0,g,this.__views__),I=v.start,T=v.end,F=T-I,J=u?T:I-1,X=this.__iteratees__,Q=X.length,ae=0,_e=Jt(F,this.__takeCount__);if(!a||!u&&g==F&&_e==F)return Fh(r,this.__actions__);var we=[];e:for(;F--&&ae<_e;){J+=n;for(var ze=-1,Ee=r[J];++ze<Q;){var ke=X[ze],Ze=ke.iteratee,wr=ke.type,nr=Ze(Ee);if(wr==z)Ee=nr;else if(!nr){if(wr==$)continue e;break e}}we[ae++]=Ee}return we}Ye.prototype=mn(ao.prototype),Ye.prototype.constructor=Ye;function Hi(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var u=r[n];this.set(u[0],u[1])}}function Rg(){this.__data__=Kn?Kn(null):{},this.size=0}function $g(r){var n=this.has(r)&&delete this.__data__[r];return this.size-=n?1:0,n}function Dg(r){var n=this.__data__;if(Kn){var a=n[r];return a===_?t:a}return nt.call(n,r)?n[r]:t}function jg(r){var n=this.__data__;return Kn?n[r]!==t:nt.call(n,r)}function Fg(r,n){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=Kn&&n===t?_:n,this}Hi.prototype.clear=Rg,Hi.prototype.delete=$g,Hi.prototype.get=Dg,Hi.prototype.has=jg,Hi.prototype.set=Fg;function oi(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var u=r[n];this.set(u[0],u[1])}}function Ug(){this.__data__=[],this.size=0}function Lg(r){var n=this.__data__,a=co(n,r);if(a<0)return!1;var u=n.length-1;return a==u?n.pop():to.call(n,a,1),--this.size,!0}function Mg(r){var n=this.__data__,a=co(n,r);return a<0?t:n[a][1]}function qg(r){return co(this.__data__,r)>-1}function zg(r,n){var a=this.__data__,u=co(a,r);return u<0?(++this.size,a.push([r,n])):a[u][1]=n,this}oi.prototype.clear=Ug,oi.prototype.delete=Lg,oi.prototype.get=Mg,oi.prototype.has=qg,oi.prototype.set=zg;function ai(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var u=r[n];this.set(u[0],u[1])}}function Hg(){this.size=0,this.__data__={hash:new Hi,map:new(Hn||oi),string:new Hi}}function Bg(r){var n=wo(this,r).delete(r);return this.size-=n?1:0,n}function Kg(r){return wo(this,r).get(r)}function Vg(r){return wo(this,r).has(r)}function Gg(r,n){var a=wo(this,r),u=a.size;return a.set(r,n),this.size+=a.size==u?0:1,this}ai.prototype.clear=Hg,ai.prototype.delete=Bg,ai.prototype.get=Kg,ai.prototype.has=Vg,ai.prototype.set=Gg;function Bi(r){var n=-1,a=r==null?0:r.length;for(this.__data__=new ai;++n<a;)this.add(r[n])}function kg(r){return this.__data__.set(r,_),this}function Wg(r){return this.__data__.has(r)}Bi.prototype.add=Bi.prototype.push=kg,Bi.prototype.has=Wg;function Hr(r){var n=this.__data__=new oi(r);this.size=n.size}function Yg(){this.__data__=new oi,this.size=0}function Jg(r){var n=this.__data__,a=n.delete(r);return this.size=n.size,a}function Xg(r){return this.__data__.get(r)}function Zg(r){return this.__data__.has(r)}function Qg(r,n){var a=this.__data__;if(a instanceof oi){var u=a.__data__;if(!Hn||u.length<o-1)return u.push([r,n]),this.size=++a.size,this;a=this.__data__=new ai(u)}return a.set(r,n),this.size=a.size,this}Hr.prototype.clear=Yg,Hr.prototype.delete=Jg,Hr.prototype.get=Xg,Hr.prototype.has=Zg,Hr.prototype.set=Qg;function ph(r,n){var a=Re(r),u=!a&&Wi(r),g=!a&&!u&&Ai(r),v=!a&&!u&&!g&&Sn(r),I=a||u||g||v,T=I?Na(r.length,ug):[],F=T.length;for(var J in r)(n||nt.call(r,J))&&!(I&&(J=="length"||g&&(J=="offset"||J=="parent")||v&&(J=="buffer"||J=="byteLength"||J=="byteOffset")||li(J,F)))&&T.push(J);return T}function dh(r){var n=r.length;return n?r[Wa(0,n-1)]:t}function e0(r,n){return Eo(lr(r),Ki(n,0,r.length))}function t0(r){return Eo(lr(r))}function La(r,n,a){(a!==t&&!Br(r[n],a)||a===t&&!(n in r))&&ci(r,n,a)}function Gn(r,n,a){var u=r[n];(!(nt.call(r,n)&&Br(u,a))||a===t&&!(n in r))&&ci(r,n,a)}function co(r,n){for(var a=r.length;a--;)if(Br(r[a][0],n))return a;return-1}function r0(r,n,a,u){return Ii(r,function(g,v,I){n(u,g,a(g),I)}),u}function gh(r,n){return r&&Xr(n,Gt(n),r)}function i0(r,n){return r&&Xr(n,pr(n),r)}function ci(r,n,a){n=="__proto__"&&ro?ro(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}function Ma(r,n){for(var a=-1,u=n.length,g=H(u),v=r==null;++a<u;)g[a]=v?t:mc(r,n[a]);return g}function Ki(r,n,a){return r===r&&(a!==t&&(r=r<=a?r:a),n!==t&&(r=r>=n?r:n)),r}function Cr(r,n,a,u,g,v){var I,T=n&A,F=n&S,J=n&P;if(a&&(I=g?a(r,u,g,v):a(r)),I!==t)return I;if(!bt(r))return r;var X=Re(r);if(X){if(I=V0(r),!T)return lr(r,I)}else{var Q=Xt(r),ae=Q==ne||Q==fe;if(Ai(r))return Mh(r,T);if(Q==Ue||Q==he||ae&&!g){if(I=F||ae?{}:nl(r),!T)return F?D0(r,i0(I,r)):$0(r,gh(I,r))}else{if(!st[Q])return g?r:{};I=G0(r,Q,T)}}v||(v=new Hr);var _e=v.get(r);if(_e)return _e;v.set(r,I),$l(r)?r.forEach(function(Ee){I.add(Cr(Ee,n,a,Ee,r,v))}):Nl(r)&&r.forEach(function(Ee,ke){I.set(ke,Cr(Ee,n,a,ke,r,v))});var we=J?F?sc:nc:F?pr:Gt,ze=X?t:we(r);return Pr(ze||r,function(Ee,ke){ze&&(ke=Ee,Ee=r[ke]),Gn(I,ke,Cr(Ee,n,a,ke,r,v))}),I}function n0(r){var n=Gt(r);return function(a){return _h(a,r,n)}}function _h(r,n,a){var u=a.length;if(r==null)return!u;for(r=ut(r);u--;){var g=a[u],v=n[g],I=r[g];if(I===t&&!(g in r)||!v(I))return!1}return!0}function yh(r,n,a){if(typeof r!="function")throw new Ar(l);return Qn(function(){r.apply(t,a)},n)}function kn(r,n,a,u){var g=-1,v=Vs,I=!0,T=r.length,F=[],J=n.length;if(!T)return F;a&&(n=vt(n,vr(a))),u?(v=xa,I=!1):n.length>=o&&(v=qn,I=!1,n=new Bi(n));e:for(;++g<T;){var X=r[g],Q=a==null?X:a(X);if(X=u||X!==0?X:0,I&&Q===Q){for(var ae=J;ae--;)if(n[ae]===Q)continue e;F.push(X)}else v(n,Q,u)||F.push(X)}return F}var Ii=Kh(Jr),vh=Kh(za,!0);function s0(r,n){var a=!0;return Ii(r,function(u,g,v){return a=!!n(u,g,v),a}),a}function uo(r,n,a){for(var u=-1,g=r.length;++u<g;){var v=r[u],I=n(v);if(I!=null&&(T===t?I===I&&!br(I):a(I,T)))var T=I,F=v}return F}function o0(r,n,a,u){var g=r.length;for(a=Le(a),a<0&&(a=-a>g?0:g+a),u=u===t||u>g?g:Le(u),u<0&&(u+=g),u=a>u?0:jl(u);a<u;)r[a++]=n;return r}function mh(r,n){var a=[];return Ii(r,function(u,g,v){n(u,g,v)&&a.push(u)}),a}function Wt(r,n,a,u,g){var v=-1,I=r.length;for(a||(a=W0),g||(g=[]);++v<I;){var T=r[v];n>0&&a(T)?n>1?Wt(T,n-1,a,u,g):wi(g,T):u||(g[g.length]=T)}return g}var qa=Vh(),bh=Vh(!0);function Jr(r,n){return r&&qa(r,n,Gt)}function za(r,n){return r&&bh(r,n,Gt)}function ho(r,n){return bi(n,function(a){return fi(r[a])})}function Vi(r,n){n=Oi(n,r);for(var a=0,u=n.length;r!=null&&a<u;)r=r[Zr(n[a++])];return a&&a==u?r:t}function wh(r,n,a){var u=n(r);return Re(r)?u:wi(u,a(r))}function rr(r){return r==null?r===t?qe:Ve:zi&&zi in ut(r)?H0(r):t_(r)}function Ha(r,n){return r>n}function a0(r,n){return r!=null&&nt.call(r,n)}function c0(r,n){return r!=null&&n in ut(r)}function u0(r,n,a){return r>=Jt(n,a)&&r<Kt(n,a)}function Ba(r,n,a){for(var u=a?xa:Vs,g=r[0].length,v=r.length,I=v,T=H(v),F=1/0,J=[];I--;){var X=r[I];I&&n&&(X=vt(X,vr(n))),F=Jt(X.length,F),T[I]=!a&&(n||g>=120&&X.length>=120)?new Bi(I&&X):t}X=r[0];var Q=-1,ae=T[0];e:for(;++Q<g&&J.length<F;){var _e=X[Q],we=n?n(_e):_e;if(_e=a||_e!==0?_e:0,!(ae?qn(ae,we):u(J,we,a))){for(I=v;--I;){var ze=T[I];if(!(ze?qn(ze,we):u(r[I],we,a)))continue e}ae&&ae.push(we),J.push(_e)}}return J}function h0(r,n,a,u){return Jr(r,function(g,v,I){n(u,a(g),v,I)}),u}function Wn(r,n,a){n=Oi(n,r),r=cl(r,n);var u=r==null?r:r[Zr(Rr(n))];return u==null?t:Vt(u,r,a)}function Eh(r){return Pt(r)&&rr(r)==he}function l0(r){return Pt(r)&&rr(r)==Se}function f0(r){return Pt(r)&&rr(r)==N}function Yn(r,n,a,u,g){return r===n?!0:r==null||n==null||!Pt(r)&&!Pt(n)?r!==r&&n!==n:p0(r,n,a,u,Yn,g)}function p0(r,n,a,u,g,v){var I=Re(r),T=Re(n),F=I?ve:Xt(r),J=T?ve:Xt(n);F=F==he?Ue:F,J=J==he?Ue:J;var X=F==Ue,Q=J==Ue,ae=F==J;if(ae&&Ai(r)){if(!Ai(n))return!1;I=!0,X=!1}if(ae&&!X)return v||(v=new Hr),I||Sn(r)?tl(r,n,a,u,g,v):q0(r,n,F,a,u,g,v);if(!(a&M)){var _e=X&&nt.call(r,"__wrapped__"),we=Q&&nt.call(n,"__wrapped__");if(_e||we){var ze=_e?r.value():r,Ee=we?n.value():n;return v||(v=new Hr),g(ze,Ee,a,u,v)}}return ae?(v||(v=new Hr),z0(r,n,a,u,g,v)):!1}function d0(r){return Pt(r)&&Xt(r)==Ie}function Ka(r,n,a,u){var g=a.length,v=g,I=!u;if(r==null)return!v;for(r=ut(r);g--;){var T=a[g];if(I&&T[2]?T[1]!==r[T[0]]:!(T[0]in r))return!1}for(;++g<v;){T=a[g];var F=T[0],J=r[F],X=T[1];if(I&&T[2]){if(J===t&&!(F in r))return!1}else{var Q=new Hr;if(u)var ae=u(J,X,F,r,n,Q);if(!(ae===t?Yn(X,J,M|B,u,Q):ae))return!1}}return!0}function Sh(r){if(!bt(r)||J0(r))return!1;var n=fi(r)?dg:ua;return n.test(ki(r))}function g0(r){return Pt(r)&&rr(r)==Me}function _0(r){return Pt(r)&&Xt(r)==xe}function y0(r){return Pt(r)&&Ao(r.length)&&!!ot[rr(r)]}function Ih(r){return typeof r=="function"?r:r==null?dr:typeof r=="object"?Re(r)?Ph(r[0],r[1]):Oh(r):Gl(r)}function Va(r){if(!Zn(r))return bg(r);var n=[];for(var a in ut(r))nt.call(r,a)&&a!="constructor"&&n.push(a);return n}function v0(r){if(!bt(r))return e_(r);var n=Zn(r),a=[];for(var u in r)u=="constructor"&&(n||!nt.call(r,u))||a.push(u);return a}function Ga(r,n){return r<n}function xh(r,n){var a=-1,u=fr(r)?H(r.length):[];return Ii(r,function(g,v,I){u[++a]=n(g,v,I)}),u}function Oh(r){var n=ac(r);return n.length==1&&n[0][2]?ol(n[0][0],n[0][1]):function(a){return a===r||Ka(a,r,n)}}function Ph(r,n){return uc(r)&&sl(n)?ol(Zr(r),n):function(a){var u=mc(a,r);return u===t&&u===n?bc(a,r):Yn(n,u,M|B)}}function lo(r,n,a,u,g){r!==n&&qa(n,function(v,I){if(g||(g=new Hr),bt(v))m0(r,n,I,a,lo,u,g);else{var T=u?u(lc(r,I),v,I+"",r,n,g):t;T===t&&(T=v),La(r,I,T)}},pr)}function m0(r,n,a,u,g,v,I){var T=lc(r,a),F=lc(n,a),J=I.get(F);if(J){La(r,a,J);return}var X=v?v(T,F,a+"",r,n,I):t,Q=X===t;if(Q){var ae=Re(F),_e=!ae&&Ai(F),we=!ae&&!_e&&Sn(F);X=F,ae||_e||we?Re(T)?X=T:Nt(T)?X=lr(T):_e?(Q=!1,X=Mh(F,!0)):we?(Q=!1,X=qh(F,!0)):X=[]:es(F)||Wi(F)?(X=T,Wi(T)?X=Fl(T):(!bt(T)||fi(T))&&(X=nl(F))):Q=!1}Q&&(I.set(F,X),g(X,F,u,v,I),I.delete(F)),La(r,a,X)}function Ah(r,n){var a=r.length;if(a)return n+=n<0?a:0,li(n,a)?r[n]:t}function Th(r,n,a){n.length?n=vt(n,function(v){return Re(v)?function(I){return Vi(I,v.length===1?v[0]:v)}:v}):n=[dr];var u=-1;n=vt(n,vr(me()));var g=xh(r,function(v,I,T){var F=vt(n,function(J){return J(v)});return{criteria:F,index:++u,value:v}});return Gd(g,function(v,I){return R0(v,I,a)})}function b0(r,n){return Ch(r,n,function(a,u){return bc(r,u)})}function Ch(r,n,a){for(var u=-1,g=n.length,v={};++u<g;){var I=n[u],T=Vi(r,I);a(T,I)&&Jn(v,Oi(I,r),T)}return v}function w0(r){return function(n){return Vi(n,r)}}function ka(r,n,a,u){var g=u?Vd:fn,v=-1,I=n.length,T=r;for(r===n&&(n=lr(n)),a&&(T=vt(r,vr(a)));++v<I;)for(var F=0,J=n[v],X=a?a(J):J;(F=g(T,X,F,u))>-1;)T!==r&&to.call(T,F,1),to.call(r,F,1);return r}function Nh(r,n){for(var a=r?n.length:0,u=a-1;a--;){var g=n[a];if(a==u||g!==v){var v=g;li(g)?to.call(r,g,1):Xa(r,g)}}return r}function Wa(r,n){return r+no(lh()*(n-r+1))}function E0(r,n,a,u){for(var g=-1,v=Kt(io((n-r)/(a||1)),0),I=H(v);v--;)I[u?v:++g]=r,r+=a;return I}function Ya(r,n){var a="";if(!r||n<1||n>W)return a;do n%2&&(a+=r),n=no(n/2),n&&(r+=r);while(n);return a}function Ke(r,n){return fc(al(r,n,dr),r+"")}function S0(r){return dh(In(r))}function I0(r,n){var a=In(r);return Eo(a,Ki(n,0,a.length))}function Jn(r,n,a,u){if(!bt(r))return r;n=Oi(n,r);for(var g=-1,v=n.length,I=v-1,T=r;T!=null&&++g<v;){var F=Zr(n[g]),J=a;if(F==="__proto__"||F==="constructor"||F==="prototype")return r;if(g!=I){var X=T[F];J=u?u(X,F,T):t,J===t&&(J=bt(X)?X:li(n[g+1])?[]:{})}Gn(T,F,J),T=T[F]}return r}var Rh=so?function(r,n){return so.set(r,n),r}:dr,x0=ro?function(r,n){return ro(r,"toString",{configurable:!0,enumerable:!1,value:Ec(n),writable:!0})}:dr;function O0(r){return Eo(In(r))}function Nr(r,n,a){var u=-1,g=r.length;n<0&&(n=-n>g?0:g+n),a=a>g?g:a,a<0&&(a+=g),g=n>a?0:a-n>>>0,n>>>=0;for(var v=H(g);++u<g;)v[u]=r[u+n];return v}function P0(r,n){var a;return Ii(r,function(u,g,v){return a=n(u,g,v),!a}),!!a}function fo(r,n,a){var u=0,g=r==null?u:r.length;if(typeof n=="number"&&n===n&&g<=ie){for(;u<g;){var v=u+g>>>1,I=r[v];I!==null&&!br(I)&&(a?I<=n:I<n)?u=v+1:g=v}return g}return Ja(r,n,dr,a)}function Ja(r,n,a,u){var g=0,v=r==null?0:r.length;if(v===0)return 0;n=a(n);for(var I=n!==n,T=n===null,F=br(n),J=n===t;g<v;){var X=no((g+v)/2),Q=a(r[X]),ae=Q!==t,_e=Q===null,we=Q===Q,ze=br(Q);if(I)var Ee=u||we;else J?Ee=we&&(u||ae):T?Ee=we&&ae&&(u||!_e):F?Ee=we&&ae&&!_e&&(u||!ze):_e||ze?Ee=!1:Ee=u?Q<=n:Q<n;Ee?g=X+1:v=X}return Jt(v,Oe)}function $h(r,n){for(var a=-1,u=r.length,g=0,v=[];++a<u;){var I=r[a],T=n?n(I):I;if(!a||!Br(T,F)){var F=T;v[g++]=I===0?0:I}}return v}function Dh(r){return typeof r=="number"?r:br(r)?Y:+r}function mr(r){if(typeof r=="string")return r;if(Re(r))return vt(r,mr)+"";if(br(r))return fh?fh.call(r):"";var n=r+"";return n=="0"&&1/r==-te?"-0":n}function xi(r,n,a){var u=-1,g=Vs,v=r.length,I=!0,T=[],F=T;if(a)I=!1,g=xa;else if(v>=o){var J=n?null:L0(r);if(J)return ks(J);I=!1,g=qn,F=new Bi}else F=n?[]:T;e:for(;++u<v;){var X=r[u],Q=n?n(X):X;if(X=a||X!==0?X:0,I&&Q===Q){for(var ae=F.length;ae--;)if(F[ae]===Q)continue e;n&&F.push(Q),T.push(X)}else g(F,Q,a)||(F!==T&&F.push(Q),T.push(X))}return T}function Xa(r,n){return n=Oi(n,r),r=cl(r,n),r==null||delete r[Zr(Rr(n))]}function jh(r,n,a,u){return Jn(r,n,a(Vi(r,n)),u)}function po(r,n,a,u){for(var g=r.length,v=u?g:-1;(u?v--:++v<g)&&n(r[v],v,r););return a?Nr(r,u?0:v,u?v+1:g):Nr(r,u?v+1:0,u?g:v)}function Fh(r,n){var a=r;return a instanceof Ye&&(a=a.value()),Oa(n,function(u,g){return g.func.apply(g.thisArg,wi([u],g.args))},a)}function Za(r,n,a){var u=r.length;if(u<2)return u?xi(r[0]):[];for(var g=-1,v=H(u);++g<u;)for(var I=r[g],T=-1;++T<u;)T!=g&&(v[g]=kn(v[g]||I,r[T],n,a));return xi(Wt(v,1),n,a)}function Uh(r,n,a){for(var u=-1,g=r.length,v=n.length,I={};++u<g;){var T=u<v?n[u]:t;a(I,r[u],T)}return I}function Qa(r){return Nt(r)?r:[]}function ec(r){return typeof r=="function"?r:dr}function Oi(r,n){return Re(r)?r:uc(r,n)?[r]:fl(it(r))}var A0=Ke;function Pi(r,n,a){var u=r.length;return a=a===t?u:a,!n&&a>=u?r:Nr(r,n,a)}var Lh=gg||function(r){return Xe.clearTimeout(r)};function Mh(r,n){if(n)return r.slice();var a=r.length,u=oh?oh(a):new r.constructor(a);return r.copy(u),u}function tc(r){var n=new r.constructor(r.byteLength);return new Qs(n).set(new Qs(r)),n}function T0(r,n){var a=n?tc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function C0(r){var n=new r.constructor(r.source,xr.exec(r));return n.lastIndex=r.lastIndex,n}function N0(r){return Vn?ut(Vn.call(r)):{}}function qh(r,n){var a=n?tc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function zh(r,n){if(r!==n){var a=r!==t,u=r===null,g=r===r,v=br(r),I=n!==t,T=n===null,F=n===n,J=br(n);if(!T&&!J&&!v&&r>n||v&&I&&F&&!T&&!J||u&&I&&F||!a&&F||!g)return 1;if(!u&&!v&&!J&&r<n||J&&a&&g&&!u&&!v||T&&a&&g||!I&&g||!F)return-1}return 0}function R0(r,n,a){for(var u=-1,g=r.criteria,v=n.criteria,I=g.length,T=a.length;++u<I;){var F=zh(g[u],v[u]);if(F){if(u>=T)return F;var J=a[u];return F*(J=="desc"?-1:1)}}return r.index-n.index}function Hh(r,n,a,u){for(var g=-1,v=r.length,I=a.length,T=-1,F=n.length,J=Kt(v-I,0),X=H(F+J),Q=!u;++T<F;)X[T]=n[T];for(;++g<I;)(Q||g<v)&&(X[a[g]]=r[g]);for(;J--;)X[T++]=r[g++];return X}function Bh(r,n,a,u){for(var g=-1,v=r.length,I=-1,T=a.length,F=-1,J=n.length,X=Kt(v-T,0),Q=H(X+J),ae=!u;++g<X;)Q[g]=r[g];for(var _e=g;++F<J;)Q[_e+F]=n[F];for(;++I<T;)(ae||g<v)&&(Q[_e+a[I]]=r[g++]);return Q}function lr(r,n){var a=-1,u=r.length;for(n||(n=H(u));++a<u;)n[a]=r[a];return n}function Xr(r,n,a,u){var g=!a;a||(a={});for(var v=-1,I=n.length;++v<I;){var T=n[v],F=u?u(a[T],r[T],T,a,r):t;F===t&&(F=r[T]),g?ci(a,T,F):Gn(a,T,F)}return a}function $0(r,n){return Xr(r,cc(r),n)}function D0(r,n){return Xr(r,rl(r),n)}function go(r,n){return function(a,u){var g=Re(a)?Md:r0,v=n?n():{};return g(a,r,me(u,2),v)}}function bn(r){return Ke(function(n,a){var u=-1,g=a.length,v=g>1?a[g-1]:t,I=g>2?a[2]:t;for(v=r.length>3&&typeof v=="function"?(g--,v):t,I&&ir(a[0],a[1],I)&&(v=g<3?t:v,g=1),n=ut(n);++u<g;){var T=a[u];T&&r(n,T,u,v)}return n})}function Kh(r,n){return function(a,u){if(a==null)return a;if(!fr(a))return r(a,u);for(var g=a.length,v=n?g:-1,I=ut(a);(n?v--:++v<g)&&u(I[v],v,I)!==!1;);return a}}function Vh(r){return function(n,a,u){for(var g=-1,v=ut(n),I=u(n),T=I.length;T--;){var F=I[r?T:++g];if(a(v[F],F,v)===!1)break}return n}}function j0(r,n,a){var u=n&K,g=Xn(r);function v(){var I=this&&this!==Xe&&this instanceof v?g:r;return I.apply(u?a:this,arguments)}return v}function Gh(r){return function(n){n=it(n);var a=pn(n)?zr(n):t,u=a?a[0]:n.charAt(0),g=a?Pi(a,1).join(""):n.slice(1);return u[r]()+g}}function wn(r){return function(n){return Oa(Kl(Bl(n).replace(Ln,"")),r,"")}}function Xn(r){return function(){var n=arguments;switch(n.length){case 0:return new r;case 1:return new r(n[0]);case 2:return new r(n[0],n[1]);case 3:return new r(n[0],n[1],n[2]);case 4:return new r(n[0],n[1],n[2],n[3]);case 5:return new r(n[0],n[1],n[2],n[3],n[4]);case 6:return new r(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new r(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var a=mn(r.prototype),u=r.apply(a,n);return bt(u)?u:a}}function F0(r,n,a){var u=Xn(r);function g(){for(var v=arguments.length,I=H(v),T=v,F=En(g);T--;)I[T]=arguments[T];var J=v<3&&I[0]!==F&&I[v-1]!==F?[]:Ei(I,F);if(v-=J.length,v<a)return Xh(r,n,_o,g.placeholder,t,I,J,t,t,a-v);var X=this&&this!==Xe&&this instanceof g?u:r;return Vt(X,this,I)}return g}function kh(r){return function(n,a,u){var g=ut(n);if(!fr(n)){var v=me(a,3);n=Gt(n),a=function(T){return v(g[T],T,g)}}var I=r(n,a,u);return I>-1?g[v?n[I]:I]:t}}function Wh(r){return hi(function(n){var a=n.length,u=a,g=Tr.prototype.thru;for(r&&n.reverse();u--;){var v=n[u];if(typeof v!="function")throw new Ar(l);if(g&&!I&&bo(v)=="wrapper")var I=new Tr([],!0)}for(u=I?u:a;++u<a;){v=n[u];var T=bo(v),F=T=="wrapper"?oc(v):t;F&&hc(F[0])&&F[1]==(h|U|C|m)&&!F[4].length&&F[9]==1?I=I[bo(F[0])].apply(I,F[3]):I=v.length==1&&hc(v)?I[T]():I.thru(v)}return function(){var J=arguments,X=J[0];if(I&&J.length==1&&Re(X))return I.plant(X).value();for(var Q=0,ae=a?n[Q].apply(this,J):X;++Q<a;)ae=n[Q].call(this,ae);return ae}})}function _o(r,n,a,u,g,v,I,T,F,J){var X=n&h,Q=n&K,ae=n&oe,_e=n&(U|x),we=n&k,ze=ae?t:Xn(r);function Ee(){for(var ke=arguments.length,Ze=H(ke),wr=ke;wr--;)Ze[wr]=arguments[wr];if(_e)var nr=En(Ee),Er=Wd(Ze,nr);if(u&&(Ze=Hh(Ze,u,g,_e)),v&&(Ze=Bh(Ze,v,I,_e)),ke-=Er,_e&&ke<J){var Rt=Ei(Ze,nr);return Xh(r,n,_o,Ee.placeholder,a,Ze,Rt,T,F,J-ke)}var Kr=Q?a:this,di=ae?Kr[r]:r;return ke=Ze.length,T?Ze=r_(Ze,T):we&&ke>1&&Ze.reverse(),X&&F<ke&&(Ze.length=F),this&&this!==Xe&&this instanceof Ee&&(di=ze||Xn(di)),di.apply(Kr,Ze)}return Ee}function Yh(r,n){return function(a,u){return h0(a,r,n(u),{})}}function yo(r,n){return function(a,u){var g;if(a===t&&u===t)return n;if(a!==t&&(g=a),u!==t){if(g===t)return u;typeof a=="string"||typeof u=="string"?(a=mr(a),u=mr(u)):(a=Dh(a),u=Dh(u)),g=r(a,u)}return g}}function rc(r){return hi(function(n){return n=vt(n,vr(me())),Ke(function(a){var u=this;return r(n,function(g){return Vt(g,u,a)})})})}function vo(r,n){n=n===t?" ":mr(n);var a=n.length;if(a<2)return a?Ya(n,r):n;var u=Ya(n,io(r/dn(n)));return pn(n)?Pi(zr(u),0,r).join(""):u.slice(0,r)}function U0(r,n,a,u){var g=n&K,v=Xn(r);function I(){for(var T=-1,F=arguments.length,J=-1,X=u.length,Q=H(X+F),ae=this&&this!==Xe&&this instanceof I?v:r;++J<X;)Q[J]=u[J];for(;F--;)Q[J++]=arguments[++T];return Vt(ae,g?a:this,Q)}return I}function Jh(r){return function(n,a,u){return u&&typeof u!="number"&&ir(n,a,u)&&(a=u=t),n=pi(n),a===t?(a=n,n=0):a=pi(a),u=u===t?n<a?1:-1:pi(u),E0(n,a,u,r)}}function mo(r){return function(n,a){return typeof n=="string"&&typeof a=="string"||(n=$r(n),a=$r(a)),r(n,a)}}function Xh(r,n,a,u,g,v,I,T,F,J){var X=n&U,Q=X?I:t,ae=X?t:I,_e=X?v:t,we=X?t:v;n|=X?C:b,n&=~(X?b:C),n&R||(n&=~(K|oe));var ze=[r,n,g,_e,Q,we,ae,T,F,J],Ee=a.apply(t,ze);return hc(r)&&ul(Ee,ze),Ee.placeholder=u,hl(Ee,r,n)}function ic(r){var n=Bt[r];return function(a,u){if(a=$r(a),u=u==null?0:Jt(Le(u),292),u&&hh(a)){var g=(it(a)+"e").split("e"),v=n(g[0]+"e"+(+g[1]+u));return g=(it(v)+"e").split("e"),+(g[0]+"e"+(+g[1]-u))}return n(a)}}var L0=yn&&1/ks(new yn([,-0]))[1]==te?function(r){return new yn(r)}:xc;function Zh(r){return function(n){var a=Xt(n);return a==Ie?$a(n):a==xe?tg(n):kd(n,r(n))}}function ui(r,n,a,u,g,v,I,T){var F=n&oe;if(!F&&typeof r!="function")throw new Ar(l);var J=u?u.length:0;if(J||(n&=~(C|b),u=g=t),I=I===t?I:Kt(Le(I),0),T=T===t?T:Le(T),J-=g?g.length:0,n&b){var X=u,Q=g;u=g=t}var ae=F?t:oc(r),_e=[r,n,a,u,g,X,Q,v,I,T];if(ae&&Q0(_e,ae),r=_e[0],n=_e[1],a=_e[2],u=_e[3],g=_e[4],T=_e[9]=_e[9]===t?F?0:r.length:Kt(_e[9]-J,0),!T&&n&(U|x)&&(n&=~(U|x)),!n||n==K)var we=j0(r,n,a);else n==U||n==x?we=F0(r,n,T):(n==C||n==(K|C))&&!g.length?we=U0(r,n,a,u):we=_o.apply(t,_e);var ze=ae?Rh:ul;return hl(ze(we,_e),r,n)}function Qh(r,n,a,u){return r===t||Br(r,_n[a])&&!nt.call(u,a)?n:r}function el(r,n,a,u,g,v){return bt(r)&&bt(n)&&(v.set(n,r),lo(r,n,t,el,v),v.delete(n)),r}function M0(r){return es(r)?t:r}function tl(r,n,a,u,g,v){var I=a&M,T=r.length,F=n.length;if(T!=F&&!(I&&F>T))return!1;var J=v.get(r),X=v.get(n);if(J&&X)return J==n&&X==r;var Q=-1,ae=!0,_e=a&B?new Bi:t;for(v.set(r,n),v.set(n,r);++Q<T;){var we=r[Q],ze=n[Q];if(u)var Ee=I?u(ze,we,Q,n,r,v):u(we,ze,Q,r,n,v);if(Ee!==t){if(Ee)continue;ae=!1;break}if(_e){if(!Pa(n,function(ke,Ze){if(!qn(_e,Ze)&&(we===ke||g(we,ke,a,u,v)))return _e.push(Ze)})){ae=!1;break}}else if(!(we===ze||g(we,ze,a,u,v))){ae=!1;break}}return v.delete(r),v.delete(n),ae}function q0(r,n,a,u,g,v,I){switch(a){case Te:if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)return!1;r=r.buffer,n=n.buffer;case Se:return!(r.byteLength!=n.byteLength||!v(new Qs(r),new Qs(n)));case L:case N:case He:return Br(+r,+n);case O:return r.name==n.name&&r.message==n.message;case Me:case $e:return r==n+"";case Ie:var T=$a;case xe:var F=u&M;if(T||(T=ks),r.size!=n.size&&!F)return!1;var J=I.get(r);if(J)return J==n;u|=B,I.set(r,n);var X=tl(T(r),T(n),u,g,v,I);return I.delete(r),X;case De:if(Vn)return Vn.call(r)==Vn.call(n)}return!1}function z0(r,n,a,u,g,v){var I=a&M,T=nc(r),F=T.length,J=nc(n),X=J.length;if(F!=X&&!I)return!1;for(var Q=F;Q--;){var ae=T[Q];if(!(I?ae in n:nt.call(n,ae)))return!1}var _e=v.get(r),we=v.get(n);if(_e&&we)return _e==n&&we==r;var ze=!0;v.set(r,n),v.set(n,r);for(var Ee=I;++Q<F;){ae=T[Q];var ke=r[ae],Ze=n[ae];if(u)var wr=I?u(Ze,ke,ae,n,r,v):u(ke,Ze,ae,r,n,v);if(!(wr===t?ke===Ze||g(ke,Ze,a,u,v):wr)){ze=!1;break}Ee||(Ee=ae=="constructor")}if(ze&&!Ee){var nr=r.constructor,Er=n.constructor;nr!=Er&&"constructor"in r&&"constructor"in n&&!(typeof nr=="function"&&nr instanceof nr&&typeof Er=="function"&&Er instanceof Er)&&(ze=!1)}return v.delete(r),v.delete(n),ze}function hi(r){return fc(al(r,t,_l),r+"")}function nc(r){return wh(r,Gt,cc)}function sc(r){return wh(r,pr,rl)}var oc=so?function(r){return so.get(r)}:xc;function bo(r){for(var n=r.name+"",a=vn[n],u=nt.call(vn,n)?a.length:0;u--;){var g=a[u],v=g.func;if(v==null||v==r)return g.name}return n}function En(r){var n=nt.call(y,"placeholder")?y:r;return n.placeholder}function me(){var r=y.iteratee||Sc;return r=r===Sc?Ih:r,arguments.length?r(arguments[0],arguments[1]):r}function wo(r,n){var a=r.__data__;return Y0(n)?a[typeof n=="string"?"string":"hash"]:a.map}function ac(r){for(var n=Gt(r),a=n.length;a--;){var u=n[a],g=r[u];n[a]=[u,g,sl(g)]}return n}function Gi(r,n){var a=Zd(r,n);return Sh(a)?a:t}function H0(r){var n=nt.call(r,zi),a=r[zi];try{r[zi]=t;var u=!0}catch{}var g=Xs.call(r);return u&&(n?r[zi]=a:delete r[zi]),g}var cc=ja?function(r){return r==null?[]:(r=ut(r),bi(ja(r),function(n){return ch.call(r,n)}))}:Oc,rl=ja?function(r){for(var n=[];r;)wi(n,cc(r)),r=eo(r);return n}:Oc,Xt=rr;(Fa&&Xt(new Fa(new ArrayBuffer(1)))!=Te||Hn&&Xt(new Hn)!=Ie||Ua&&Xt(Ua.resolve())!=dt||yn&&Xt(new yn)!=xe||Bn&&Xt(new Bn)!=Ae)&&(Xt=function(r){var n=rr(r),a=n==Ue?r.constructor:t,u=a?ki(a):"";if(u)switch(u){case Ig:return Te;case xg:return Ie;case Og:return dt;case Pg:return xe;case Ag:return Ae}return n});function B0(r,n,a){for(var u=-1,g=a.length;++u<g;){var v=a[u],I=v.size;switch(v.type){case"drop":r+=I;break;case"dropRight":n-=I;break;case"take":n=Jt(n,r+I);break;case"takeRight":r=Kt(r,n-I);break}}return{start:r,end:n}}function K0(r){var n=r.match(ht);return n?n[1].split(Lt):[]}function il(r,n,a){n=Oi(n,r);for(var u=-1,g=n.length,v=!1;++u<g;){var I=Zr(n[u]);if(!(v=r!=null&&a(r,I)))break;r=r[I]}return v||++u!=g?v:(g=r==null?0:r.length,!!g&&Ao(g)&&li(I,g)&&(Re(r)||Wi(r)))}function V0(r){var n=r.length,a=new r.constructor(n);return n&&typeof r[0]=="string"&&nt.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function nl(r){return typeof r.constructor=="function"&&!Zn(r)?mn(eo(r)):{}}function G0(r,n,a){var u=r.constructor;switch(n){case Se:return tc(r);case L:case N:return new u(+r);case Te:return T0(r,a);case Be:case Pe:case Ge:case We:case et:case tt:case Je:case Qt:case ur:return qh(r,a);case Ie:return new u;case He:case $e:return new u(r);case Me:return C0(r);case xe:return new u;case De:return N0(r)}}function k0(r,n){var a=n.length;if(!a)return r;var u=a-1;return n[u]=(a>1?"& ":"")+n[u],n=n.join(a>2?", ":" "),r.replace(Ot,`{
/* [wrapped with `+n+`] */
`)}function W0(r){return Re(r)||Wi(r)||!!(uh&&r&&r[uh])}function li(r,n){var a=typeof r;return n=n??W,!!n&&(a=="number"||a!="symbol"&&la.test(r))&&r>-1&&r%1==0&&r<n}function ir(r,n,a){if(!bt(a))return!1;var u=typeof n;return(u=="number"?fr(a)&&li(n,a.length):u=="string"&&n in a)?Br(a[n],r):!1}function uc(r,n){if(Re(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||br(r)?!0:jt.test(r)||!yt.test(r)||n!=null&&r in ut(n)}function Y0(r){var n=typeof r;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?r!=="__proto__":r===null}function hc(r){var n=bo(r),a=y[n];if(typeof a!="function"||!(n in Ye.prototype))return!1;if(r===a)return!0;var u=oc(a);return!!u&&r===u[0]}function J0(r){return!!sh&&sh in r}var X0=Ys?fi:Pc;function Zn(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||_n;return r===a}function sl(r){return r===r&&!bt(r)}function ol(r,n){return function(a){return a==null?!1:a[r]===n&&(n!==t||r in ut(a))}}function Z0(r){var n=Oo(r,function(u){return a.size===d&&a.clear(),u}),a=n.cache;return n}function Q0(r,n){var a=r[1],u=n[1],g=a|u,v=g<(K|oe|h),I=u==h&&a==U||u==h&&a==m&&r[7].length<=n[8]||u==(h|m)&&n[7].length<=n[8]&&a==U;if(!(v||I))return r;u&K&&(r[2]=n[2],g|=a&K?0:R);var T=n[3];if(T){var F=r[3];r[3]=F?Hh(F,T,n[4]):T,r[4]=F?Ei(r[3],w):n[4]}return T=n[5],T&&(F=r[5],r[5]=F?Bh(F,T,n[6]):T,r[6]=F?Ei(r[5],w):n[6]),T=n[7],T&&(r[7]=T),u&h&&(r[8]=r[8]==null?n[8]:Jt(r[8],n[8])),r[9]==null&&(r[9]=n[9]),r[0]=n[0],r[1]=g,r}function e_(r){var n=[];if(r!=null)for(var a in ut(r))n.push(a);return n}function t_(r){return Xs.call(r)}function al(r,n,a){return n=Kt(n===t?r.length-1:n,0),function(){for(var u=arguments,g=-1,v=Kt(u.length-n,0),I=H(v);++g<v;)I[g]=u[n+g];g=-1;for(var T=H(n+1);++g<n;)T[g]=u[g];return T[n]=a(I),Vt(r,this,T)}}function cl(r,n){return n.length<2?r:Vi(r,Nr(n,0,-1))}function r_(r,n){for(var a=r.length,u=Jt(n.length,a),g=lr(r);u--;){var v=n[u];r[u]=li(v,a)?g[v]:t}return r}function lc(r,n){if(!(n==="constructor"&&typeof r[n]=="function")&&n!="__proto__")return r[n]}var ul=ll(Rh),Qn=yg||function(r,n){return Xe.setTimeout(r,n)},fc=ll(x0);function hl(r,n,a){var u=n+"";return fc(r,k0(u,i_(K0(u),a)))}function ll(r){var n=0,a=0;return function(){var u=wg(),g=ge-(u-a);if(a=u,g>0){if(++n>=ce)return arguments[0]}else n=0;return r.apply(t,arguments)}}function Eo(r,n){var a=-1,u=r.length,g=u-1;for(n=n===t?u:n;++a<n;){var v=Wa(a,g),I=r[v];r[v]=r[a],r[a]=I}return r.length=n,r}var fl=Z0(function(r){var n=[];return r.charCodeAt(0)===46&&n.push(""),r.replace(Ft,function(a,u,g,v){n.push(g?v.replace(sa,"$1"):u||a)}),n});function Zr(r){if(typeof r=="string"||br(r))return r;var n=r+"";return n=="0"&&1/r==-te?"-0":n}function ki(r){if(r!=null){try{return Js.call(r)}catch{}try{return r+""}catch{}}return""}function i_(r,n){return Pr(be,function(a){var u="_."+a[0];n&a[1]&&!Vs(r,u)&&r.push(u)}),r.sort()}function pl(r){if(r instanceof Ye)return r.clone();var n=new Tr(r.__wrapped__,r.__chain__);return n.__actions__=lr(r.__actions__),n.__index__=r.__index__,n.__values__=r.__values__,n}function n_(r,n,a){(a?ir(r,n,a):n===t)?n=1:n=Kt(Le(n),0);var u=r==null?0:r.length;if(!u||n<1)return[];for(var g=0,v=0,I=H(io(u/n));g<u;)I[v++]=Nr(r,g,g+=n);return I}function s_(r){for(var n=-1,a=r==null?0:r.length,u=0,g=[];++n<a;){var v=r[n];v&&(g[u++]=v)}return g}function o_(){var r=arguments.length;if(!r)return[];for(var n=H(r-1),a=arguments[0],u=r;u--;)n[u-1]=arguments[u];return wi(Re(a)?lr(a):[a],Wt(n,1))}var a_=Ke(function(r,n){return Nt(r)?kn(r,Wt(n,1,Nt,!0)):[]}),c_=Ke(function(r,n){var a=Rr(n);return Nt(a)&&(a=t),Nt(r)?kn(r,Wt(n,1,Nt,!0),me(a,2)):[]}),u_=Ke(function(r,n){var a=Rr(n);return Nt(a)&&(a=t),Nt(r)?kn(r,Wt(n,1,Nt,!0),t,a):[]});function h_(r,n,a){var u=r==null?0:r.length;return u?(n=a||n===t?1:Le(n),Nr(r,n<0?0:n,u)):[]}function l_(r,n,a){var u=r==null?0:r.length;return u?(n=a||n===t?1:Le(n),n=u-n,Nr(r,0,n<0?0:n)):[]}function f_(r,n){return r&&r.length?po(r,me(n,3),!0,!0):[]}function p_(r,n){return r&&r.length?po(r,me(n,3),!0):[]}function d_(r,n,a,u){var g=r==null?0:r.length;return g?(a&&typeof a!="number"&&ir(r,n,a)&&(a=0,u=g),o0(r,n,a,u)):[]}function dl(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var g=a==null?0:Le(a);return g<0&&(g=Kt(u+g,0)),Gs(r,me(n,3),g)}function gl(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var g=u-1;return a!==t&&(g=Le(a),g=a<0?Kt(u+g,0):Jt(g,u-1)),Gs(r,me(n,3),g,!0)}function _l(r){var n=r==null?0:r.length;return n?Wt(r,1):[]}function g_(r){var n=r==null?0:r.length;return n?Wt(r,te):[]}function __(r,n){var a=r==null?0:r.length;return a?(n=n===t?1:Le(n),Wt(r,n)):[]}function y_(r){for(var n=-1,a=r==null?0:r.length,u={};++n<a;){var g=r[n];u[g[0]]=g[1]}return u}function yl(r){return r&&r.length?r[0]:t}function v_(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var g=a==null?0:Le(a);return g<0&&(g=Kt(u+g,0)),fn(r,n,g)}function m_(r){var n=r==null?0:r.length;return n?Nr(r,0,-1):[]}var b_=Ke(function(r){var n=vt(r,Qa);return n.length&&n[0]===r[0]?Ba(n):[]}),w_=Ke(function(r){var n=Rr(r),a=vt(r,Qa);return n===Rr(a)?n=t:a.pop(),a.length&&a[0]===r[0]?Ba(a,me(n,2)):[]}),E_=Ke(function(r){var n=Rr(r),a=vt(r,Qa);return n=typeof n=="function"?n:t,n&&a.pop(),a.length&&a[0]===r[0]?Ba(a,t,n):[]});function S_(r,n){return r==null?"":mg.call(r,n)}function Rr(r){var n=r==null?0:r.length;return n?r[n-1]:t}function I_(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var g=u;return a!==t&&(g=Le(a),g=g<0?Kt(u+g,0):Jt(g,u-1)),n===n?ig(r,n,g):Gs(r,Xu,g,!0)}function x_(r,n){return r&&r.length?Ah(r,Le(n)):t}var O_=Ke(vl);function vl(r,n){return r&&r.length&&n&&n.length?ka(r,n):r}function P_(r,n,a){return r&&r.length&&n&&n.length?ka(r,n,me(a,2)):r}function A_(r,n,a){return r&&r.length&&n&&n.length?ka(r,n,t,a):r}var T_=hi(function(r,n){var a=r==null?0:r.length,u=Ma(r,n);return Nh(r,vt(n,function(g){return li(g,a)?+g:g}).sort(zh)),u});function C_(r,n){var a=[];if(!(r&&r.length))return a;var u=-1,g=[],v=r.length;for(n=me(n,3);++u<v;){var I=r[u];n(I,u,r)&&(a.push(I),g.push(u))}return Nh(r,g),a}function pc(r){return r==null?r:Sg.call(r)}function N_(r,n,a){var u=r==null?0:r.length;return u?(a&&typeof a!="number"&&ir(r,n,a)?(n=0,a=u):(n=n==null?0:Le(n),a=a===t?u:Le(a)),Nr(r,n,a)):[]}function R_(r,n){return fo(r,n)}function $_(r,n,a){return Ja(r,n,me(a,2))}function D_(r,n){var a=r==null?0:r.length;if(a){var u=fo(r,n);if(u<a&&Br(r[u],n))return u}return-1}function j_(r,n){return fo(r,n,!0)}function F_(r,n,a){return Ja(r,n,me(a,2),!0)}function U_(r,n){var a=r==null?0:r.length;if(a){var u=fo(r,n,!0)-1;if(Br(r[u],n))return u}return-1}function L_(r){return r&&r.length?$h(r):[]}function M_(r,n){return r&&r.length?$h(r,me(n,2)):[]}function q_(r){var n=r==null?0:r.length;return n?Nr(r,1,n):[]}function z_(r,n,a){return r&&r.length?(n=a||n===t?1:Le(n),Nr(r,0,n<0?0:n)):[]}function H_(r,n,a){var u=r==null?0:r.length;return u?(n=a||n===t?1:Le(n),n=u-n,Nr(r,n<0?0:n,u)):[]}function B_(r,n){return r&&r.length?po(r,me(n,3),!1,!0):[]}function K_(r,n){return r&&r.length?po(r,me(n,3)):[]}var V_=Ke(function(r){return xi(Wt(r,1,Nt,!0))}),G_=Ke(function(r){var n=Rr(r);return Nt(n)&&(n=t),xi(Wt(r,1,Nt,!0),me(n,2))}),k_=Ke(function(r){var n=Rr(r);return n=typeof n=="function"?n:t,xi(Wt(r,1,Nt,!0),t,n)});function W_(r){return r&&r.length?xi(r):[]}function Y_(r,n){return r&&r.length?xi(r,me(n,2)):[]}function J_(r,n){return n=typeof n=="function"?n:t,r&&r.length?xi(r,t,n):[]}function dc(r){if(!(r&&r.length))return[];var n=0;return r=bi(r,function(a){if(Nt(a))return n=Kt(a.length,n),!0}),Na(n,function(a){return vt(r,Aa(a))})}function ml(r,n){if(!(r&&r.length))return[];var a=dc(r);return n==null?a:vt(a,function(u){return Vt(n,t,u)})}var X_=Ke(function(r,n){return Nt(r)?kn(r,n):[]}),Z_=Ke(function(r){return Za(bi(r,Nt))}),Q_=Ke(function(r){var n=Rr(r);return Nt(n)&&(n=t),Za(bi(r,Nt),me(n,2))}),ey=Ke(function(r){var n=Rr(r);return n=typeof n=="function"?n:t,Za(bi(r,Nt),t,n)}),ty=Ke(dc);function ry(r,n){return Uh(r||[],n||[],Gn)}function iy(r,n){return Uh(r||[],n||[],Jn)}var ny=Ke(function(r){var n=r.length,a=n>1?r[n-1]:t;return a=typeof a=="function"?(r.pop(),a):t,ml(r,a)});function bl(r){var n=y(r);return n.__chain__=!0,n}function sy(r,n){return n(r),r}function So(r,n){return n(r)}var oy=hi(function(r){var n=r.length,a=n?r[0]:0,u=this.__wrapped__,g=function(v){return Ma(v,r)};return n>1||this.__actions__.length||!(u instanceof Ye)||!li(a)?this.thru(g):(u=u.slice(a,+a+(n?1:0)),u.__actions__.push({func:So,args:[g],thisArg:t}),new Tr(u,this.__chain__).thru(function(v){return n&&!v.length&&v.push(t),v}))});function ay(){return bl(this)}function cy(){return new Tr(this.value(),this.__chain__)}function uy(){this.__values__===t&&(this.__values__=Dl(this.value()));var r=this.__index__>=this.__values__.length,n=r?t:this.__values__[this.__index__++];return{done:r,value:n}}function hy(){return this}function ly(r){for(var n,a=this;a instanceof ao;){var u=pl(a);u.__index__=0,u.__values__=t,n?g.__wrapped__=u:n=u;var g=u;a=a.__wrapped__}return g.__wrapped__=r,n}function fy(){var r=this.__wrapped__;if(r instanceof Ye){var n=r;return this.__actions__.length&&(n=new Ye(this)),n=n.reverse(),n.__actions__.push({func:So,args:[pc],thisArg:t}),new Tr(n,this.__chain__)}return this.thru(pc)}function py(){return Fh(this.__wrapped__,this.__actions__)}var dy=go(function(r,n,a){nt.call(r,a)?++r[a]:ci(r,a,1)});function gy(r,n,a){var u=Re(r)?Yu:s0;return a&&ir(r,n,a)&&(n=t),u(r,me(n,3))}function _y(r,n){var a=Re(r)?bi:mh;return a(r,me(n,3))}var yy=kh(dl),vy=kh(gl);function my(r,n){return Wt(Io(r,n),1)}function by(r,n){return Wt(Io(r,n),te)}function wy(r,n,a){return a=a===t?1:Le(a),Wt(Io(r,n),a)}function wl(r,n){var a=Re(r)?Pr:Ii;return a(r,me(n,3))}function El(r,n){var a=Re(r)?qd:vh;return a(r,me(n,3))}var Ey=go(function(r,n,a){nt.call(r,a)?r[a].push(n):ci(r,a,[n])});function Sy(r,n,a,u){r=fr(r)?r:In(r),a=a&&!u?Le(a):0;var g=r.length;return a<0&&(a=Kt(g+a,0)),To(r)?a<=g&&r.indexOf(n,a)>-1:!!g&&fn(r,n,a)>-1}var Iy=Ke(function(r,n,a){var u=-1,g=typeof n=="function",v=fr(r)?H(r.length):[];return Ii(r,function(I){v[++u]=g?Vt(n,I,a):Wn(I,n,a)}),v}),xy=go(function(r,n,a){ci(r,a,n)});function Io(r,n){var a=Re(r)?vt:xh;return a(r,me(n,3))}function Oy(r,n,a,u){return r==null?[]:(Re(n)||(n=n==null?[]:[n]),a=u?t:a,Re(a)||(a=a==null?[]:[a]),Th(r,n,a))}var Py=go(function(r,n,a){r[a?0:1].push(n)},function(){return[[],[]]});function Ay(r,n,a){var u=Re(r)?Oa:Qu,g=arguments.length<3;return u(r,me(n,4),a,g,Ii)}function Ty(r,n,a){var u=Re(r)?zd:Qu,g=arguments.length<3;return u(r,me(n,4),a,g,vh)}function Cy(r,n){var a=Re(r)?bi:mh;return a(r,Po(me(n,3)))}function Ny(r){var n=Re(r)?dh:S0;return n(r)}function Ry(r,n,a){(a?ir(r,n,a):n===t)?n=1:n=Le(n);var u=Re(r)?e0:I0;return u(r,n)}function $y(r){var n=Re(r)?t0:O0;return n(r)}function Dy(r){if(r==null)return 0;if(fr(r))return To(r)?dn(r):r.length;var n=Xt(r);return n==Ie||n==xe?r.size:Va(r).length}function jy(r,n,a){var u=Re(r)?Pa:P0;return a&&ir(r,n,a)&&(n=t),u(r,me(n,3))}var Fy=Ke(function(r,n){if(r==null)return[];var a=n.length;return a>1&&ir(r,n[0],n[1])?n=[]:a>2&&ir(n[0],n[1],n[2])&&(n=[n[0]]),Th(r,Wt(n,1),[])}),xo=_g||function(){return Xe.Date.now()};function Uy(r,n){if(typeof n!="function")throw new Ar(l);return r=Le(r),function(){if(--r<1)return n.apply(this,arguments)}}function Sl(r,n,a){return n=a?t:n,n=r&&n==null?r.length:n,ui(r,h,t,t,t,t,n)}function Il(r,n){var a;if(typeof n!="function")throw new Ar(l);return r=Le(r),function(){return--r>0&&(a=n.apply(this,arguments)),r<=1&&(n=t),a}}var gc=Ke(function(r,n,a){var u=K;if(a.length){var g=Ei(a,En(gc));u|=C}return ui(r,u,n,a,g)}),xl=Ke(function(r,n,a){var u=K|oe;if(a.length){var g=Ei(a,En(xl));u|=C}return ui(n,u,r,a,g)});function Ol(r,n,a){n=a?t:n;var u=ui(r,U,t,t,t,t,t,n);return u.placeholder=Ol.placeholder,u}function Pl(r,n,a){n=a?t:n;var u=ui(r,x,t,t,t,t,t,n);return u.placeholder=Pl.placeholder,u}function Al(r,n,a){var u,g,v,I,T,F,J=0,X=!1,Q=!1,ae=!0;if(typeof r!="function")throw new Ar(l);n=$r(n)||0,bt(a)&&(X=!!a.leading,Q="maxWait"in a,v=Q?Kt($r(a.maxWait)||0,n):v,ae="trailing"in a?!!a.trailing:ae);function _e(Rt){var Kr=u,di=g;return u=g=t,J=Rt,I=r.apply(di,Kr),I}function we(Rt){return J=Rt,T=Qn(ke,n),X?_e(Rt):I}function ze(Rt){var Kr=Rt-F,di=Rt-J,kl=n-Kr;return Q?Jt(kl,v-di):kl}function Ee(Rt){var Kr=Rt-F,di=Rt-J;return F===t||Kr>=n||Kr<0||Q&&di>=v}function ke(){var Rt=xo();if(Ee(Rt))return Ze(Rt);T=Qn(ke,ze(Rt))}function Ze(Rt){return T=t,ae&&u?_e(Rt):(u=g=t,I)}function wr(){T!==t&&Lh(T),J=0,u=F=g=T=t}function nr(){return T===t?I:Ze(xo())}function Er(){var Rt=xo(),Kr=Ee(Rt);if(u=arguments,g=this,F=Rt,Kr){if(T===t)return we(F);if(Q)return Lh(T),T=Qn(ke,n),_e(F)}return T===t&&(T=Qn(ke,n)),I}return Er.cancel=wr,Er.flush=nr,Er}var Ly=Ke(function(r,n){return yh(r,1,n)}),My=Ke(function(r,n,a){return yh(r,$r(n)||0,a)});function qy(r){return ui(r,k)}function Oo(r,n){if(typeof r!="function"||n!=null&&typeof n!="function")throw new Ar(l);var a=function(){var u=arguments,g=n?n.apply(this,u):u[0],v=a.cache;if(v.has(g))return v.get(g);var I=r.apply(this,u);return a.cache=v.set(g,I)||v,I};return a.cache=new(Oo.Cache||ai),a}Oo.Cache=ai;function Po(r){if(typeof r!="function")throw new Ar(l);return function(){var n=arguments;switch(n.length){case 0:return!r.call(this);case 1:return!r.call(this,n[0]);case 2:return!r.call(this,n[0],n[1]);case 3:return!r.call(this,n[0],n[1],n[2])}return!r.apply(this,n)}}function zy(r){return Il(2,r)}var Hy=A0(function(r,n){n=n.length==1&&Re(n[0])?vt(n[0],vr(me())):vt(Wt(n,1),vr(me()));var a=n.length;return Ke(function(u){for(var g=-1,v=Jt(u.length,a);++g<v;)u[g]=n[g].call(this,u[g]);return Vt(r,this,u)})}),_c=Ke(function(r,n){var a=Ei(n,En(_c));return ui(r,C,t,n,a)}),Tl=Ke(function(r,n){var a=Ei(n,En(Tl));return ui(r,b,t,n,a)}),By=hi(function(r,n){return ui(r,m,t,t,t,n)});function Ky(r,n){if(typeof r!="function")throw new Ar(l);return n=n===t?n:Le(n),Ke(r,n)}function Vy(r,n){if(typeof r!="function")throw new Ar(l);return n=n==null?0:Kt(Le(n),0),Ke(function(a){var u=a[n],g=Pi(a,0,n);return u&&wi(g,u),Vt(r,this,g)})}function Gy(r,n,a){var u=!0,g=!0;if(typeof r!="function")throw new Ar(l);return bt(a)&&(u="leading"in a?!!a.leading:u,g="trailing"in a?!!a.trailing:g),Al(r,n,{leading:u,maxWait:n,trailing:g})}function ky(r){return Sl(r,1)}function Wy(r,n){return _c(ec(n),r)}function Yy(){if(!arguments.length)return[];var r=arguments[0];return Re(r)?r:[r]}function Jy(r){return Cr(r,P)}function Xy(r,n){return n=typeof n=="function"?n:t,Cr(r,P,n)}function Zy(r){return Cr(r,A|P)}function Qy(r,n){return n=typeof n=="function"?n:t,Cr(r,A|P,n)}function e1(r,n){return n==null||_h(r,n,Gt(n))}function Br(r,n){return r===n||r!==r&&n!==n}var t1=mo(Ha),r1=mo(function(r,n){return r>=n}),Wi=Eh(function(){return arguments}())?Eh:function(r){return Pt(r)&&nt.call(r,"callee")&&!ch.call(r,"callee")},Re=H.isArray,i1=tr?vr(tr):l0;function fr(r){return r!=null&&Ao(r.length)&&!fi(r)}function Nt(r){return Pt(r)&&fr(r)}function n1(r){return r===!0||r===!1||Pt(r)&&rr(r)==L}var Ai=vg||Pc,s1=qr?vr(qr):f0;function o1(r){return Pt(r)&&r.nodeType===1&&!es(r)}function a1(r){if(r==null)return!0;if(fr(r)&&(Re(r)||typeof r=="string"||typeof r.splice=="function"||Ai(r)||Sn(r)||Wi(r)))return!r.length;var n=Xt(r);if(n==Ie||n==xe)return!r.size;if(Zn(r))return!Va(r).length;for(var a in r)if(nt.call(r,a))return!1;return!0}function c1(r,n){return Yn(r,n)}function u1(r,n,a){a=typeof a=="function"?a:t;var u=a?a(r,n):t;return u===t?Yn(r,n,t,a):!!u}function yc(r){if(!Pt(r))return!1;var n=rr(r);return n==O||n==f||typeof r.message=="string"&&typeof r.name=="string"&&!es(r)}function h1(r){return typeof r=="number"&&hh(r)}function fi(r){if(!bt(r))return!1;var n=rr(r);return n==ne||n==fe||n==q||n==gt}function Cl(r){return typeof r=="number"&&r==Le(r)}function Ao(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=W}function bt(r){var n=typeof r;return r!=null&&(n=="object"||n=="function")}function Pt(r){return r!=null&&typeof r=="object"}var Nl=Or?vr(Or):d0;function l1(r,n){return r===n||Ka(r,n,ac(n))}function f1(r,n,a){return a=typeof a=="function"?a:t,Ka(r,n,ac(n),a)}function p1(r){return Rl(r)&&r!=+r}function d1(r){if(X0(r))throw new Ce(c);return Sh(r)}function g1(r){return r===null}function _1(r){return r==null}function Rl(r){return typeof r=="number"||Pt(r)&&rr(r)==He}function es(r){if(!Pt(r)||rr(r)!=Ue)return!1;var n=eo(r);if(n===null)return!0;var a=nt.call(n,"constructor")&&n.constructor;return typeof a=="function"&&a instanceof a&&Js.call(a)==fg}var vc=Yr?vr(Yr):g0;function y1(r){return Cl(r)&&r>=-W&&r<=W}var $l=Mn?vr(Mn):_0;function To(r){return typeof r=="string"||!Re(r)&&Pt(r)&&rr(r)==$e}function br(r){return typeof r=="symbol"||Pt(r)&&rr(r)==De}var Sn=qi?vr(qi):y0;function v1(r){return r===t}function m1(r){return Pt(r)&&Xt(r)==Ae}function b1(r){return Pt(r)&&rr(r)==je}var w1=mo(Ga),E1=mo(function(r,n){return r<=n});function Dl(r){if(!r)return[];if(fr(r))return To(r)?zr(r):lr(r);if(zn&&r[zn])return eg(r[zn]());var n=Xt(r),a=n==Ie?$a:n==xe?ks:In;return a(r)}function pi(r){if(!r)return r===0?r:0;if(r=$r(r),r===te||r===-te){var n=r<0?-1:1;return n*ee}return r===r?r:0}function Le(r){var n=pi(r),a=n%1;return n===n?a?n-a:n:0}function jl(r){return r?Ki(Le(r),0,re):0}function $r(r){if(typeof r=="number")return r;if(br(r))return Y;if(bt(r)){var n=typeof r.valueOf=="function"?r.valueOf():r;r=bt(n)?n+"":n}if(typeof r!="string")return r===0?r:+r;r=eh(r);var a=ca.test(r);return a||ha.test(r)?Ne(r.slice(2),a?2:8):aa.test(r)?Y:+r}function Fl(r){return Xr(r,pr(r))}function S1(r){return r?Ki(Le(r),-W,W):r===0?r:0}function it(r){return r==null?"":mr(r)}var I1=bn(function(r,n){if(Zn(n)||fr(n)){Xr(n,Gt(n),r);return}for(var a in n)nt.call(n,a)&&Gn(r,a,n[a])}),Ul=bn(function(r,n){Xr(n,pr(n),r)}),Co=bn(function(r,n,a,u){Xr(n,pr(n),r,u)}),x1=bn(function(r,n,a,u){Xr(n,Gt(n),r,u)}),O1=hi(Ma);function P1(r,n){var a=mn(r);return n==null?a:gh(a,n)}var A1=Ke(function(r,n){r=ut(r);var a=-1,u=n.length,g=u>2?n[2]:t;for(g&&ir(n[0],n[1],g)&&(u=1);++a<u;)for(var v=n[a],I=pr(v),T=-1,F=I.length;++T<F;){var J=I[T],X=r[J];(X===t||Br(X,_n[J])&&!nt.call(r,J))&&(r[J]=v[J])}return r}),T1=Ke(function(r){return r.push(t,el),Vt(Ll,t,r)});function C1(r,n){return Ju(r,me(n,3),Jr)}function N1(r,n){return Ju(r,me(n,3),za)}function R1(r,n){return r==null?r:qa(r,me(n,3),pr)}function $1(r,n){return r==null?r:bh(r,me(n,3),pr)}function D1(r,n){return r&&Jr(r,me(n,3))}function j1(r,n){return r&&za(r,me(n,3))}function F1(r){return r==null?[]:ho(r,Gt(r))}function U1(r){return r==null?[]:ho(r,pr(r))}function mc(r,n,a){var u=r==null?t:Vi(r,n);return u===t?a:u}function L1(r,n){return r!=null&&il(r,n,a0)}function bc(r,n){return r!=null&&il(r,n,c0)}var M1=Yh(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=Xs.call(n)),r[n]=a},Ec(dr)),q1=Yh(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=Xs.call(n)),nt.call(r,n)?r[n].push(a):r[n]=[a]},me),z1=Ke(Wn);function Gt(r){return fr(r)?ph(r):Va(r)}function pr(r){return fr(r)?ph(r,!0):v0(r)}function H1(r,n){var a={};return n=me(n,3),Jr(r,function(u,g,v){ci(a,n(u,g,v),u)}),a}function B1(r,n){var a={};return n=me(n,3),Jr(r,function(u,g,v){ci(a,g,n(u,g,v))}),a}var K1=bn(function(r,n,a){lo(r,n,a)}),Ll=bn(function(r,n,a,u){lo(r,n,a,u)}),V1=hi(function(r,n){var a={};if(r==null)return a;var u=!1;n=vt(n,function(v){return v=Oi(v,r),u||(u=v.length>1),v}),Xr(r,sc(r),a),u&&(a=Cr(a,A|S|P,M0));for(var g=n.length;g--;)Xa(a,n[g]);return a});function G1(r,n){return Ml(r,Po(me(n)))}var k1=hi(function(r,n){return r==null?{}:b0(r,n)});function Ml(r,n){if(r==null)return{};var a=vt(sc(r),function(u){return[u]});return n=me(n),Ch(r,a,function(u,g){return n(u,g[0])})}function W1(r,n,a){n=Oi(n,r);var u=-1,g=n.length;for(g||(g=1,r=t);++u<g;){var v=r==null?t:r[Zr(n[u])];v===t&&(u=g,v=a),r=fi(v)?v.call(r):v}return r}function Y1(r,n,a){return r==null?r:Jn(r,n,a)}function J1(r,n,a,u){return u=typeof u=="function"?u:t,r==null?r:Jn(r,n,a,u)}var ql=Zh(Gt),zl=Zh(pr);function X1(r,n,a){var u=Re(r),g=u||Ai(r)||Sn(r);if(n=me(n,4),a==null){var v=r&&r.constructor;g?a=u?new v:[]:bt(r)?a=fi(v)?mn(eo(r)):{}:a={}}return(g?Pr:Jr)(r,function(I,T,F){return n(a,I,T,F)}),a}function Z1(r,n){return r==null?!0:Xa(r,n)}function Q1(r,n,a){return r==null?r:jh(r,n,ec(a))}function ev(r,n,a,u){return u=typeof u=="function"?u:t,r==null?r:jh(r,n,ec(a),u)}function In(r){return r==null?[]:Ra(r,Gt(r))}function tv(r){return r==null?[]:Ra(r,pr(r))}function rv(r,n,a){return a===t&&(a=n,n=t),a!==t&&(a=$r(a),a=a===a?a:0),n!==t&&(n=$r(n),n=n===n?n:0),Ki($r(r),n,a)}function iv(r,n,a){return n=pi(n),a===t?(a=n,n=0):a=pi(a),r=$r(r),u0(r,n,a)}function nv(r,n,a){if(a&&typeof a!="boolean"&&ir(r,n,a)&&(n=a=t),a===t&&(typeof n=="boolean"?(a=n,n=t):typeof r=="boolean"&&(a=r,r=t)),r===t&&n===t?(r=0,n=1):(r=pi(r),n===t?(n=r,r=0):n=pi(n)),r>n){var u=r;r=n,n=u}if(a||r%1||n%1){var g=lh();return Jt(r+g*(n-r+at("1e-"+((g+"").length-1))),n)}return Wa(r,n)}var sv=wn(function(r,n,a){return n=n.toLowerCase(),r+(a?Hl(n):n)});function Hl(r){return wc(it(r).toLowerCase())}function Bl(r){return r=it(r),r&&r.replace(ni,Yd).replace(Sa,"")}function ov(r,n,a){r=it(r),n=mr(n);var u=r.length;a=a===t?u:Ki(Le(a),0,u);var g=a;return a-=n.length,a>=0&&r.slice(a,g)==n}function av(r){return r=it(r),r&&_t.test(r)?r.replace(ji,Jd):r}function cv(r){return r=it(r),r&&Ut.test(r)?r.replace(It,"\\$&"):r}var uv=wn(function(r,n,a){return r+(a?"-":"")+n.toLowerCase()}),hv=wn(function(r,n,a){return r+(a?" ":"")+n.toLowerCase()}),lv=Gh("toLowerCase");function fv(r,n,a){r=it(r),n=Le(n);var u=n?dn(r):0;if(!n||u>=n)return r;var g=(n-u)/2;return vo(no(g),a)+r+vo(io(g),a)}function pv(r,n,a){r=it(r),n=Le(n);var u=n?dn(r):0;return n&&u<n?r+vo(n-u,a):r}function dv(r,n,a){r=it(r),n=Le(n);var u=n?dn(r):0;return n&&u<n?vo(n-u,a)+r:r}function gv(r,n,a){return a||n==null?n=0:n&&(n=+n),Eg(it(r).replace(xt,""),n||0)}function _v(r,n,a){return(a?ir(r,n,a):n===t)?n=1:n=Le(n),Ya(it(r),n)}function yv(){var r=arguments,n=it(r[0]);return r.length<3?n:n.replace(r[1],r[2])}var vv=wn(function(r,n,a){return r+(a?"_":"")+n.toLowerCase()});function mv(r,n,a){return a&&typeof a!="number"&&ir(r,n,a)&&(n=a=t),a=a===t?re:a>>>0,a?(r=it(r),r&&(typeof n=="string"||n!=null&&!vc(n))&&(n=mr(n),!n&&pn(r))?Pi(zr(r),0,a):r.split(n,a)):[]}var bv=wn(function(r,n,a){return r+(a?" ":"")+wc(n)});function wv(r,n,a){return r=it(r),a=a==null?0:Ki(Le(a),0,r.length),n=mr(n),r.slice(a,a+n.length)==n}function Ev(r,n,a){var u=y.templateSettings;a&&ir(r,n,a)&&(n=t),r=it(r),n=Co({},n,u,Qh);var g=Co({},n.imports,u.imports,Qh),v=Gt(g),I=Ra(g,v),T,F,J=0,X=n.interpolate||sn,Q="__p += '",ae=Da((n.escape||sn).source+"|"+X.source+"|"+(X===mt?oa:sn).source+"|"+(n.evaluate||sn).source+"|$","g"),_e="//# sourceURL="+(nt.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ia+"]")+`
`;r.replace(ae,function(Ee,ke,Ze,wr,nr,Er){return Ze||(Ze=wr),Q+=r.slice(J,Er).replace(fa,Xd),ke&&(T=!0,Q+=`' +
__e(`+ke+`) +
'`),nr&&(F=!0,Q+=`';
`+nr+`;
__p += '`),Ze&&(Q+=`' +
((__t = (`+Ze+`)) == null ? '' : __t) +
'`),J=Er+Ee.length,Ee}),Q+=`';
`;var we=nt.call(n,"variable")&&n.variable;if(!we)Q=`with (obj) {
`+Q+`
}
`;else if(na.test(we))throw new Ce(p);Q=(F?Q.replace(kr,""):Q).replace(er,"$1").replace(ii,"$1;"),Q="function("+(we||"obj")+`) {
`+(we?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(T?", __e = _.escape":"")+(F?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Q+`return __p
}`;var ze=Vl(function(){return rt(v,_e+"return "+Q).apply(t,I)});if(ze.source=Q,yc(ze))throw ze;return ze}function Sv(r){return it(r).toLowerCase()}function Iv(r){return it(r).toUpperCase()}function xv(r,n,a){if(r=it(r),r&&(a||n===t))return eh(r);if(!r||!(n=mr(n)))return r;var u=zr(r),g=zr(n),v=th(u,g),I=rh(u,g)+1;return Pi(u,v,I).join("")}function Ov(r,n,a){if(r=it(r),r&&(a||n===t))return r.slice(0,nh(r)+1);if(!r||!(n=mr(n)))return r;var u=zr(r),g=rh(u,zr(n))+1;return Pi(u,0,g).join("")}function Pv(r,n,a){if(r=it(r),r&&(a||n===t))return r.replace(xt,"");if(!r||!(n=mr(n)))return r;var u=zr(r),g=th(u,zr(n));return Pi(u,g).join("")}function Av(r,n){var a=G,u=se;if(bt(n)){var g="separator"in n?n.separator:g;a="length"in n?Le(n.length):a,u="omission"in n?mr(n.omission):u}r=it(r);var v=r.length;if(pn(r)){var I=zr(r);v=I.length}if(a>=v)return r;var T=a-dn(u);if(T<1)return u;var F=I?Pi(I,0,T).join(""):r.slice(0,T);if(g===t)return F+u;if(I&&(T+=F.length-T),vc(g)){if(r.slice(T).search(g)){var J,X=F;for(g.global||(g=Da(g.source,it(xr.exec(g))+"g")),g.lastIndex=0;J=g.exec(X);)var Q=J.index;F=F.slice(0,Q===t?T:Q)}}else if(r.indexOf(mr(g),T)!=T){var ae=F.lastIndexOf(g);ae>-1&&(F=F.slice(0,ae))}return F+u}function Tv(r){return r=it(r),r&&wt.test(r)?r.replace(vi,ng):r}var Cv=wn(function(r,n,a){return r+(a?" ":"")+n.toUpperCase()}),wc=Gh("toUpperCase");function Kl(r,n,a){return r=it(r),n=a?t:n,n===t?Qd(r)?ag(r):Kd(r):r.match(n)||[]}var Vl=Ke(function(r,n){try{return Vt(r,t,n)}catch(a){return yc(a)?a:new Ce(a)}}),Nv=hi(function(r,n){return Pr(n,function(a){a=Zr(a),ci(r,a,gc(r[a],r))}),r});function Rv(r){var n=r==null?0:r.length,a=me();return r=n?vt(r,function(u){if(typeof u[1]!="function")throw new Ar(l);return[a(u[0]),u[1]]}):[],Ke(function(u){for(var g=-1;++g<n;){var v=r[g];if(Vt(v[0],this,u))return Vt(v[1],this,u)}})}function $v(r){return n0(Cr(r,A))}function Ec(r){return function(){return r}}function Dv(r,n){return r==null||r!==r?n:r}var jv=Wh(),Fv=Wh(!0);function dr(r){return r}function Sc(r){return Ih(typeof r=="function"?r:Cr(r,A))}function Uv(r){return Oh(Cr(r,A))}function Lv(r,n){return Ph(r,Cr(n,A))}var Mv=Ke(function(r,n){return function(a){return Wn(a,r,n)}}),qv=Ke(function(r,n){return function(a){return Wn(r,a,n)}});function Ic(r,n,a){var u=Gt(n),g=ho(n,u);a==null&&!(bt(n)&&(g.length||!u.length))&&(a=n,n=r,r=this,g=ho(n,Gt(n)));var v=!(bt(a)&&"chain"in a)||!!a.chain,I=fi(r);return Pr(g,function(T){var F=n[T];r[T]=F,I&&(r.prototype[T]=function(){var J=this.__chain__;if(v||J){var X=r(this.__wrapped__),Q=X.__actions__=lr(this.__actions__);return Q.push({func:F,args:arguments,thisArg:r}),X.__chain__=J,X}return F.apply(r,wi([this.value()],arguments))})}),r}function zv(){return Xe._===this&&(Xe._=pg),this}function xc(){}function Hv(r){return r=Le(r),Ke(function(n){return Ah(n,r)})}var Bv=rc(vt),Kv=rc(Yu),Vv=rc(Pa);function Gl(r){return uc(r)?Aa(Zr(r)):w0(r)}function Gv(r){return function(n){return r==null?t:Vi(r,n)}}var kv=Jh(),Wv=Jh(!0);function Oc(){return[]}function Pc(){return!1}function Yv(){return{}}function Jv(){return""}function Xv(){return!0}function Zv(r,n){if(r=Le(r),r<1||r>W)return[];var a=re,u=Jt(r,re);n=me(n),r-=re;for(var g=Na(u,n);++a<r;)n(a);return g}function Qv(r){return Re(r)?vt(r,Zr):br(r)?[r]:lr(fl(it(r)))}function em(r){var n=++lg;return it(r)+n}var tm=yo(function(r,n){return r+n},0),rm=ic("ceil"),im=yo(function(r,n){return r/n},1),nm=ic("floor");function sm(r){return r&&r.length?uo(r,dr,Ha):t}function om(r,n){return r&&r.length?uo(r,me(n,2),Ha):t}function am(r){return Zu(r,dr)}function cm(r,n){return Zu(r,me(n,2))}function um(r){return r&&r.length?uo(r,dr,Ga):t}function hm(r,n){return r&&r.length?uo(r,me(n,2),Ga):t}var lm=yo(function(r,n){return r*n},1),fm=ic("round"),pm=yo(function(r,n){return r-n},0);function dm(r){return r&&r.length?Ca(r,dr):0}function gm(r,n){return r&&r.length?Ca(r,me(n,2)):0}return y.after=Uy,y.ary=Sl,y.assign=I1,y.assignIn=Ul,y.assignInWith=Co,y.assignWith=x1,y.at=O1,y.before=Il,y.bind=gc,y.bindAll=Nv,y.bindKey=xl,y.castArray=Yy,y.chain=bl,y.chunk=n_,y.compact=s_,y.concat=o_,y.cond=Rv,y.conforms=$v,y.constant=Ec,y.countBy=dy,y.create=P1,y.curry=Ol,y.curryRight=Pl,y.debounce=Al,y.defaults=A1,y.defaultsDeep=T1,y.defer=Ly,y.delay=My,y.difference=a_,y.differenceBy=c_,y.differenceWith=u_,y.drop=h_,y.dropRight=l_,y.dropRightWhile=f_,y.dropWhile=p_,y.fill=d_,y.filter=_y,y.flatMap=my,y.flatMapDeep=by,y.flatMapDepth=wy,y.flatten=_l,y.flattenDeep=g_,y.flattenDepth=__,y.flip=qy,y.flow=jv,y.flowRight=Fv,y.fromPairs=y_,y.functions=F1,y.functionsIn=U1,y.groupBy=Ey,y.initial=m_,y.intersection=b_,y.intersectionBy=w_,y.intersectionWith=E_,y.invert=M1,y.invertBy=q1,y.invokeMap=Iy,y.iteratee=Sc,y.keyBy=xy,y.keys=Gt,y.keysIn=pr,y.map=Io,y.mapKeys=H1,y.mapValues=B1,y.matches=Uv,y.matchesProperty=Lv,y.memoize=Oo,y.merge=K1,y.mergeWith=Ll,y.method=Mv,y.methodOf=qv,y.mixin=Ic,y.negate=Po,y.nthArg=Hv,y.omit=V1,y.omitBy=G1,y.once=zy,y.orderBy=Oy,y.over=Bv,y.overArgs=Hy,y.overEvery=Kv,y.overSome=Vv,y.partial=_c,y.partialRight=Tl,y.partition=Py,y.pick=k1,y.pickBy=Ml,y.property=Gl,y.propertyOf=Gv,y.pull=O_,y.pullAll=vl,y.pullAllBy=P_,y.pullAllWith=A_,y.pullAt=T_,y.range=kv,y.rangeRight=Wv,y.rearg=By,y.reject=Cy,y.remove=C_,y.rest=Ky,y.reverse=pc,y.sampleSize=Ry,y.set=Y1,y.setWith=J1,y.shuffle=$y,y.slice=N_,y.sortBy=Fy,y.sortedUniq=L_,y.sortedUniqBy=M_,y.split=mv,y.spread=Vy,y.tail=q_,y.take=z_,y.takeRight=H_,y.takeRightWhile=B_,y.takeWhile=K_,y.tap=sy,y.throttle=Gy,y.thru=So,y.toArray=Dl,y.toPairs=ql,y.toPairsIn=zl,y.toPath=Qv,y.toPlainObject=Fl,y.transform=X1,y.unary=ky,y.union=V_,y.unionBy=G_,y.unionWith=k_,y.uniq=W_,y.uniqBy=Y_,y.uniqWith=J_,y.unset=Z1,y.unzip=dc,y.unzipWith=ml,y.update=Q1,y.updateWith=ev,y.values=In,y.valuesIn=tv,y.without=X_,y.words=Kl,y.wrap=Wy,y.xor=Z_,y.xorBy=Q_,y.xorWith=ey,y.zip=ty,y.zipObject=ry,y.zipObjectDeep=iy,y.zipWith=ny,y.entries=ql,y.entriesIn=zl,y.extend=Ul,y.extendWith=Co,Ic(y,y),y.add=tm,y.attempt=Vl,y.camelCase=sv,y.capitalize=Hl,y.ceil=rm,y.clamp=rv,y.clone=Jy,y.cloneDeep=Zy,y.cloneDeepWith=Qy,y.cloneWith=Xy,y.conformsTo=e1,y.deburr=Bl,y.defaultTo=Dv,y.divide=im,y.endsWith=ov,y.eq=Br,y.escape=av,y.escapeRegExp=cv,y.every=gy,y.find=yy,y.findIndex=dl,y.findKey=C1,y.findLast=vy,y.findLastIndex=gl,y.findLastKey=N1,y.floor=nm,y.forEach=wl,y.forEachRight=El,y.forIn=R1,y.forInRight=$1,y.forOwn=D1,y.forOwnRight=j1,y.get=mc,y.gt=t1,y.gte=r1,y.has=L1,y.hasIn=bc,y.head=yl,y.identity=dr,y.includes=Sy,y.indexOf=v_,y.inRange=iv,y.invoke=z1,y.isArguments=Wi,y.isArray=Re,y.isArrayBuffer=i1,y.isArrayLike=fr,y.isArrayLikeObject=Nt,y.isBoolean=n1,y.isBuffer=Ai,y.isDate=s1,y.isElement=o1,y.isEmpty=a1,y.isEqual=c1,y.isEqualWith=u1,y.isError=yc,y.isFinite=h1,y.isFunction=fi,y.isInteger=Cl,y.isLength=Ao,y.isMap=Nl,y.isMatch=l1,y.isMatchWith=f1,y.isNaN=p1,y.isNative=d1,y.isNil=_1,y.isNull=g1,y.isNumber=Rl,y.isObject=bt,y.isObjectLike=Pt,y.isPlainObject=es,y.isRegExp=vc,y.isSafeInteger=y1,y.isSet=$l,y.isString=To,y.isSymbol=br,y.isTypedArray=Sn,y.isUndefined=v1,y.isWeakMap=m1,y.isWeakSet=b1,y.join=S_,y.kebabCase=uv,y.last=Rr,y.lastIndexOf=I_,y.lowerCase=hv,y.lowerFirst=lv,y.lt=w1,y.lte=E1,y.max=sm,y.maxBy=om,y.mean=am,y.meanBy=cm,y.min=um,y.minBy=hm,y.stubArray=Oc,y.stubFalse=Pc,y.stubObject=Yv,y.stubString=Jv,y.stubTrue=Xv,y.multiply=lm,y.nth=x_,y.noConflict=zv,y.noop=xc,y.now=xo,y.pad=fv,y.padEnd=pv,y.padStart=dv,y.parseInt=gv,y.random=nv,y.reduce=Ay,y.reduceRight=Ty,y.repeat=_v,y.replace=yv,y.result=W1,y.round=fm,y.runInContext=j,y.sample=Ny,y.size=Dy,y.snakeCase=vv,y.some=jy,y.sortedIndex=R_,y.sortedIndexBy=$_,y.sortedIndexOf=D_,y.sortedLastIndex=j_,y.sortedLastIndexBy=F_,y.sortedLastIndexOf=U_,y.startCase=bv,y.startsWith=wv,y.subtract=pm,y.sum=dm,y.sumBy=gm,y.template=Ev,y.times=Zv,y.toFinite=pi,y.toInteger=Le,y.toLength=jl,y.toLower=Sv,y.toNumber=$r,y.toSafeInteger=S1,y.toString=it,y.toUpper=Iv,y.trim=xv,y.trimEnd=Ov,y.trimStart=Pv,y.truncate=Av,y.unescape=Tv,y.uniqueId=em,y.upperCase=Cv,y.upperFirst=wc,y.each=wl,y.eachRight=El,y.first=yl,Ic(y,function(){var r={};return Jr(y,function(n,a){nt.call(y.prototype,a)||(r[a]=n)}),r}(),{chain:!1}),y.VERSION=s,Pr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){y[r].placeholder=y}),Pr(["drop","take"],function(r,n){Ye.prototype[r]=function(a){a=a===t?1:Kt(Le(a),0);var u=this.__filtered__&&!n?new Ye(this):this.clone();return u.__filtered__?u.__takeCount__=Jt(a,u.__takeCount__):u.__views__.push({size:Jt(a,re),type:r+(u.__dir__<0?"Right":"")}),u},Ye.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),Pr(["filter","map","takeWhile"],function(r,n){var a=n+1,u=a==$||a==le;Ye.prototype[r]=function(g){var v=this.clone();return v.__iteratees__.push({iteratee:me(g,3),type:a}),v.__filtered__=v.__filtered__||u,v}}),Pr(["head","last"],function(r,n){var a="take"+(n?"Right":"");Ye.prototype[r]=function(){return this[a](1).value()[0]}}),Pr(["initial","tail"],function(r,n){var a="drop"+(n?"":"Right");Ye.prototype[r]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(dr)},Ye.prototype.find=function(r){return this.filter(r).head()},Ye.prototype.findLast=function(r){return this.reverse().find(r)},Ye.prototype.invokeMap=Ke(function(r,n){return typeof r=="function"?new Ye(this):this.map(function(a){return Wn(a,r,n)})}),Ye.prototype.reject=function(r){return this.filter(Po(me(r)))},Ye.prototype.slice=function(r,n){r=Le(r);var a=this;return a.__filtered__&&(r>0||n<0)?new Ye(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),n!==t&&(n=Le(n),a=n<0?a.dropRight(-n):a.take(n-r)),a)},Ye.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Ye.prototype.toArray=function(){return this.take(re)},Jr(Ye.prototype,function(r,n){var a=/^(?:filter|find|map|reject)|While$/.test(n),u=/^(?:head|last)$/.test(n),g=y[u?"take"+(n=="last"?"Right":""):n],v=u||/^find/.test(n);g&&(y.prototype[n]=function(){var I=this.__wrapped__,T=u?[1]:arguments,F=I instanceof Ye,J=T[0],X=F||Re(I),Q=function(ke){var Ze=g.apply(y,wi([ke],T));return u&&ae?Ze[0]:Ze};X&&a&&typeof J=="function"&&J.length!=1&&(F=X=!1);var ae=this.__chain__,_e=!!this.__actions__.length,we=v&&!ae,ze=F&&!_e;if(!v&&X){I=ze?I:new Ye(this);var Ee=r.apply(I,T);return Ee.__actions__.push({func:So,args:[Q],thisArg:t}),new Tr(Ee,ae)}return we&&ze?r.apply(this,T):(Ee=this.thru(Q),we?u?Ee.value()[0]:Ee.value():Ee)})}),Pr(["pop","push","shift","sort","splice","unshift"],function(r){var n=Ws[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",u=/^(?:pop|shift)$/.test(r);y.prototype[r]=function(){var g=arguments;if(u&&!this.__chain__){var v=this.value();return n.apply(Re(v)?v:[],g)}return this[a](function(I){return n.apply(Re(I)?I:[],g)})}}),Jr(Ye.prototype,function(r,n){var a=y[n];if(a){var u=a.name+"";nt.call(vn,u)||(vn[u]=[]),vn[u].push({name:n,func:a})}}),vn[_o(t,oe).name]=[{name:"wrapper",func:t}],Ye.prototype.clone=Tg,Ye.prototype.reverse=Cg,Ye.prototype.value=Ng,y.prototype.at=oy,y.prototype.chain=ay,y.prototype.commit=cy,y.prototype.next=uy,y.prototype.plant=ly,y.prototype.reverse=fy,y.prototype.toJSON=y.prototype.valueOf=y.prototype.value=py,y.prototype.first=y.prototype.head,zn&&(y.prototype[zn]=hy),y},gn=cg();Ct?((Ct.exports=gn)._=gn,ct._=gn):Xe._=gn}).call(fs)})(wu,wu.exports);var H5=Object.defineProperty,B5=Object.defineProperties,K5=Object.getOwnPropertyDescriptors,_p=Object.getOwnPropertySymbols,V5=Object.prototype.hasOwnProperty,G5=Object.prototype.propertyIsEnumerable,yp=(i,e,t)=>e in i?H5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Ro=(i,e)=>{for(var t in e||(e={}))V5.call(e,t)&&yp(i,t,e[t]);if(_p)for(var t of _p(e))G5.call(e,t)&&yp(i,t,e[t]);return i},k5=(i,e)=>B5(i,K5(e));function Ur(i,e,t){let s;const o=Eu(i);return e.rpcMap&&(s=e.rpcMap[o]),s||(s=`${z5}?chainId=eip155:${o}&projectId=${t}`),s}function Eu(i){return i.includes("eip155")?Number(i.split(":")[1]):Number(i)}function Ud(i){return i.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function W5(i,e){const t=Object.keys(e.namespaces).filter(o=>o.includes(i));if(!t.length)return[];const s=[];return t.forEach(o=>{const c=e.namespaces[o].accounts;s.push(...c)}),s}function Y5(i={},e={}){const t=vp(i),s=vp(e);return wu.exports.merge(t,s)}function vp(i){var e,t,s,o;const c={};if(!Cn(i))return c;for(const[l,p]of Object.entries(i)){const _=Lu(l)?[l]:p.chains,d=p.methods||[],w=p.events||[],A=p.rpcMap||{},S=jo(l);c[S]=k5(Ro(Ro({},c[S]),p),{chains:Uc(_,(e=c[S])==null?void 0:e.chains),methods:Uc(d,(t=c[S])==null?void 0:t.methods),events:Uc(w,(s=c[S])==null?void 0:s.events),rpcMap:Ro(Ro({},A),(o=c[S])==null?void 0:o.rpcMap)})}return c}function J5(i){return i.includes(":")?i.split(":")[2]:i}function X5(i){const e={};for(const[t,s]of Object.entries(i)){const o=s.methods||[],c=s.events||[],l=s.accounts||[],p=Lu(t)?[t]:s.chains?s.chains:Ud(s.accounts);e[t]={chains:p,methods:o,events:c,accounts:l}}return e}const Ld={},Dt=i=>Ld[i],Kc=(i,e)=>{Ld[i]=e};class Z5{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=Dt("events"),this.client=Dt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||Ur(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Di.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Ur(e,this.namespace);return typeof s>"u"?void 0:new $i(new nn(s,Dt("disableProviderPing")))}}class Q5{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=Dt("events"),this.client=Dt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){const s=Eu(e);if(!this.httpProviders[s]){const o=t||Ur(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,o)}this.chainId=s,this.events.emit(Di.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||Ur(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new $i(new nn(s,Dt("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=Eu(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let o=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class eI{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=Dt("events"),this.client=Dt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||Ur(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(Di.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Ur(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new $i(new nn(s,Dt("disableProviderPing")))}}class tI{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=Dt("events"),this.client=Dt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||Ur(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Di.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Ur(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new $i(new nn(s,Dt("disableProviderPing")))}}class rI{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=Dt("events"),this.client=Dt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Di.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t);e[t]=this.createHttpProvider(t,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);return typeof s>"u"?void 0:new $i(new nn(s,Dt("disableProviderPing")))}}class iI{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=Dt("events"),this.client=Dt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||Ur(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(Di.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Ur(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new $i(new nn(s,Dt("disableProviderPing")))}}class nI{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=Dt("events"),this.client=Dt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||Ur(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(Di.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Ur(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new $i(new nn(s,Dt("disableProviderPing")))}}var sI=Object.defineProperty,oI=Object.defineProperties,aI=Object.getOwnPropertyDescriptors,mp=Object.getOwnPropertySymbols,cI=Object.prototype.hasOwnProperty,uI=Object.prototype.propertyIsEnumerable,bp=(i,e,t)=>e in i?sI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,$o=(i,e)=>{for(var t in e||(e={}))cI.call(e,t)&&bp(i,t,e[t]);if(mp)for(var t of mp(e))uI.call(e,t)&&bp(i,t,e[t]);return i},Vc=(i,e)=>oI(i,aI(e));class ku{constructor(e){this.events=new xu,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||dp})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new ku(e);return await t.initialize(),t}async request(e,t){const[s,o]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:$o({},e),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(e,t,s){this.request(e,s).then(o=>t(null,o)).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:$t("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(c=>{this.session=c,this.namespaces||(this.namespaces=X5(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==jd)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[s,o]=this.validateChain(e);this.getProvider(s).setDefaultChain(o,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(ri(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await j5.init({logger:this.providerOpts.logger||dp,relayUrl:this.providerOpts.relayUrl||L5,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>jo(t)))];Kc("client",this.client),Kc("events",this.events),Kc("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=W5(t,this.session),o=Ud(s),c=Y5(this.namespaces,this.optionalNamespaces),l=Vc($o({},c[t]),{accounts:s,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new Q5({namespace:l});break;case"solana":this.rpcProviders[t]=new eI({namespace:l});break;case"cosmos":this.rpcProviders[t]=new tI({namespace:l});break;case"polkadot":this.rpcProviders[t]=new Z5({namespace:l});break;case"cip34":this.rpcProviders[t]=new rI({namespace:l});break;case"elrond":this.rpcProviders[t]=new iI({namespace:l});break;case"multiversx":this.rpcProviders[t]=new nI({namespace:l});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:s}=t;if(s.name==="accountsChanged"){const o=s.data;o&&ri(o)&&this.events.emit("accountsChanged",o.map(J5))}else s.name==="chainChanged"?this.onChainChanged(t.chainId):this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s;const{namespaces:o}=t,c=(s=this.client)==null?void 0:s.session.get(e);this.session=Vc($o({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Vc($o({},$t("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Di.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:o}=e;t&&Object.keys(t).length&&(this.namespaces=t),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",s)}validateChain(e){const[t,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(l=>jo(l)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const o=jo(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){var s;if(!this.namespaces)return;const[o,c]=this.validateChain(e);t||this.getProvider(o).setDefaultChain(c),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${gp}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${gp}/${e}`)}}const hI=ku,lI="wc",fI="ethereum_provider",pI=`${lI}@2:${fI}:`,dI="https://rpc.walletconnect.com/v1/",Su=["eth_sendTransaction","personal_sign"],gI=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Iu=["chainChanged","accountsChanged"],_I=["message","disconnect","connect"];var yI=Object.defineProperty,vI=Object.defineProperties,mI=Object.getOwnPropertyDescriptors,wp=Object.getOwnPropertySymbols,bI=Object.prototype.hasOwnProperty,wI=Object.prototype.propertyIsEnumerable,Ep=(i,e,t)=>e in i?yI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ps=(i,e)=>{for(var t in e||(e={}))bI.call(e,t)&&Ep(i,t,e[t]);if(wp)for(var t of wp(e))wI.call(e,t)&&Ep(i,t,e[t]);return i},Sp=(i,e)=>vI(i,mI(e));function Ko(i){return Number(i[0].split(":")[1])}function Gc(i){return`0x${i.toString(16)}`}function EI(i){const{chains:e,optionalChains:t,methods:s,optionalMethods:o,events:c,optionalEvents:l,rpcMap:p}=i;if(!ri(e))throw new Error("Invalid chains");const _={chains:e,methods:s||Su,events:c||Iu,rpcMap:ps({},e.length?{[Ko(e)]:p[Ko(e)]}:{})},d=c==null?void 0:c.filter(P=>!Iu.includes(P)),w=s==null?void 0:s.filter(P=>!Su.includes(P));if(!t&&!l&&!o&&!(d!=null&&d.length)&&!(w!=null&&w.length))return{required:e.length?_:void 0};const A=(d==null?void 0:d.length)&&(w==null?void 0:w.length)||!t,S={chains:[...new Set(A?_.chains.concat(t||[]):t)],methods:[...new Set(_.methods.concat(o!=null&&o.length?o:gI))],events:[...new Set(_.events.concat(l||_I))],rpcMap:p};return{required:e.length?_:void 0,optional:t.length?S:void 0}}class Wu{constructor(){this.events=new Lr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=pI,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new Wu;return await t.initialize(e),t}async request(e){return await this.signer.request(e,this.formatChainId(this.chainId))}sendAsync(e,t){this.signer.sendAsync(e,t,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:s}=EI(this.rpc);try{const o=await new Promise(async(l,p)=>{var _;this.rpc.showQrModal&&((_=this.modal)==null||_.subscribeModal(d=>{!d.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),p(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Sp(ps({namespaces:ps({},t&&{[this.namespace]:t})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(d=>{l(d)}).catch(d=>{p(new Error(d.message))})});if(!o)return;this.setChainIds(this.rpc.chains);const c=JE(o.namespaces,[this.namespace]);this.setAccounts(c),this.events.emit("connect",{chainId:Gc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:s}=t;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",Gc(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Sp(ps({},$t("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,s;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",Gc(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,s,o]=e.split(":");return{chainId:`${t}:${s}`,address:o}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,s;const o=(t=e==null?void 0:e.chains)!=null?t:[],c=(s=e==null?void 0:e.optionalChains)!=null?s:[],l=o.concat(c);if(!l.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const p=o.length?(e==null?void 0:e.methods)||Su:[],_=o.length?(e==null?void 0:e.events)||Iu:[],d=(e==null?void 0:e.optionalMethods)||[],w=(e==null?void 0:e.optionalEvents)||[],A=(e==null?void 0:e.rpcMap)||this.buildRpcMap(l,e.projectId),S=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(P=>this.formatChainId(P)),optionalChains:c.map(P=>this.formatChainId(P)),methods:p,events:_,optionalMethods:d,optionalEvents:w,rpcMap:A,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:S,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const s={};return e.forEach(o=>{s[o]=this.getRpcUrl(o,t)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?Ko(this.rpc.chains):Ko(this.rpc.optionalChains),this.signer=await hI.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:s}=await mm(()=>import("./index-4c7e8b02.js").then(o=>o.a),["assets/index-4c7e8b02.js","assets/index-c8bec167.js","assets/index-e8d0538d.css"]);t=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(ps({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:s,rpcMap:o}=e;t&&ri(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),s&&ri(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(e,t){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${dI}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const DI=Wu;export{DI as EthereumProvider,_I as OPTIONAL_EVENTS,gI as OPTIONAL_METHODS,Iu as REQUIRED_EVENTS,Su as REQUIRED_METHODS,Wu as default};
